---
layout: page
title: "FHIR Chat  · Applying JSON patch to resource · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html">Applying JSON patch to resource</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153886949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886949">(May 04 2017 at 06:38)</a>:</h4>
<p>I have a JSON patch that I want to apply to a resource. Is there any code in, say, fhir-net-api for helping with this? My initial problem is that I have a path and a value, and I want to parse the value into some fhir object (say, with FhirJsonParser.Parse). But if it's a BackboneElement then there's no resourceType member. The only way to determine the type of object to parse is by looking at the root resource type and the path attribute of the patch. I'd rather not have to implement all of that by myself.</p>



<a name="153886950"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886950" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886950">(May 04 2017 at 06:49)</a>:</h4>
<p>I made an element like this to reflect a json patch, but I'm pretty sure FhirJsonParser.Parse is not going to be able to figure out which type to instantiate for Value when parsing a json patch.</p>
<div class="codehilite"><pre><span></span>public class Patch : Hl7.Fhir.Model.BackboneElement
{
    public string Op;
    public string Path;
    public Base Value;
}
</pre></div>



<a name="153886962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886962">(May 04 2017 at 09:28)</a>:</h4>
<p>in my server, I apply the json/xml patches to XML/JSON directly, and then parse to objects - for exactly the reason you identified </p>



<a name="153886986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886986">(May 04 2017 at 11:46)</a>:</h4>
<p>Actually, how do I even serialize <em>to</em> a JSON patch? If I make a class to represent a patch item, which in turn contains a Resource as its value, I can't just call FhirSerializer.SerializeResourceToJson on the patch object since it isn't marked as an Fhir type for the introspection and doesn't inherit from Base.</p>



<a name="153886988"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886988" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886988">(May 04 2017 at 11:47)</a>:</h4>
<p>FhirJsonParser.Parse() lets you pass in a JsonReader as argument so you can have contained Fhir resources in a larger Json structure. But FhirSerializer.SerializeToJson does not seem to provide a similar way to pass in a JsonWriter?</p>



<a name="153886989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153886989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153886989">(May 04 2017 at 11:50)</a>:</h4>
<p>oh wait yes there is, SerializeResource does that. But what if it's a BackboneElement?</p>



<a name="153887012"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153887012" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153887012">(May 04 2017 at 12:37)</a>:</h4>
<p>so I handle Json patch as pure JSON. THe language has no representation as a resource. </p>



<a name="153887013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153887013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153887013">(May 04 2017 at 12:37)</a>:</h4>
<p>If you want a resource based patch, look at FHIRPath patch</p>



<a name="153887057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153887057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153887057">(May 04 2017 at 12:59)</a>:</h4>
<p>perhaps I could make some minor changes to the reference implementation</p>



<a name="153892291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153892291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153892291">(Jun 05 2017 at 10:57)</a>:</h4>
<p>How have you gone <span class="user-mention" data-user-id="193772">@Mattias Flodin</span>, interested if you'ev managed to get any of this working, and if you're likely to contribute it back ot the fhir-net-api project.</p>



<a name="153892659"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153892659" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153892659">(Jun 07 2017 at 12:35)</a>:</h4>
<p>Yes <span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> I have some modifications and it's working, but it's not pretty. I intend to contribute them back to fhir-net-api but I doubt they can be used as-is. They will need to be improved on by someone who knows the architecture better.</p>



<a name="153892660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153892660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153892660">(Jun 07 2017 at 12:45)</a>:</h4>
<p>The architecture of fhir-net-api serialization is such that you always have to know the container resource in order to serialize a single attribute. This complicates things a lot, sometimes you have to create dummy objects just to get serialization working for nested elements. I think it would be possible to do something better using <a href="http://json.net" target="_blank" title="http://json.net">json.net</a> converters and possibly some context information passed into the converter.</p>



<a name="153892661"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153892661" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mattias Flodin <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153892661">(Jun 07 2017 at 12:45)</a>:</h4>
<p>But doing that would require pretty serious refactoring / redesign and it's not really my place to do that.</p>



<a name="153894545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153894545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Theo Stolker <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153894545">(Jun 20 2017 at 12:25)</a>:</h4>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span>, I would be interested in having a method that applies a FHIRPath Patch, i.e., a Parameters resource, to a resource. Is that something that is planned for the fhir-net-api?</p>



<a name="153895917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153895917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153895917">(Jul 02 2017 at 10:32)</a>:</h4>
<p>We'd like to add this yes, but no-one I know of has it working on .net yet (and not at the top of the priority list yet)</p>



<a name="153895956"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153895956" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153895956">(Jul 03 2017 at 10:04)</a>:</h4>
<p>I would welcome a PR ;-)</p>



<a name="153895987"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153895987" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153895987">(Jul 04 2017 at 04:13)</a>:</h4>
<p>I stumbled across a dotnetcore jsonpatch bit of code I'll take a look at.<br>
<a href="https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.jsonpatch.jsonpatchdocument" target="_blank" title="https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.jsonpatch.jsonpatchdocument">https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.jsonpatch.jsonpatchdocument</a><br>
(and this older one, don't recall if I found it last time I looked <a href="https://michael-mckenna.com/how-to-add-json-patch-support-to-asp-net-web-api/" target="_blank" title="https://michael-mckenna.com/how-to-add-json-patch-support-to-asp-net-web-api/">https://michael-mckenna.com/how-to-add-json-patch-support-to-asp-net-web-api/</a>)</p>



<a name="153896011"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153896011" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153896011">(Jul 04 2017 at 11:02)</a>:</h4>
<p>So, that library seems to be a Microsoft product?  I was thinking about FhirPatch, which is a bit harder to find libraries for....but yes, this library would help.</p>



<a name="153896055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Applying%20JSON%20patch%20to%20resource/near/153896055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Applying.20JSON.20patch.20to.20resource.html#153896055">(Jul 05 2017 at 05:46)</a>:</h4>
<p>Yes, not till one of us does it ;)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
