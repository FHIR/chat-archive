---
layout: page
title: "FHIR Chat  · R4 JSONSchema · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html">R4 JSONSchema</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="165200639"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165200639" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Joe Paquette <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165200639">(May 08 2019 at 21:01)</a>:</h4>
<p>Looking at the R4 fhir.schema.json schema, I noticed that fields having a primitive type that is also required (i.e., 1..1) has no validation to enforce requiredness. As an example, look at <code>careplan.profile.canonical.json</code>. Note that <code>"id": "CarePlan.status"</code> and <code>"id": "CarePlan.intent"</code> both have 1..1 cardinality. Now, look in R4 fhir.schema.json at lines 10527-10530 and note that the "required" property for careplan only contains "subject" and "resourceType". Using <code>example-json/careplan-example.json</code> and the R4 fhir.schema.json schema on the <a href="https://www.jsonschemavalidator.net/" target="_blank" title="https://www.jsonschemavalidator.net/">https://www.jsonschemavalidator.net/</a> online validator confirms no validation errors when "status" and/or "intent" are deleted from the example. </p>
<p>Primitive fields in the fhir.schema.json have the pattern of defining 2 fields: "propName" (normal field) and "_propName" (extention field). Requiredness must take an either/or approach to these 2 fields since only one of each "status" and "intent" is required.</p>
<p>A straight forward change to the fhir.schema.json can fix this issue.<br>
In fhir.schemn.json, replace lines 10527-10530: </p>
<div class="codehilite"><pre><span></span>      &quot;required&quot;: [
        &quot;subject&quot;,
        &quot;resourceType&quot;
      ]
</pre></div>


<p>with the following:</p>
<div class="codehilite"><pre><span></span>      &quot;allOf&quot;: [
        {
          &quot;required&quot;: [&quot;subject&quot;, &quot;resourceType&quot;]
        },
        {
          &quot;anyOf&quot;: [{ &quot;required&quot;: [&quot;status&quot;] }, { &quot;required&quot;: [&quot;_status&quot;] }],
          &quot;not&quot;: { &quot;required&quot;: [&quot;status&quot;, &quot;_status&quot;] }
        },
        {
          &quot;anyOf&quot;: [{ &quot;required&quot;: [&quot;intent&quot;] }, { &quot;required&quot;: [&quot;_intent&quot;] }],
          &quot;not&quot;: { &quot;required&quot;: [&quot;intent&quot;, &quot;_intent&quot;] }
        }
      ]
</pre></div>


<p>Retesting with <code>example-json/careplan-example.json</code> and the R4 fhir.schema.json schema with the above changes confirms errors for missing any/all of the required fields.</p>
<p>NOTE: This is an issue for all resources having primitive fields that have a 1..1 cardinality!</p>
<p>I'd be happy to create a bug against the generated fhir.schema.json if someone would point me in the right direction.</p>



<a name="165207348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165207348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165207348">(May 08 2019 at 22:34)</a>:</h4>
<p>To log a bug, click on the "propose a change" link at the bottom of any page in the FHIR spec.  You'll need to do a one-time registration, after which you can log as many bugs as you like :)</p>



<a name="165585758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165585758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165585758">(May 14 2019 at 01:54)</a>:</h4>
<p>getting back to the issue....</p>



<a name="165591694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165591694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165591694">(May 14 2019 at 04:16)</a>:</h4>
<p>returning to this, I do not understand what is going on here</p>



<a name="165591712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165591712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165591712">(May 14 2019 at 04:17)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
     <span class="nt">&quot;anyOf&quot;</span><span class="p">:</span> <span class="p">[{</span> <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="p">},</span> <span class="p">{</span> <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;_status&quot;</span><span class="p">]</span> <span class="p">}],</span>
    <span class="nt">&quot;not&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;_status&quot;</span><span class="p">]</span> <span class="p">}</span>
<span class="p">}</span><span class="err">,</span>
</pre></div>



<a name="165591719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165591719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165591719">(May 14 2019 at 04:17)</a>:</h4>
<p>the anyOf I understand, but not the <code>not</code> - what's that about?</p>



<a name="165629186"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165629186" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165629186">(May 14 2019 at 14:54)</a>:</h4>
<p><code>_primitive</code> just was a bad idea :/    - maybe it's not too late fix it :)</p>



<a name="165656599"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20JSONSchema/near/165656599" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20JSONSchema.html#165656599">(May 14 2019 at 19:59)</a>:</h4>
<p>I agree it was a bad idea and I said so at the time. (and people assured me I just didn't understand JSON at the time). But it is too late to change it now</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
