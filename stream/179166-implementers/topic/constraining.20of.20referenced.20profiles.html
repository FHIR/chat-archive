---
layout: page
title: "FHIR Chat  · constraining of referenced profiles · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html">constraining of referenced profiles</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="175057444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175057444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Georg Fette <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175057444">(Sep 06 2019 at 12:02)</a>:</h4>
<p>Hi,<br>
Is it possible to constrain the profile referenced in another profile ? Like e.g. when I want to build some report about pregnancy and I reference a "Patient" resource I would like to ensure thate the "Patient.gender" can only be "female". If possible, with which standard mechanism from the FHIR cosmos are such constrains modeled ?</p>



<a name="175057526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175057526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175057526">(Sep 06 2019 at 12:03)</a>:</h4>
<p>either a FHIRPath statement using resolve() or a GraphDefinition (though that needs an extension). But either way it's fragile since the rule is only know from the context of a different resource</p>



<a name="175057738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175057738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175057738">(Sep 06 2019 at 12:06)</a>:</h4>
<p>And you need to be careful about the validity of the invariant itself. Patients with a gender = other might also be pregnant. You can't know that information.</p>



<a name="175057967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175057967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175057967">(Sep 06 2019 at 12:10)</a>:</h4>
<p>technnically, in super edge cases, it's possi ble for patients with an administrative gender of m to be pregnant (though I think it's pretty unlikely given hormone treatment etc)</p>



<a name="175058470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175058470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Georg Fette <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175058470">(Sep 06 2019 at 12:17)</a>:</h4>
<p>so, is it true that using the standard mechanisms that available by defining a profile merely through a StructureDefinition such a constraining is not possible ?</p>



<a name="175060113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175060113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175060113">(Sep 06 2019 at 12:41)</a>:</h4>
<p>Technical it is possible as <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> mentioned. Have a look at the resolve function defined here: <a href="https://www.hl7.org/fhir/fhirpath.html" target="_blank" title="https://www.hl7.org/fhir/fhirpath.html">https://www.hl7.org/fhir/fhirpath.html</a><br>
With it you could in theory define invariants which cover multiple resources</p>



<a name="175060388"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175060388" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Georg Fette <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175060388">(Sep 06 2019 at 12:45)</a>:</h4>
<p>ah, cool, thank you. I will take a look at that.</p>



<a name="175236278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175236278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Georg Fette <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175236278">(Sep 09 2019 at 12:24)</a>:</h4>
<p>Can somebody give me an example of a structuredefinition in which a fhirpath statement has been used to constrain the profile? It does not need to be such a trans-profile constraint like i asked for in my initial question.</p>



<a name="175247877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175247877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175247877">(Sep 09 2019 at 14:42)</a>:</h4>
<p>I suspect that in most cases if the constraint doesn't go across the reference boundary, then the profile will just use the normal (non-FHIRPath) approach to constraining the reference to a profile (using the <code>type.targetProfile</code>).  But if you did want to use a FHIRPath invariant to do that, I expect you'd chain <code>resolve()</code> and <code>conformsTo(structure: string)</code> together to accomplish it (see: <a href="http://hl7.org/fhir/R4/fhirpath.html#functions" target="_blank" title="http://hl7.org/fhir/R4/fhirpath.html#functions">http://hl7.org/fhir/R4/fhirpath.html#functions</a> for doc on <code>conformsTo</code>).</p>



<a name="175500225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175500225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175500225">(Sep 12 2019 at 05:26)</a>:</h4>
<p><a href="https://github.com/AuDigitalHealth/ci-fhir-stu3/blob/master/resources/composition-sml-prac-1.xml" target="_blank" title="https://github.com/AuDigitalHealth/ci-fhir-stu3/blob/master/resources/composition-sml-prac-1.xml">https://github.com/AuDigitalHealth/ci-fhir-stu3/blob/master/resources/composition-sml-prac-1.xml</a> contains an invariant to force a referenced practitioner to conform to a profile. See inv-dh-cmp-06.<br>
<code>&lt;expression value="resolve().conformsTo('http://ns.electronichealth.net.au/ci/fhir/3.0/StructureDefinition/practitionerrole-withpractitionerident-1')" /&gt;</code></p>



<a name="175519298"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175519298" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175519298">(Sep 12 2019 at 11:22)</a>:</h4>
<p>Why not use <code>ElementDefinition.type.targetProfile</code>?</p>



<a name="175519892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraining%20of%20referenced%20profiles/near/175519892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraining.20of.20referenced.20profiles.html#175519892">(Sep 12 2019 at 11:32)</a>:</h4>
<p>That works unless the invariant is conditional</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
