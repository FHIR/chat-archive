---
layout: page
title: "FHIR Chat  · FHIRPath Singleton Evaluation of Collections · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html">FHIRPath Singleton Evaluation of Collections</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153949370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153949370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153949370">(Mar 30 2018 at 14:46)</a>:</h4>
<p>I figured it would be best to branch of this specific topic from <a href="https://chat.fhir.org/#narrow/stream/implementers/topic/FHIRPath.20Specification.20Questions" target="_blank" title="https://chat.fhir.org/#narrow/stream/implementers/topic/FHIRPath.20Specification.20Questions">https://chat.fhir.org/#narrow/stream/implementers/topic/FHIRPath.20Specification.20Questions</a> since that one kind of got taken to another direction.</p>
<p>I downloaded the latest definitions.xml from <a href="http://build.fhir.org" target="_blank" title="http://build.fhir.org">build.fhir.org</a> and I still see a few invariants that I think will fail for this specific case.</p>
<p>1. invariant cnt-3 for Count type: it still uses '(code or value.empty())...'<br>
2. invariant dis-1 for Distance type: it still uses '(code or value.empty())...'<br>
3. invariant opd-2 for OperationDefinition resource: it uses 'searchType implies type...'</p>
<p>I presume these need to be updated to use code.exists() or searchType.exists() so that FHIRPath engines that follow the spec will not throw errors?</p>



<a name="153949377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153949377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153949377">(Mar 30 2018 at 15:05)</a>:</h4>
<p>And speaking of FHIRPath engines that follow this spec (i.e. <a href="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc#singleton-evaluation-of-collections" target="_blank" title="https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc#singleton-evaluation-of-collections">https://github.com/FHIR/fluentpath/blob/master/spec/index.adoc#singleton-evaluation-of-collections</a>), I don't think any of the FHIRPath reference implementations follow it.</p>
<p>1. Pascal RI: <a href="https://github.com/grahamegrieve/fhirserver/blob/master/reference-platform/r4/FhirPath.pas" target="_blank" title="https://github.com/grahamegrieve/fhirserver/blob/master/reference-platform/r4/FhirPath.pas">https://github.com/grahamegrieve/fhirserver/blob/master/reference-platform/r4/FhirPath.pas</a> (search for 'function TFHIRPathEngine.convertToBoolean(items: TFHIRSelectionList): boolean')<br>
2. Java RI: <a href="https://gforge.hl7.org/gf/project/fhir/scmsvn/?action=browse&amp;path=%2Ftrunk%2Fbuild%2Fimplementations%2Fjava%2Forg.hl7.fhir.r4%2Fsrc%2Forg%2Fhl7%2Ffhir%2Fr4%2Futils%2FFHIRPathEngine.java&amp;view=markup&amp;revision=13543" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/scmsvn/?action=browse&amp;path=%2Ftrunk%2Fbuild%2Fimplementations%2Fjava%2Forg.hl7.fhir.r4%2Fsrc%2Forg%2Fhl7%2Ffhir%2Fr4%2Futils%2FFHIRPathEngine.java&amp;view=markup&amp;revision=13543">https://gforge.hl7.org/gf/project/fhir/scmsvn/?action=browse&amp;path=%2Ftrunk%2Fbuild%2Fimplementations%2Fjava%2Forg.hl7.fhir.r4%2Fsrc%2Forg%2Fhl7%2Ffhir%2Fr4%2Futils%2FFHIRPathEngine.java&amp;view=markup&amp;revision=13543</a> (search for 'public boolean convertToBoolean(List&lt;Base&gt; items) {')<br>
3. .NET RI: <a href="https://github.com/ewoutkramer/fhir-net-api/blob/master/src/Hl7.FhirPath/FhirPath/Functions/CollectionOperators.cs" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/blob/master/src/Hl7.FhirPath/FhirPath/Functions/CollectionOperators.cs">https://github.com/ewoutkramer/fhir-net-api/blob/master/src/Hl7.FhirPath/FhirPath/Functions/CollectionOperators.cs</a> (search for 'public static bool? BooleanEval(this IEnumerable&lt;IElementNavigator&gt; focus)')</p>
<p>Instead of 'raise error' they return true if the list is non-empty and non-Boolean. Perhaps it would be best to update these also?</p>



<a name="153949497"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153949497" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153949497">(Mar 30 2018 at 20:19)</a>:</h4>
<p>will look into this in 24hours</p>



<a name="153949559"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153949559" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153949559">(Mar 31 2018 at 19:48)</a>:</h4>
<p>personally, I think the spec is wrong on this point. It's a difference between editors, I guess. We will hve to reconcile this in the ballot due out next week</p>



<a name="153949560"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153949560" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153949560">(Mar 31 2018 at 19:51)</a>:</h4>
<p>but I fixed them for now, thanks</p>



<a name="153951189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153951189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153951189">(Apr 06 2018 at 16:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> ?</p>



<a name="153951257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20Singleton%20Evaluation%20of%20Collections/near/153951257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20Singleton.20Evaluation.20of.20Collections.html#153951257">(Apr 06 2018 at 19:30)</a>:</h4>
<p>so this should be sorted in the new version of FHIRPath being balloted now</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
