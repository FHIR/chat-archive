---
layout: page
title: "FHIR Chat  · JSON Format for Primitives &amp; extensions · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html">JSON Format for Primitives &amp; extensions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153965303"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965303" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965303">(May 29 2018 at 20:46)</a>:</h4>
<p>Are we sure we want to see this in real systems - <a href="https://gist.github.com/niquola/6c826639a7f0061a9e3274c3f7272cae#file-ups-yaml-L74" target="_blank" title="https://gist.github.com/niquola/6c826639a7f0061a9e3274c3f7272cae#file-ups-yaml-L74">https://gist.github.com/niquola/6c826639a7f0061a9e3274c3f7272cae#file-ups-yaml-L74</a> ?</p>



<a name="153965307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965307">(May 29 2018 at 20:53)</a>:</h4>
<p>If this is really required and FHIR primitives is not primitives - let's encode it in terrible xmlish style  <code>code: "string"</code> =&gt; <code>code: {value: "string"}</code></p>



<a name="153965313"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965313" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965313">(May 29 2018 at 21:01)</a>:</h4>
<p>I'm pretty sure, that non-fhir developers community will be really confused by such corner cases.</p>



<a name="153965320"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965320" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965320">(May 29 2018 at 21:05)</a>:</h4>
<p>yes. we had a big long argument about this in the past. What you propose is exactly what we still had and what I wish we still had. But we decided that it was a better balance to make the simple cases very simple and the corner cases very hard</p>



<a name="153965321"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965321" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965321">(May 29 2018 at 21:05)</a>:</h4>
<p>but it's too late to change this now</p>



<a name="153965324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965324">(May 29 2018 at 21:06)</a>:</h4>
<p>Let's create second json serialization format - this is not breaking change!</p>



<a name="153965326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965326">(May 29 2018 at 21:07)</a>:</h4>
<p>It could be optional - pretty sure most of users will switch on it eventually</p>



<a name="153965327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965327">(May 29 2018 at 21:08)</a>:</h4>
<p>I can work on it :) .</p>



<a name="153965338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965338">(May 29 2018 at 21:14)</a>:</h4>
<p>I'm pretty sure that's a bad idea. I don't think people will be interested. But we could have a straw poll - indicate by choosing <span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span> or <span class="emoji emoji-1f44e" title="thumbs down">:thumbs_down:</span> as a response to the message above</p>



<a name="153965357"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965357" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965357">(May 29 2018 at 21:28)</a>:</h4>
<p>Competing versions of the same syntax - especially at this point in the standard life cycle - would not be doing implementers any favors.  Most implementers will be using one of the reference implementations, meaning they don't care.  The only thing new to the argument here is JSON schema and that was in its infancy at the time the decision was made.  I don't think there's anything about the syntax that says it can't work.  It just makes certain edge-case usecases harder.</p>



<a name="153965369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965369">(May 29 2018 at 21:32)</a>:</h4>
<p>Hiding complexity in reference implementation  lib does not eliminate it :(</p>



<a name="153965372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965372">(May 29 2018 at 21:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> I'm not sure what you're basing the idea that most implementors will be using a reference implementation on. My team certainly isn't, and we will be affected by these edge cases. Furthermore, it seems to me that the protocol itself should be usable without having to rely on third party libraries. If the design is such that the wire format itself is not directly usable that's a fundamental failure of the FHIR specification.</p>



<a name="153965388"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965388" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965388">(May 29 2018 at 21:50)</a>:</h4>
<p>no it's not necessary. We argued about this a lot back when we made this decision. Json schema wasn't a factor then, but I generate json schema ok for this now - I don't think it's that complex.</p>



<a name="153965389"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965389" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965389">(May 29 2018 at 21:52)</a>:</h4>
<p>I don't like the decision we made, but it seems way to late to change it. and it does make the simple cases much simpler. we rarely encounter extensions on primitives. <em>except for translation</em> but we've never got into gear about a good json representation of translations</p>



<a name="153965405"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965405" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965405">(May 29 2018 at 22:03)</a>:</h4>
<p>The fact that JSON is a second class citizen in FHIR is incredibly problematic in my opinion. This is the most commonly used data format today, and many platforms support it natively. Currently, FHIR wire format is pretty much unusable without complex and fragile libraries. I think that focusing on XML as the primary representation is really misguided.</p>



<a name="153965406"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965406" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965406">(May 29 2018 at 22:04)</a>:</h4>
<p>the <em>only</em> respect in which JSON is a second class citizen is that we prefer XML for the base examples since JSON doesn't have comments. In every other respect, JSON is an equal ctiizen</p>



<a name="153965413"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965413" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965413">(May 29 2018 at 22:11)</a>:</h4>
<p>The way the data is structured in FHIR is not how idiomatic JSON is structured. For example, many instances where you have collections of maps appear to be a artifact of directly translating XML nodes into JSON. Meanwhile, idiomatic JSON would favor use of maps as the top level element keyed on the id of each node. Another example is that collections are named with singular names, where idiomatic JSON would use plural to indicate that they are collections.</p>
<p>From what I see, JSON representation is basically just XML format dumped into JSON. Having JSON as a first class citizen would mean structuring data in JSON idiomatic fashion, and FHIR does not do that.</p>
<p>In practical terms it means that you have to go through a complex, error prone, and expensive parsing step before you're able to work with the data effectively.</p>



<a name="153965416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965416">(May 29 2018 at 22:25)</a>:</h4>
<p>we talked about pluralising the names - that's something we decided not to do. I don't know how significant that is</p>



<a name="153965418"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965418" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965418">(May 29 2018 at 22:26)</a>:</h4>
<p>the issue of maps - that's come up before. That's got nothing to do with xml vs json, and everything to do with complexities in the data. We try for as simple as possible, but sometimes it's just not possible</p>



<a name="153965420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965420">(May 29 2018 at 22:31)</a>:</h4>
<p>I suspect this will remain a hot topic for years to come. :)  Maybe a compromise here is what Grahame referred to in the past as a "database representation". In the proto representation we already unroll some of these extensions into named tuples, based on the profiles of various resources in use, which makes the db setup and queries easier. I don't think such a representation has to be tied to json at all, and i'm not sure if it has any place being sent over the wire directly, but i do think there is value in talking through what it would look like.</p>



<a name="153965422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965422">(May 29 2018 at 22:38)</a>:</h4>
<p>I end up taking the data that comes over the wire and then transforming it into a usable form. The question is not of data complexity, but of the use cases the format is optimized for. I also get the impression that nobody on the core team works with JSON data directly, and therefore the problems are not apparent because nobody is dog fooding the protocol.</p>
<p>The decisions appear to often be based on assumptions, such as the case with <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> suggesting that people are predominantly using 3rd party libraries. I see very little evidence that there's any effort to validate such assumptions based on the broader community usage. This results in many key decisions being made by a small closed group, and then when people find them problematic they're told that it's too late to change anything.</p>



<a name="153965437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965437">(May 30 2018 at 03:29)</a>:</h4>
<p>"Too late to change" comes from where we are in the standards process.  If we change the syntax now, it has a huge impact on implementers - of which there are now thousands.  It also means we can't go normative this cycle, which impacts even more.  The decisions weren't made by a small closed group - the nature of the JSON protocol were made with a great deal of open discussion.  The final shape of the syntax was landed on in a room with 40+ people in it and lots of active discussion - and that was after lots of beating on it in connectathon.  It's certainly possible (likely) that for certain uses, the syntax is not ideal.  The same would be true of the XML and RDF syntaxes.  The focus of the syntax is not persistance or internal data operations, it's just exchange.   If those other uses had been primary considerations, it's entirely possible that any of the syntaxes would look different than they do now.</p>



<a name="153965438"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965438" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965438">(May 30 2018 at 03:31)</a>:</h4>
<p>The assertion of "it's too late" also isn't a veto.  You can vote.  If there are enough people who agree, then the change will be made.  I think that the number of people invested in the current syntax make that an unlikely outcome, but you're absolutely welcome to make the effort.  Grahame's statement should not be taken as a "you can't", but rather "based on where the community is at, it's probably not a good use of your time".</p>



<a name="153965460"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965460" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965460">(May 30 2018 at 07:30)</a>:</h4>
<p>Correct. There are things in the XML syntax that I don't like either - and I am pretty sure the designers of HTTP or actually any piece of spec or software would love to roll back some of their decisions. At some point however, the cost of change is larger than the benefit - as software engineers I am sure we all recognize this.  Personally I think we've past that point quite some time ago.</p>



<a name="153965462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965462">(May 30 2018 at 08:05)</a>:</h4>
<p>"I also get the impression that nobody on the core team works with JSON data directly" - very much not the case.</p>



<a name="153965463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965463">(May 30 2018 at 08:06)</a>:</h4>
<p>btw, restructuring the data for easy consumption for a particular use case is pretty common. I've run into quite a few people using graphql for that... I'm trying to encourage them to standardise on the work documented at <a href="http://build.fhir.org/graphql.html" target="_blank" title="http://build.fhir.org/graphql.html">build.fhir.org/graphql.html</a></p>



<a name="153965482"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965482" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965482">(May 30 2018 at 09:11)</a>:</h4>
<p>We can start experiment with new json format - if it will fail  - that's ok, but if we will get real interest ... As a second format, this will be non-breaking addition, which can be abandoned at any time :)</p>



<a name="153965484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965484">(May 30 2018 at 09:13)</a>:</h4>
<p>well, ok. how's it going to be different? going to the direct representation of primitives, and extensions, ok. what else?</p>



<a name="153965485"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965485" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965485">(May 30 2018 at 09:14)</a>:</h4>
<ul>
<li>polymorphic elements</li>
</ul>



<a name="153965486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965486">(May 30 2018 at 09:15)</a>:</h4>
<p>oh? so how are you proposing to do that?</p>



<a name="153965487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965487">(May 30 2018 at 09:16)</a>:</h4>
<p>Something as discussed here <a href="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2" target="_blank" title="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2">https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2</a></p>



<a name="153965488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965488">(May 30 2018 at 09:17)</a>:</h4>
<p>It should be similar to what you have in ref.lib. - i.e. Observation.value.string</p>



<a name="153965489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965489">(May 30 2018 at 09:17)</a>:</h4>
<p>As well as local references as {id: "...", resourceType: "Resource"}</p>



<a name="153965490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965490">(May 30 2018 at 09:18)</a>:</h4>
<p>i don't know what you mean about the reflib.</p>



<a name="153965491"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965491" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965491">(May 30 2018 at 09:18)</a>:</h4>
<p>Java/ C#</p>



<a name="153965493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965493">(May 30 2018 at 09:19)</a>:</h4>
<p>I assumed that was what you mean but I don't know how that's relevant. And that page has 2 solutions.</p>



<a name="153965494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965494">(May 30 2018 at 09:19)</a>:</h4>
<p>local references?</p>



<a name="153965495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965495">(May 30 2018 at 09:20)</a>:</h4>
<p>Local means on the same server/db - <a href="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/4" target="_blank" title="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/4">https://github.com/fhir-fuel/fhir-fuel.github.io/issues/4</a></p>



<a name="153965500"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965500" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965500">(May 30 2018 at 10:51)</a>:</h4>
<p>Hi Nicolai, the json example for solution 2 is exactly the same as the first - I cannot quite grasp what solution 2 is!</p>



<a name="153965501"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965501" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965501">(May 30 2018 at 10:56)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> do you mean union/polymorphic representation? this is open for discussion on GitHub</p>



<a name="153965502"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965502" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965502">(May 30 2018 at 10:58)</a>:</h4>
<p>I mean the example under the heading "Solution 2" here: <a href="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2" target="_blank" title="https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2">https://github.com/fhir-fuel/fhir-fuel.github.io/issues/2</a>.  That snippet of json is exactly the same as the example under Solution 1!</p>



<a name="153965503"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965503" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965503">(May 30 2018 at 10:59)</a>:</h4>
<p>The difference is in 1. we have value key in 2: key is named after type: <code>{"value": ".....", "type": "string"}</code> or <code>{"string": ".........."}</code></p>



<a name="153965505"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965505" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965505">(May 30 2018 at 11:00)</a>:</h4>
<p>This can be unified with primitives representation: we can choose or {"value": ....} or {"&lt;type&gt;": .......}</p>



<a name="153965507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965507">(May 30 2018 at 11:02)</a>:</h4>
<p>Oh ah, thanks, I failed to notice that ;-)</p>



<a name="153965508"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965508" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965508">(May 30 2018 at 11:06)</a>:</h4>
<p>What are use cases for primitive extensions? nullFactors?</p>



<a name="153965509"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965509" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965509">(May 30 2018 at 11:09)</a>:</h4>
<p>Why we can't  just create extension one level up to represent the same logic?</p>



<a name="153965511"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965511" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965511">(May 30 2018 at 11:16)</a>:</h4>
<p>How do you handle extended primitives in ref. impl. ? I still think, this will be source of pain in many technologies, without real profit.</p>



<a name="153965512"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965512" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965512">(May 30 2018 at 12:33)</a>:</h4>
<p>I think graphql would address the problem, and the existing work looks very promising.</p>



<a name="153965522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965522">(May 30 2018 at 13:30)</a>:</h4>
<p>extension 1 level up fails for elements that repeat</p>



<a name="153965523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965523">(May 30 2018 at 13:31)</a>:</h4>
<p>and is messy because now you can't interpret primitives without their context. Not that the json is any different now... my real unhappiness with it....</p>



<a name="153965526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965526">(May 30 2018 at 13:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>  What are real use cases for primitive extensions? May we find another solution for it?</p>



<a name="153965527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965527">(May 30 2018 at 13:33)</a>:</h4>
<p>I think NullFactor should be handled in a different way, not by extensions</p>



<a name="153965528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965528">(May 30 2018 at 13:36)</a>:</h4>
<p>we didn't define it for null flavor. There's a number of primitive data type extensions in the spec. you should have a look at those</p>



<a name="153965535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965535">(May 30 2018 at 13:46)</a>:</h4>
<p>Do you mean code extensions in basic structure-definitions? Why do you spec the core features by extensions?</p>



<a name="153965537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965537">(May 30 2018 at 13:48)</a>:</h4>
<p>no I mean the extensions defined here:</p>



<a name="153965538"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965538" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965538">(May 30 2018 at 13:48)</a>:</h4>
<p><a href="http://build.fhir.org/extensibility-registry.html" target="_blank" title="http://build.fhir.org/extensibility-registry.html">http://build.fhir.org/extensibility-registry.html</a></p>



<a name="153965539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965539">(May 30 2018 at 13:49)</a>:</h4>
<p>the code extensions in the structure definitions are a special case - they are effectively the fhir equivalent of compiler magic</p>



<a name="153965592"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965592" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965592">(May 30 2018 at 14:07)</a>:</h4>
<p>A few of the use-cases we've hit so far for primitive extensions:<br>
- express a date in an alternate calendaring system<br>
- provide "original text" for any data subsequently encoded as a date, number or boolean (i.e. what did the user actually see/type)<br>
- provide translations of a string<br>
- provide a calculation instead of a value (e.g. express an offset from some specified time-point instead of a date, provide a formula rather than a numeric element</p>



<a name="153965640"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965640" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965640">(May 30 2018 at 14:54)</a>:</h4>
<p>The interesting thing about FHIR's JSON syntax is that 5 years ago I was making almost the same argument ("nobody on the core team uses JSON", "this is just thinly transformed XML", and "it's not idiomatic") to promote the opposite change (from "all primitives are behind <code>.value</code> properties" --&gt; "just make FHIR primitives be JSON primitives").</p>
<p>In hindsight, I'm sorry I was persuasive -- because what I was trying to do was save JSON-centric developers from what I considered the line noise of extra properties everywhere... but the real pain was the fact that primitives in FHIR just aren't primitives. Trying to optimize for what I considered the extremely common case of "unadorned primitives" leaves a whole lot of pain in the less common cases, and makes the underlying model was less elegant.</p>



<a name="153965650"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965650" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965650">(May 30 2018 at 14:59)</a>:</h4>
<p>I'm still confused by solid point  - <code>primitives, which are not primitives</code> and suspect, that we are trying to solve orthogonal problems like i18n and alternative calendars with wrong tool -  extended primitives.</p>



<a name="153965652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965652">(May 30 2018 at 15:00)</a>:</h4>
<p>If primitive is not enough - use complex type!</p>



<a name="153965665"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965665" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965665">(May 30 2018 at 15:07)</a>:</h4>
<p>Every single place primitives appear, there's the potential for them to not be enough</p>



<a name="153965666"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965666" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965666">(May 30 2018 at 15:07)</a>:</h4>
<ul>
<li>Date is a complex type by definition - let's just model it like {calendar: '', date: '', time: ''}</li>
<li>to preserve original info we can have extensions - this is not common case to document it, in some resources, where this is common case we can create dedicated elements to record this</li>
<li>for translation we can have complex i18n text {lang: '...', text: ''}, like Narrative</li>
</ul>



<a name="153965667"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965667" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965667">(May 30 2018 at 15:07)</a>:</h4>
<p>We don't want to add the complexity of those use-cases for everyone</p>



<a name="153965668"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965668" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965668">(May 30 2018 at 15:08)</a>:</h4>
<p>The whole point of extensions is to keep the data simple unless use-cases drive a need for complexity</p>



<a name="153965671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965671">(May 30 2018 at 15:09)</a>:</h4>
<p>You can't possibly model all the potential use-cases ahead of time.  Extension is for "all the weird use-cases implementers will come up with"</p>



<a name="153965672"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965672" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965672">(May 30 2018 at 15:09)</a>:</h4>
<p>They will always come up with more than you can imagine.</p>



<a name="153965674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965674">(May 30 2018 at 15:10)</a>:</h4>
<p>That's true :/</p>



<a name="153965676"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965676" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965676">(May 30 2018 at 15:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> while I understand that there is impact on implementors due to changes, the impact on millions of people who will ultimately be using the protocol once it's normative outweighs that by orders of magnitude. Any decisions that are made now will affect many people for decades to come, and favoring convenience for current implementors over that seems rather short sighted to me. Having ~40 people make decisions that will impact the community at large is not really a convincing argument. The decision should be based on collecting feedback from the experience of the wider community using the protocol in the wild.</p>
<p>While the protocol focuses on the exchange, the fact that the data has to be extracted from the exchange protocol is still an important consideration. Ultimately, if the protocol is difficult to work with that will lead to errors when people attempt to extract the data from it, and that directly impacts patient safety.</p>
<p>I'd also like to note that UHN has been one of the early adopters of FHIR, and we have tried to make suggestions for the protocol from the start. The message has always been the same. So, while technically we are able to make suggestions, very little feedback ends up being integrated back into the standard in practice. I've been hearing the line that people have already implemented the current version and therefore it's not worth changing from the start.</p>



<a name="153965684"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965684" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965684">(May 30 2018 at 15:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> so we can tell, that FHIR does not have primitive types - but containers for primitives with extension points?</p>



<a name="153965692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965692">(May 30 2018 at 15:22)</a>:</h4>
<p><span class="user-mention" data-user-id="191318">@nicola (RIO/SS)</span> Correct.  FHIR has no true primitives.  Every 'primitive' has extension points.</p>



<a name="153965693"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965693" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965693">(May 30 2018 at 15:22)</a>:</h4>
<p>I still have doubts about  abusing and wrong interpretation of primitive extensions in real use. <br>
Things like </p>
<div class="codehilite"><pre><span></span> &quot;_active&quot;: {&quot;extension&quot;: [{
        &quot;url&quot;: &quot;http://example.org/fhir/StructureDefinition/recordStatus&quot;,
        &quot;valueCode&quot;: &quot;archived&quot;
    }]},
</pre></div>


<p>looks like changing semantic. Such type of power looks dangerous.</p>



<a name="153965700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965700">(May 30 2018 at 15:25)</a>:</h4>
<p>And with extending primitives people will always have this temptation</p>



<a name="153965704"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965704" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965704">(May 30 2018 at 15:27)</a>:</h4>
<p>There are some programming languages, which allow extension of primitives (js,ruby) and this is considered like bad practice and source of bugs &amp; confusion. Because primitives is one of semantic foundation :)</p>



<a name="153965705"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965705" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965705">(May 30 2018 at 15:29)</a>:</h4>
<p><span class="user-mention" data-user-id="194001">@Dmitri Sotnikov</span> The process you describe is what we've been doing for the past 6 years.  Change requests and ballot submissions have been coming in.  The specification reflects the evolution that's resulted from that feedback and the consensus of the community.  In the end, the decisions about proposed changes are made by people who show up on the calls and who vote in the ballot.  There comes a point where the community who's engaged (and who makes the decisions) decide that the cost of further change isn't worth it.  We try to make that community as broad as we can, but we can't second guess them when they make a decision.</p>



<a name="153965708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965708">(May 30 2018 at 16:25)</a>:</h4>
<p>I've worked with many open source projects, and FHIR specification process is very opaque  in comparison. The fact that people have to show up to the calls to vote is a perfect example of that.</p>



<a name="153965709"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965709" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965709">(May 30 2018 at 16:31)</a>:</h4>
<p>One of the main issues is that a lot of the discussions are ephemeral in nature. There needs to be a list of proposed features/changes that is public and easily accessible making it possible for the community to meaningfully engage in the process.</p>



<a name="153965719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965719">(May 30 2018 at 18:22)</a>:</h4>
<p>gForge is intended as the public, easily accessible description of proposed features/changes.  Sometimes they start out as ephemeral, but discussion within the tracker usually tries to make them concrete.  In terms of decision-making, there are two types, both inherited from the HL7 organization - work group decisions and ballots.  We have no ability to change how the balloting process works.  That's driven by ANSI.  In terms of work groups, major decisions are generally put out for discussion on Zulip prior to voting on a call.  I don't think there's ever been a situation where there was extensive support for something on Zulip only to have the decision reversed by a small group on the call.  (Though it's super common for the Zulip conversation to be totally silent or only have 1-2 people chime in.)  There's certainly lots of ability for those who can't attend the calls to share their perspective and to sway opinion.</p>



<a name="153965730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965730">(May 30 2018 at 19:04)</a>:</h4>
<blockquote>
<p>Though it's super common for the Zulip conversation to be totally silent or only have 1-2 people chime in.</p>
</blockquote>
<p>This is precisely the problem, because nobody just sits and watches Zulip all day just on an off chance that an issue that affects them comes up for discussion. Being able to participate and affect meaningful change requires a large commitment. This ends up excluding a lot of users who simply don't have the time to do this. A typical approach is to have a public forum for discussions that's persistent, and have separate discussion threads for each issue. This allows people to see what the proposals are easily, see the state of the current discussion, and contribute their experience.</p>



<a name="153965748"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965748" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965748">(May 30 2018 at 19:55)</a>:</h4>
<p>I think our upcoming move to developing the spec on GitHub, with pull requests driving review, will help in this regard. But <span class="user-mention" data-user-id="194001">@Dmitri Sotnikov</span> your observations here are very much on the mark.</p>
<p>My assessment is that FHIR runs in a very meritocratic, pragmatic way compared with others healthcare standards efforts... but falls short of the mark compared with well-managed open-source projects.</p>



<a name="153965751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965751">(May 30 2018 at 19:59)</a>:</h4>
<p>"A typical approach is to have a public forum for discussions that's persistent, and have separate discussion threads for each issue" - in fact, I thought we did have that</p>



<a name="153965753"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965753" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965753">(May 30 2018 at 20:01)</a>:</h4>
<p>I am not so confident that pull requests will make things better. There's a language gulf between 'the process of changing the standard' and 'the meaning of the standard' - that's the one I live every day. So I'm worried that they'll make things worse, not better.</p>



<a name="153965754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965754">(May 30 2018 at 20:02)</a>:</h4>
<p>and this is the reason why FHIR is more difficult to engage with than a standard open source project - this language gap, and because changes have to deal with 'what's possible' not 'what happens'</p>



<a name="153965759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965759">(May 30 2018 at 20:05)</a>:</h4>
<p><span class="user-mention" data-user-id="194001">@Dmitri Sotnikov</span> the competing priorities in the json format have probably attracted the most broad comment of all the parts of the spec over the last few years. We had extensive discussions about this for over a year. My perspective is that the change was a case to aiming for 'too simple' but I wasn't able to be persuasive on this</p>



<a name="153965768"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965768" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965768">(May 30 2018 at 20:16)</a>:</h4>
<p>"I'd also like to note that UHN has been one of the early adopters of FHIR, and we have tried to make suggestions for the protocol from the start. The message has always been the same. So, while technically we are able to make suggestions, very little feedback ends up being integrated back into the standard in practice. I've been hearing the line that people have already implemented the current version and therefore it's not worth changing from the start." - I'm sorry you feel that. There's a tension between open discussion and revisiting a subject again and again because different people have different priorities, and actually making some decision, and growing more and more weight around it. </p>
<p>In this case, Nicola has consistently been unhappy with the json format, primarily because of storage concerns, and he's had one or 2 voices supporting him. These numbers are much less compared to the number of people who weighed in originally, or who would comment if we tried to change this (or, in this case, document a second format). That's driven the outcome in this case.</p>



<a name="153965769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965769">(May 30 2018 at 20:17)</a>:</h4>
<p>you'll say that straw poll above says different - that's why I'm still in this thread (the only reason)</p>



<a name="153965770"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965770" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965770">(May 30 2018 at 20:19)</a>:</h4>
<p>back to json... if I was going to change the way we handle polymorphics, I'd do this:</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot; : &quot;Observation&quot;,
  &quot;value&quot;:  {
    &quot;_type&quot; : &quot;string&quot;,
   &quot;value&quot; : &quot;the-value&quot;
  }
}
</pre></div>



<a name="153965771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965771">(May 30 2018 at 20:21)</a>:</h4>
<p>or, for a complex data type:</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot; : &quot;Observation&quot;,
  &quot;value&quot;:  {
    &quot;_type&quot; : &quot;Coding&quot;,
   &quot;system&quot; : &quot;the-uri&quot;,
  &quot;code&quot; : &quot;the code&quot;
  }
}
</pre></div>



<a name="153965775"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965775" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965775">(May 30 2018 at 20:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> this looks prettier. May be use @type instead of _type (like json-ld). As well for unification we can change resourceType for @type too</p>



<a name="153965776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965776">(May 30 2018 at 20:31)</a>:</h4>
<p>I deliberately didn't propose @type because it's overloaded by json-ld and we would not be using it consistently with json-ld</p>



<a name="153965778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965778">(May 30 2018 at 20:32)</a>:</h4>
<p>I don't feel strongly about that. json-ld is problematic,  I think... I don't think we'll ever go there</p>



<a name="153965779"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965779" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965779">(May 30 2018 at 20:32)</a>:</h4>
<p>Another alternative is use type name as key - this will simplify exact access (at least in database) without filtering by type:  <code>resource.value.string or resource.value.Coding</code></p>



<a name="153965780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965780">(May 30 2018 at 20:33)</a>:</h4>
<p>resource.value.string.value ? yay!</p>



<a name="153965782"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965782" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965782">(May 30 2018 at 20:33)</a>:</h4>
<p>with primitive extensions - yes :(</p>



<a name="153965783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965783">(May 30 2018 at 20:33)</a>:</h4>
<p>but I don't see how resource.value.string is better than resource.valueString</p>



<a name="153965784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965784">(May 30 2018 at 20:34)</a>:</h4>
<p>it's an additional access point without any semantic improvement</p>



<a name="153965785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965785">(May 30 2018 at 20:34)</a>:</h4>
<p>It's more consistent, simple logical check - you will be able to have collection of polymorphics</p>



<a name="153965786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965786">(May 30 2018 at 20:35)</a>:</h4>
<p>As well check that value exists will be <code>resource.value is not null</code> instead of resource.valueString || resource.valueCoding</p>



<a name="153965788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965788">(May 30 2018 at 20:36)</a>:</h4>
<p>Another check - required constraints on it in json-schema using <em>required</em> key</p>



<a name="153965809"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965809" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965809">(May 30 2018 at 21:20)</a>:</h4>
<p>I'm a bit disconcerted by Josh (who was one of the stronges proponents of the current JSON syntax) indicating that he feels it was a mistake and Grahame (lead architect for FHIR) also saying it's a mistake.  And the sole arguments against change being "it impacts too many people".  </p>
<p>We are not yet normative.  If we're going to make this change, it would likely mean that the JSON couldn't go normative this cycle (though XML still could).  I suspect a lot of people will vote against this change because they use JSON for exchange, but don't use JSON internally and don't really care what the JSON looks like so long as it carries the data.  For them, change of any sort is bad.  However, I'm curious whether any of those who actually <em>use</em> JSON for storage or internal manipulation would vote against this change.  I'd hate for us to lock down on something where the community consensus is already "we did it wrong", but we feel we're too far along to change.</p>



<a name="153965813"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965813" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965813">(May 30 2018 at 21:26)</a>:</h4>
<p>well... specifically: the way we do primitives is a mistake. On balance, I don't agree with the other changes being discussed here.</p>



<a name="153965814"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965814" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965814">(May 30 2018 at 21:26)</a>:</h4>
<p>but I do think it's too late to change, personally</p>



<a name="153965815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965815">(May 30 2018 at 21:27)</a>:</h4>
<p>and those people who think that we don't value json as much as xml... there's <em>nothing</em> that could say that as strongly as not making json normative</p>



<a name="153965868"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965868" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dmitri Sotnikov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965868">(May 30 2018 at 22:20)</a>:</h4>
<p>Again, I'd like to point out that once the spec becomes normative everybody using it will be affected by it for a very long time to come. If there is a consensus that the current design is a mistake, it really should be changed. The inconvenience for the few early adopters is insignificant when considered against the burden this would put on literally every healthcare IT organization that will be using this standard. I can't stress this point enough.</p>



<a name="153965919"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965919" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965919">(May 30 2018 at 22:23)</a>:</h4>
<p>it's not a question of how much you stress the point, but how people will vote.</p>



<a name="153965951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965951">(May 30 2018 at 22:25)</a>:</h4>
<p>and I don't think that this is <em>that</em> big a deal. In fact, I think that many json implementers will vote for the current format, given a choice, simply because 100% of the primitives they deal with are simpler in the current format</p>



<a name="153965997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153965997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153965997">(May 31 2018 at 00:48)</a>:</h4>
<p>In our current system we are very much JSON-oriented and use it internally as our data structure (which was the simplest way to start). However, we are again and again hitting all the same issues mentioned above, with extensions and with type variants. In every place we work with data in a generic way we have to remember to handle extensions and type variants properly.</p>
<p>At this point it looks like restructuring the data would have been much better approach (and we already do that in one part of the system). It was deceptively "easy" to use JSON representation directly (I didn't think about extensions and type choices until I got familiar enough with FHIR).</p>
<p>On the other hand, as much as I would love to have an alternative JSON representation, supporting both XML and JSON means some conversion is still needed (at very least, arrays are represented differently, etc) -- and if you do it, you might as well do it for JSON, too.</p>



<a name="153966010"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153966010" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153966010">(May 31 2018 at 03:27)</a>:</h4>
<p>Oh, forgot about the GraphQL. The current JSON representation is also leaking into GraphQL API, which is also non ideal (polymorphic types are better represented using GraphQL unions, for example).</p>



<a name="153966029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153966029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153966029">(May 31 2018 at 07:51)</a>:</h4>
<p>i certainly considered that. But there was some reason I didn't.... I think because I wanted standard graphql logic over existing json to work as expected....</p>



<a name="153966069"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153966069" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153966069">(May 31 2018 at 13:20)</a>:</h4>
<blockquote>
<p>but I don't see how resource.value.string is better than resource.valueString</p>
</blockquote>
<p>When I mentioned the thing I wanted to change about our Xml representation, it was actually very similar to this: the fact that we have not separated clearly the type from the name has proven a disadvantage in a few spots.   For one, I'd like to offer my users a consistent path to a property, so my API's offer access using the name, not name+type - this requires access to metadata, even at the faster lower-levels of my parser.  Second, instead of a hashed lookup of the name, I need to compare prefixes in the list of elements, which is measurably slower again.  </p>
<p>Which is not to say I am in favor of changing the serialization format, that would cause me way more pain than this.  Having an "optional" alternative (as Nicolai suggested) would of course turn out into just  another obligation on the server writers, cause now you need to support both.  I would do it, but I can see not everyone would jump for joy...</p>



<a name="153966120"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153966120" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153966120">(May 31 2018 at 20:48)</a>:</h4>
<p>the HAPI POJOs create both paths... fine for the RI I know. but changing to that would have other strong disadvantages...</p>



<a name="153967249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967249">(Jun 06 2018 at 04:16)</a>:</h4>
<p>Blog about this: <a href="http://www.healthintersections.com.au/?p=2824" target="_blank" title="http://www.healthintersections.com.au/?p=2824">http://www.healthintersections.com.au/?p=2824</a></p>



<a name="153967267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Peter Jordan <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967267">(Jun 06 2018 at 05:24)</a>:</h4>
<p>If one JSON format is better for exchange and another for persistence, then the answer may be <em>just</em> for implementations to convert from one format to another where necessary and I'm guessing that the relevant class/utility already exists, somewhere. Agree that changing the exchange (FHIR) format at this stage looks bad from a product perspective and two exchange formats for JSON will hinder interoperability.</p>



<a name="153967301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967301">(Jun 06 2018 at 11:22)</a>:</h4>
<p>so we would not offer any advice about a single internal-suitable format?</p>



<a name="153967306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Knapp <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967306">(Jun 06 2018 at 11:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> I don't think you can make the assertion that "most implementers will use one of the reference implementations" given that A) many implement a façade and therefore don't require one of the reference implementations and B) most mature development shops will have to take financial and legal responsibility for their systems and that the reference systems are unlikely to accept that risk on their behalf.</p>



<a name="153967307"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967307" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967307">(Jun 06 2018 at 11:32)</a>:</h4>
<p>no. Lloyd was wrong about that. Many applications do, but many don't</p>



<a name="153967325"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967325" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Rupley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967325">(Jun 06 2018 at 13:06)</a>:</h4>
<p>As a sort of side-topic, I'd like to add that the <strong>JSON Schema</strong> backing all resources / data types is important to my organization. We develop a <a href="https://www.mirthcorp.com/community/wiki/display/mirth/Mirth+Connect+3.6.0+-+What's+New#MirthConnect3.6.0-What'sNew-FHIRConnectorExtension" target="_blank" title="https://www.mirthcorp.com/community/wiki/display/mirth/Mirth+Connect+3.6.0+-+What's+New#MirthConnect3.6.0-What'sNew-FHIRConnectorExtension">FHIR Connector Extension</a> for our open-source product called Mirth Connect that is used by thousands of healthcare implementers globally. The FHIR Connector uses the JSON Schema to create a dynamic <a href="https://www.mirthcorp.com/community/wiki/display/mirth/FHIR+Resource+Builder" target="_blank" title="https://www.mirthcorp.com/community/wiki/display/mirth/FHIR+Resource+Builder">GUI resource builder</a>.</p>
<p>It's important that if the JSON format changes, that the JSON Schema is also kept up to date. If the format "branches" into two possibilities, I think that can be expressed with a "oneOf" property. Or it may make sense to branch the entire thing into two separate schemas?</p>



<a name="153967327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Rupley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967327">(Jun 06 2018 at 13:07)</a>:</h4>
<p>EDIT: Sorry this Zulip interface is very confusing, can't tell if I'm replying to a thread or creating a new thread in this topic haha...</p>



<a name="153967477"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967477" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967477">(Jun 06 2018 at 16:18)</a>:</h4>
<p>I agree with <span class="user-mention" data-user-id="196058">@Nick Rupley</span>... it is important to keep the json schema updated.<br>
I also, however, believe that the current JSON format is very good for automatically generated GUIs</p>



<a name="153967481"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967481" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967481">(Jun 06 2018 at 16:19)</a>:</h4>
<p>Framework's like angular have problems binding to simple data types, and require binding to a primitive <em>within</em> an object</p>



<a name="153967483"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967483" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967483">(Jun 06 2018 at 16:20)</a>:</h4>
<p>Which is exactly what we do, now. So, I think we will equally-so run into issues with binding UI's (with frameworks like Angular) if we change the JSON format for primitives</p>



<a name="153967494"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967494" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967494">(Jun 06 2018 at 16:40)</a>:</h4>
<p>Just to also put this on the table: another (well documented) problem with the current JSON format is the disconnect between FHIR's <code>decimal</code> data type and how it's represented in JSON. Many JSON libraries have precision issues since they use float or double representations for numbers, and almost all lose trailing zeroes. The only solution to this particular problem I believe would be to represent decimals as string, which like all the other proposals here would make the JSON format "less native" to use IMHuO – tradeoffs vs. tradeoffs.</p>



<a name="153967525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967525">(Jun 06 2018 at 18:45)</a>:</h4>
<p>Current json format can not be accurately described by json schema, because primitive extensions and polymorphics. <span class="user-mention" data-user-id="191339">@Pascal Pfiffner</span>  if we make primitive to be json object i think decimal notation will be more clear {decimal: “...”}</p>



<a name="153967527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967527">(Jun 06 2018 at 19:53)</a>:</h4>
<p>we already comment about precision here: <a href="http://build.fhir.org/json.html#primitive" target="_blank" title="http://build.fhir.org/json.html#primitive">http://build.fhir.org/json.html#primitive</a></p>



<a name="153967528"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967528" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967528">(Jun 06 2018 at 19:53)</a>:</h4>
<p>this was also discussed at length... it wasn't simple</p>



<a name="153967529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967529">(Jun 06 2018 at 19:54)</a>:</h4>
<p>the current json format can be described completely with JSON schema but the schema doesn't tell you about the relationships e.g. between id and _id</p>



<a name="153967533"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967533" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967533">(Jun 06 2018 at 19:57)</a>:</h4>
<p>you can not express required constraints on primitives and only one for valueX or valueY on polymorphics</p>



<a name="153967537"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967537" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967537">(Jun 06 2018 at 20:01)</a>:</h4>
<p>there is no constraints on primitives. And I think I do express the only one thing. but it gets real complex if you mix primitives in the choice...</p>



<a name="153967545"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967545" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967545">(Jun 06 2018 at 20:14)</a>:</h4>
<p>Yes, this is documented and was discussed, just trying to ensure that it's mentioned in this thread in case JSON format redesign is indeed being considered.</p>



<a name="153967556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967556">(Jun 06 2018 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> ‘required’ means min=1 in profile</p>



<a name="153967557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967557">(Jun 06 2018 at 20:45)</a>:</h4>
<p>json schema does not have require ‘property a or b’ keyword</p>



<a name="153967558"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967558" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967558">(Jun 06 2018 at 20:46)</a>:</h4>
<p>and ‘one of property’</p>



<a name="153967559"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967559" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967559">(Jun 06 2018 at 20:47)</a>:</h4>
<p>ah yes, that is correct</p>



<a name="153967565"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967565" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967565">(Jun 06 2018 at 20:57)</a>:</h4>
<p>json schema probably should have that...</p>



<a name="153967585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hatt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967585">(Jun 06 2018 at 21:38)</a>:</h4>
<p>I voted <span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span> on revisiting the issue, only because I think it's going to be a recurring theme and a little more documentation around XML-&gt;JSON would help. I'll wager that people coming to FHIR/healthcare in 2018 are overwhelmingly coming from JSON backgrounds. They will ask the same question as <span class="user-mention" data-user-id="191318">@nicola (RIO/SS)</span> , and I think they deserve an answer. Reading through this thread has been difficult, so pointing people back to it would not be helpful.</p>



<a name="153967587"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967587" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Nick Hatt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967587">(Jun 06 2018 at 21:41)</a>:</h4>
<p>For example, this in the XML format documentation has always bugged me: </p>
<blockquote>
<p>Given the way extensions work, applications reading XML resources will never encounter unknown elements.</p>
</blockquote>
<p>If a core design principle is that <code>applications reading XML resources will never encounter unknown elements</code>, I'm fine with that, but it's helpful to know that that's a principle to quell my frustration with iterating through extensions in JSON.</p>



<a name="153967594"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967594" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967594">(Jun 06 2018 at 21:50)</a>:</h4>
<p>so you think we should repeat that on the JSON page?</p>



<a name="153967605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967605">(Jun 06 2018 at 22:00)</a>:</h4>
<p>We wouldn't necessarily need to repeat it on the JSON page, but having a separate page that provides background and context for why things are the way they are (perhaps with a link from the main JSON and XML pages) wouldn't be a bad thing.  Implementers could ignore, but those who have questions could read it or be directed there.</p>



<a name="153967606"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967606" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967606">(Jun 06 2018 at 22:01)</a>:</h4>
<p>might be wiki content...</p>



<a name="153967607"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967607" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967607">(Jun 06 2018 at 22:11)</a>:</h4>
<p>i still do not think current design is good and predict a lot of negative feedback in the future from json land :(</p>



<a name="153967608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967608">(Jun 06 2018 at 22:15)</a>:</h4>
<p>can we represent primitives as primitives in simple case and switch to object notation in case of extensions: ‘’’attr: “...” or ‘attr: { ext: ..., value: ...}’’’?</p>



<a name="153967609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967609">(Jun 06 2018 at 22:16)</a>:</h4>
<p>I kind of like that but I think that it would cause a lot of run time errors</p>



<a name="153967610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967610">(Jun 06 2018 at 22:17)</a>:</h4>
<p>this is more regular and this errors looks reasonable</p>



<a name="153967611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967611">(Jun 06 2018 at 22:17)</a>:</h4>
<p>I cannot recall that specific proposal ever being discussed before</p>



<a name="153967612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967612">(Jun 06 2018 at 22:20)</a>:</h4>
<p>at least in databases we will use “res.attr.value or res.attr” expression and this can be unified with polymorphics res.attr.string and res.attr.Quantity</p>



<a name="153967615"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967615" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967615">(Jun 06 2018 at 22:26)</a>:</h4>
<p>also polymorphics representation as res.attr.Quantity simplify fhirpath impl res.attr.as(Quantity)</p>



<a name="153967733"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967733" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967733">(Jun 07 2018 at 06:41)</a>:</h4>
<blockquote>
<p>also polymorphics representation as res.attr.Quantity simplify fhirpath impl res.attr.as(Quantity)</p>
</blockquote>
<p>Yes, that's one of the lovely aspects of separating the path from the type. If we'd consider that, we should do the same for XML though. I would not necessarily do it with a "." though, as it becomes ambiguous whether you are talking about a path or a type, so I would prefer another separator.</p>



<a name="153967734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967734">(Jun 07 2018 at 06:45)</a>:</h4>
<p>We've discussed alternatives like the one Nicolay describes (having both attr: and attr: { ext: value: }, but we shied away from it, because the path to the value would change depending on whether the value has extensions (or an id).   So, you'd have to try both "attr" and "attr.value" if the first is null.</p>



<a name="153967737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967737">(Jun 07 2018 at 06:55)</a>:</h4>
<p>actually the first would be an object, not null. json-ld does this with the @context</p>



<a name="153967738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967738">(Jun 07 2018 at 06:56)</a>:</h4>
<p>though it's either an object or string that's areference to the object. I don't remember discussing it</p>



<a name="153967783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967783">(Jun 07 2018 at 08:12)</a>:</h4>
<blockquote>
<p>actually the first would be an object, not null. json-ld does this with the @context</p>
</blockquote>
<p>Indeed, object.   So, is that a concern, <span class="user-mention" data-user-id="191318">@nicola (RIO/SS)</span> ?</p>



<a name="153967853"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967853" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967853">(Jun 07 2018 at 17:39)</a>:</h4>
<p>In the US DSTU2 is already widely used, and so here to stay for years - so changes to a new JSON format would mean that everyone in the US would have to support _both_ the new and the old formats</p>



<a name="153967871"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153967871" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153967871">(Jun 07 2018 at 19:48)</a>:</h4>
<p>yes that's true</p>



<a name="153968065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153968065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153968065">(Jun 08 2018 at 16:29)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span> it will be used after normative release  by much more users for a decades</p>



<a name="153968076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153968076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153968076">(Jun 08 2018 at 17:08)</a>:</h4>
<p>Maybe - but everyone would still have to support both formats for a good part of those decades</p>



<a name="153968093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153968093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153968093">(Jun 08 2018 at 19:00)</a>:</h4>
<p>Some servers does not support xml or json, so this is not a big problem :). I think, in later phase FHIR will be driven by implementations like HTTP, HTML and CSS is driven by browsers.</p>



<a name="153968176"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153968176" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153968176">(Jun 08 2018 at 23:37)</a>:</h4>
<p>I have to say, having reviewed some of my code.... I would strongly prefer </p>
<blockquote>
<p>represent primitives as primitives in simple case and switch to object notation in case of extensions: ‘’’attr: “...” or ‘attr: { ext: ..., value: ...}’’’?</p>
</blockquote>
<p>There's existing unreported bugs in my code in the corner cases around the existing approach</p>



<a name="153968177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153968177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153968177">(Jun 08 2018 at 23:41)</a>:</h4>
<p>but it seems, based on feedback to this point, there's just not enough interest to support a change this size. (lots of interest in a very small community...)</p>



<a name="153971014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971014">(Jun 21 2018 at 19:21)</a>:</h4>
<blockquote>
<p>However, I'm curious whether any of those who actually <em>use</em> JSON for storage or internal manipulation would vote against this change.  I'd hate for us to lock down on something where the community consensus is already "we did it wrong", but we feel we're too far along to change.</p>
</blockquote>
<p>So many thoughts.</p>
<p>+1 for Nicola’s concept of ‘inlining’, which I’ve referred to in the past as ‘flattening’ or ‘resolving’.  It would be great to see official rules and guidance on this.  Internally, FHIR resources will get globbed together into phylogenetic trees, cladograms, graphs, and other complex data structures.  The idea that resources are always exchanged in a Bundle is probably the largest discrepancy between the official spec and our use of FHIR in internal storage and data models.</p>
<p>The FHIR wire format being unusable without complex and fragile 3rd party libraries is just a matter of time.  Once the standard goes normative, we can begin adding more tooling and moving those libraries into database drivers, network drivers, preprocessors, build tools, IDEs, etc.  That becomes possible when the standard goes normative and we can point other organizations to a spec that has the backing of HL7 and ANSI.</p>
<p>Also, if the wire format doesn’t support FHIR natively, change the wire protocol!  Which is essentially what we’ve begun to do by defining the <code>application/json+fhir</code> mime type.  HL7 and ANSI have enough political clout and long-term process management, that they can think in these terms.  Lets keep in mind that we’re defining a new standard through formal standards development processes, rather than simply writing software that conforms to existing standards.</p>
<p>That we have to go through a complex, error prone, and expensive parsing step before we’re able to work with the data effectively isn’t a convincing argument to me.  That’s  basically the experience of anybody who has used or written their own network driver.  This issue has been present since the dawn of telecommunications.  Let’s just be glad that our complex, error prone, and expensive encoding/decoding is human readable in JSON and English and is well documented in a robust API.  And that it’s not pipe delimited, or requires us parsing ZMODEM or Kermit parameters.</p>
<p>But once we receive the data, we have to write it to the database.  Besides decimal representation, date and geolocation lat/long are the things we have to regularly accommodate for. We’re slowly refining and refactoring our database mapping functions, and will eventually get them into a differential package that we can submit to Mongo.  </p>
<p>Date usage, and the need to handle partial knowledge about birthdates, is probably the $64K healthcare use case that drives the need to actually depart from existing JSON primitives.  We currently cast to a Date() object for internal storage, but that’s clinically problematic for a bunch of reasons.  We make heavy use of the Moment.js library, which comes close to being able to parse the HL7 rules on date management; and will probably wind up attaching a Provenance resource to the object if there’s not enough information to resolve to an ISO Date.  Like...  if we get a birthdate that is simply “1950”, we’re currently storing as “Jan 1st, 1950, 00:00:00’, and will probably add a meta tag or extension that points to a provenance value set or Provenance resource type that says ‘this date is fuzzy and unknown’.  </p>
<p>Trivia fact... the first video monitor was actually a cathode ray tube, which was used as a storage device at the time.  So Sean’s comments about Angular’s problems with binding to simple data types is actually quite relevant and has a long history.  We deal with something similar, in that we’re using isomorphic code, and have a library called minimongo that implements our server side storage API in the web browser.  So, those storage issues with decimal, date, and lat/long are on both server and client.  But, by the same token, we have an isomorphic library that can box/unbox the values as needed.</p>
<p>Regarding disk storage, we’d like to see the application/json+fhir` mime type extended to a file extension.  Do we simply save a FHIR file as a .json file?  I quite like having .fhir, .ccd, and .bundle extensions.  </p>
<p>tl;dr - Personally, we’re fine with the approach to primitives that’s been developed to date, and wouldn’t want to hold up R4 normative with a last minute change.  Would encourage people to think about the life cycle of a standard, and how once things go normative, it will lead to tooling, drivers, etc that support the standard - even if they dont currently exist.</p>
<p>Apologies for the wall of text.</p>



<a name="153971018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971018">(Jun 21 2018 at 20:15)</a>:</h4>
<p>Why both .fhir and  .bundle extensions?</p>



<a name="153971023"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971023" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971023">(Jun 21 2018 at 21:35)</a>:</h4>
<p>We have different import rules based on the file extension.  We’re stIll a bIt undecided if clinical workflow is better supported by defining the extension as data content type or top level resource.  There’s an argument for either (or even both, as in the case of <code>TestPatient.bundle.fhir</code> vs <code>TestPatient.Medication.fhir</code>).  The biggest use case by far is import/export functionality.  Which is a type of file transfer and interoperability if you think about it... data transfer via persistent data storage.</p>



<a name="153971028"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971028" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971028">(Jun 21 2018 at 22:05)</a>:</h4>
<p>And if you really want to run with the idea, consider how DICOM works as a container mechanism for JPG files (analagous to the manilla patient record folders).  Maybe a .fhir extension shouldn’t be a modified .json file at all.  Maybe it should be a password protected .zip file, which would enforce encrypted data at rest and HIPAA compliance.  Just a thought.</p>



<a name="153971032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971032">(Jun 22 2018 at 00:03)</a>:</h4>
<p>Different types of Bundles would be handled differently though.  And we may eventually have other FHIR resource types (or environments where other existing FHIR resource types) are handled differently.  I think that if the system knows it's FHIR, that's enough information to look inside and decide how it wants to process it.</p>



<a name="153971034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971034">(Jun 22 2018 at 00:28)</a>:</h4>
<p>Totally agreed the resourceType field has all the logic we need, and using .bundle or other .resourceType extensions probably isn’t the way to go.  If it’s a .fhir extension, expect to be able to open up the file and find a resourceType field.  That alone would be hugely useful to draft into the specification.</p>



<a name="153971036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971036">(Jun 22 2018 at 00:30)</a>:</h4>
<p>The one thing tha does, though, is locks .fhir into being a .json analog (totally reasonable), so using it as a .zip file is out.  Which makes me then think about .sfhir</p>



<a name="153971037"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971037" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971037">(Jun 22 2018 at 00:31)</a>:</h4>
<p>SFHIR = Secure Fast Healthcare Interoperability Resource = password encrypted zip file containing a .fhir file</p>



<a name="153971104"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/153971104" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#153971104">(Jun 22 2018 at 13:33)</a>:</h4>
<p>That does raise the question of whether we need a different extension for the JSON, XML, RDF and eventually other syntaxes used with fhir.</p>



<a name="204120749"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/204120749" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ivan Dubrov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#204120749">(Jul 16 2020 at 18:07)</a>:</h4>
<p>I apologize for necroposting, but I need to vent a bit since I'm facing this issue once again.</p>
<p>After almost three years working with FHIR (which included implementing both a FHIR-native server and frontend libraries), I can say that current JSON representation is one of the biggest obstacles (mostly, for frontend / JavaScript-based platforms).</p>
<p>On backend, where we use non-JavaScript based language (Rust), we designed our static types in a way that they reflect FHIR semantics (where primitive types are actual composite objects and type choices are choice types, enums). It did require us to write our custom serializers / deserializers for JSON since standard one wouldn't map data the way we wanted, but there were other reasons to do that anyway, and in the end, it's not that complicated. It worked out pretty well in the end, I think. However, it was possible primarily because we were able to restrict wire format issue to deserialization / serialization logic, which happens early.</p>
<p>However, frontend part, where everything is "JSON-native", and there is really no need for "deserialization" to happen, current JSON representation is a huge problem:</p>
<ul>
<li>It's hard to express types (say, TypeScript) over existing JSON representation that are accurate.</li>
<li>Being not able to pass primitive value as a single value makes all kinds of auto-generated or metadata-driven forms really hard.</li>
<li>Same for type choices</li>
<li>Writing data back to resource (updating its fields) requires knowledge of parent of item being edited: you cannot just "return" updated value. Somewhat manageable for primitives which could be special-cased (because you have two places to write at most, the value itself, and its "element" counterpart), but worse for type choices (where you would need to know all the other possible fields to look at). Typechoices with primitive values? Oh, well. Actually, primitives are also quite difficult for the case when arrays of primitives are involved.</li>
<li>As an extension of previous problem, (React) state management for any kind of forms based on FHIR type (say, editor for OperationDefinition) is _really_ hard because state management works well when you can structure your components such that children "selects" subset of state from their parent, and it is not easy / possible with current scheme.</li>
<li>Since extensions are relatively rare on primitives, it encourages yolo approach ("you only live once") to development where extensions are simply ignored.</li>
</ul>
<p>These issues are not impossible to solve, but they really throw a wrench into any kind of metadata-driven approach to FHIR resources.</p>
<p>I understand concerns about the need to support yet another wire format. I would expect that upgrading backend systems should be less of an issue (although, will incur some cost), but will impact existing frontend / JavaScript-based libraries.</p>
<p>I'm optimistic, though, that in the end it would be a net positive change.</p>



<a name="204157806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/JSON%20Format%20for%20Primitives%20%26%20extensions/near/204157806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/JSON.20Format.20for.20Primitives.20.26.20extensions.html#204157806">(Jul 16 2020 at 23:58)</a>:</h4>
<p>These are all the same arguments I made back when we settled on the current format. But it really is too late to change</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
