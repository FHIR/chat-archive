---
layout: page
title: "FHIR Chat  · Message Bundle support · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html">Message Bundle support</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="226975694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226975694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226975694">(Feb 19 2021 at 15:08)</a>:</h4>
<p>Hi, we're struggling with our FHIR Bundle type Message <a href="/user_uploads/10155/xIkk2SFaYxYJf8d6sCv6ayxK/BundleAdrenalEx.xml">BundleAdrenalEx.xml</a> We were able to test successfully against <a href="http://test.fhir.org/r4">test.fhir.org/r4</a> but not against HAPI, Vonk, Spark, Aegis. Is Bundle.type Message not widely supported at this time? <span class="user-mention" data-user-id="193795">@Joel Francis</span></p>



<a name="226976883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226976883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226976883">(Feb 19 2021 at 15:15)</a>:</h4>
<p>Are you just trying to store it (posting it to the Bundle endpoint) or are you trying to have it processed?  None of the reference implementations can process messages because processing requires specific coding for each message definition.</p>



<a name="226982415"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226982415" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226982415">(Feb 19 2021 at 15:51)</a>:</h4>
<p>We have some custom code which validates using a MessageDefinition  resource. <br>
The eventCoding in a MessageDefinition must match in the FHIR Message Bundle.MessageHeader.eventCoding.</p>
<p>MessageDefinition states the profile to be used for the focus resource. <br>
E.g.<br>
<a href="https://simplifier.net/guide/DigitalMedicines/dispense-notification">https://simplifier.net/guide/DigitalMedicines/dispense-notification</a></p>
<p>These resources (MedicationDispense) are validated using that profile.</p>



<a name="226982783"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226982783" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226982783">(Feb 19 2021 at 15:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191320">Lloyd McKenzie</span> <a href="#narrow/stream/179166-implementers/topic/Message.20Bundle.20support/near/226976883">said</a>:</p>
<blockquote>
<p>Are you just trying to store it (posting it to the Bundle endpoint) or are you trying to have it processed?  None of the reference implementations can process messages because processing requires specific coding for each message definition.</p>
</blockquote>
<p>Just a post, we typically get a 400 or 501 bad request, but it works on <a href="http://test.fhir.org/r4">test.fhir.org/r4</a></p>



<a name="226983470"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226983470" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226983470">(Feb 19 2021 at 15:58)</a>:</h4>
<p>A post to what endpoint?  Bundle or $process-message?</p>



<a name="226985784"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226985784" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226985784">(Feb 19 2021 at 16:08)</a>:</h4>
<p>Bundle</p>



<a name="226986797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226986797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226986797">(Feb 19 2021 at 16:15)</a>:</h4>
<p>ca.uhn.fhir.rest.server.exceptions.InvalidRequestException: HTTP 400 Bad Request: Unable to process transaction where incoming Bundle.type = message</p>



<a name="226989798"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226989798" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226989798">(Feb 19 2021 at 16:33)</a>:</h4>
<p>We found out our text element was failing on multiple servers, but working fine on <a href="http://test.fhir.org">test.fhir.org</a></p>



<a name="226990250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226990250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226990250">(Feb 19 2021 at 16:35)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> we had issues with our text element with the Bundle Message attached above. Here's the  OperationOutcome we got from HAPI</p>
<div class="codehilite"><pre><span></span><code>{
    &quot;resourceType&quot;: &quot;OperationOutcome&quot;,
    &quot;text&quot;: {
        &quot;status&quot;: &quot;generated&quot;,
        &quot;div&quot;: &quot;&lt;div xmlns=\&quot;http://www.w3.org/1999/xhtml\&quot;&gt;&lt;h1&gt;Operation Outcome&lt;/h1&gt;&lt;table border=\&quot;0\&quot;&gt;&lt;tr&gt;&lt;td style=\&quot;font-weight: bold;\&quot;&gt;ERROR&lt;/td&gt;&lt;td&gt;[]&lt;/td&gt;&lt;td&gt;&lt;pre&gt;Failed to parse request body as JSON resource. Error was: Failed to parse JSON encoded FHIR content: Illegal unquoted character ((CTRL-CHAR, code 10)): has to be escaped using backslash to be included in string value\n at [Source: UNKNOWN; line: 11, column: 20]&lt;/pre&gt;&lt;/td&gt;\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t&lt;/tr&gt;\n\t\t&lt;/table&gt;\n\t&lt;/div&gt;&quot;
    },
    &quot;issue&quot;: [
        {
            &quot;severity&quot;: &quot;error&quot;,
            &quot;code&quot;: &quot;processing&quot;,
            &quot;diagnostics&quot;: &quot;Failed to parse request body as JSON resource. Error was: Failed to parse JSON encoded FHIR content: Illegal unquoted character ((CTRL-CHAR, code 10)): has to be escaped using backslash to be included in string value\n at [Source: UNKNOWN; line: 11, column: 20]&quot;
        }
    ]
}
</code></pre></div>



<a name="226994630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226994630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226994630">(Feb 19 2021 at 17:04)</a>:</h4>
<p>Systems <em>should</em> allow storing Bundles of whatever type at the Bundle endpoint.  But they're not required to.</p>



<a name="226995261"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/226995261" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#226995261">(Feb 19 2021 at 17:08)</a>:</h4>
<p>Do you have a copy of the JSON version?  The example you posted is an XML and the error from HAPI is about parsing JSON.  I'm wondering if there's an error in the conversion.  (also, just to be sure; are you setting the content type on the request?)</p>



<a name="227006628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/227006628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#227006628">(Feb 19 2021 at 18:30)</a>:</h4>
<p><a href="/user_uploads/10155/8LGO3wVa-O649G5ECBBDv2ts/BundleAdrenal.json">BundleAdrenal.json</a></p>



<a name="227006675"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/227006675" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alex Goel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#227006675">(Feb 19 2021 at 18:30)</a>:</h4>
<p>Whoops! Yes we do. Here it is <span class="user-mention" data-user-id="222054">@Gino Canessa</span></p>



<a name="227007582"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/227007582" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#227007582">(Feb 19 2021 at 18:36)</a>:</h4>
<p>The JSON is malformed; you cannot have actual newlines in the text (need to replace with <code>\n</code>).  <del>As a note, those characters shouldn't be there anyway, since you should not have anything between the delimiter and literal (e.g., should be <code>&lt;div</code>).</del> (edit: doing too many things at once =)</p>
<p>Fixing the two instances of that (can test in <a href="https://jsonlint.com">https://jsonlint.com</a>) lets it pass validation, I think it will work after that.</p>



<a name="227148788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Message%20Bundle%20support/near/227148788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Mayfield <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Message.20Bundle.20support.html#227148788">(Feb 21 2021 at 07:08)</a>:</h4>
<p>If you don't want use the individual resources and not just store it, I would consider having some sort of processor to convert the message into a transaction bundle. </p>
<p>Message bundle is not a format I would expect epr or fhir servers to directly support without some form of processing. They would use a message handling component to handle the interaction.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
