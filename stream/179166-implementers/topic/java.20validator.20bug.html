---
layout: page
title: "FHIR Chat  · java validator bug · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html">java validator bug</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="223816027"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223816027" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223816027">(Jan 24 2021 at 14:17)</a>:</h4>
<p>The current version of the validator seems to be broken: </p>
<div class="codehilite"><pre><span></span><code> Terminology server http://tx.fhir.orgException in thread &quot;main&quot; java.lang.NoClassDefFoundError: okhttp3/Request$Builder
</code></pre></div>
<p>workaround: -tx n/a</p>



<a name="223816089"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223816089" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223816089">(Jan 24 2021 at 14:18)</a>:</h4>
<p>Looks like a fried dependency</p>



<a name="223817605"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817605" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817605">(Jan 24 2021 at 14:56)</a>:</h4>
<p>fix: <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/422">https://github.com/hapifhir/org.hl7.fhir.core/pull/422</a><br>
@fyi <span class="user-mention" data-user-id="248736">@Mark Iantorno</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="223817628"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817628" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817628">(Jan 24 2021 at 14:57)</a>:</h4>
<p>That will break hapi fhir</p>



<a name="223817685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817685">(Jan 24 2021 at 14:58)</a>:</h4>
<p>The dependency needs to be marked as optional. The original okhttp dependency in the r5 library was changed to optional a day or two ago, and that's what is causing the issue right now</p>



<a name="223817700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817700">(Jan 24 2021 at 14:59)</a>:</h4>
<p>Let me take a quick look at how to properly fix the dependencies such that no other downstream projects get borked</p>



<a name="223817921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817921">(Jan 24 2021 at 15:04)</a>:</h4>
<p>I left a comment, please just add the optional tag to the dependency</p>



<a name="223817923"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817923" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817923">(Jan 24 2021 at 15:04)</a>:</h4>
<p>that will fix it for now</p>



<a name="223817931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223817931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223817931">(Jan 24 2021 at 15:05)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span></p>



<a name="223818013"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223818013" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223818013">(Jan 24 2021 at 15:07)</a>:</h4>
<p>thanks for the fast response, added the optional tag</p>



<a name="223818081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223818081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223818081">(Jan 24 2021 at 15:09)</a>:</h4>
<p>eh, no problem, I have to add a test that actually runs the validator on a test file</p>



<a name="223818082"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223818082" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223818082">(Jan 24 2021 at 15:09)</a>:</h4>
<p>to make sure changes don't break it</p>



<a name="223818083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223818083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223818083">(Jan 24 2021 at 15:10)</a>:</h4>
<p>might do that this week if I have time</p>



<a name="223823782"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223823782" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223823782">(Jan 24 2021 at 17:06)</a>:</h4>
<p>The fixed build is now live</p>



<a name="223823785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223823785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223823785">(Jan 24 2021 at 17:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> please let me know if there are any issues</p>



<a name="223828364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223828364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223828364">(Jan 24 2021 at 18:44)</a>:</h4>
<p>hmmm. This fixed the issue for me locally, running it in intelliJ. The new released Version still got the issue. The optional dependency seems to be ignored while building the CLI Validator.</p>



<a name="223828433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223828433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223828433">(Jan 24 2021 at 18:46)</a>:</h4>
<p>Testing also adding it directly into the cli pom, non optional.</p>



<a name="223828484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223828484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223828484">(Jan 24 2021 at 18:46)</a>:</h4>
<p>*currently</p>



<a name="223828523"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223828523" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223828523">(Jan 24 2021 at 18:47)</a>:</h4>
<p>ok, seems to be the fix. Will Push in a sec</p>



<a name="223829223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223829223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223829223">(Jan 24 2021 at 19:01)</a>:</h4>
<p><a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/425">https://github.com/hapifhir/org.hl7.fhir.core/pull/425</a></p>



<a name="223829349"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223829349" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223829349">(Jan 24 2021 at 19:03)</a>:</h4>
<p>I also found another issue in the validator logic: Validation Addresses with pattern on them always caused a wrong validation error on the line.size (in pattern line.size can be &gt;= compared to the pattern line size).<br>
I applied the same logic as in the CodingCheck.</p>



<a name="223829429"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223829429" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223829429">(Jan 24 2021 at 19:04)</a>:</h4>
<p>length validation of line now works on addresses with pattern on Address.</p>



<a name="223829464"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223829464" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223829464">(Jan 24 2021 at 19:05)</a>:</h4>
<p>PR here: <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/424">https://github.com/hapifhir/org.hl7.fhir.core/pull/424</a><br>
<span class="user-mention" data-user-id="248736">@Mark Iantorno</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span></p>



<a name="223906977"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223906977" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223906977">(Jan 25 2021 at 14:51)</a>:</h4>
<p><span class="user-mention" data-user-id="191451">@Patrick Werner</span> I merged it in and it will be in 5.2.20</p>



<a name="223906991"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223906991" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223906991">(Jan 25 2021 at 14:51)</a>:</h4>
<p>should be available soon</p>



<a name="223913117"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/223913117" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#223913117">(Jan 25 2021 at 15:33)</a>:</h4>
<p>works thanks!</p>



<a name="224172008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/224172008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#224172008">(Jan 27 2021 at 12:11)</a>:</h4>
<p><span class="user-mention" data-user-id="248736">@Mark Iantorno</span> is there a chance of merging this PR: <a href="https://github.com/hapifhir/org.hl7.fhir.core/pull/424">https://github.com/hapifhir/org.hl7.fhir.core/pull/424</a> soon as well?<br>
Currently the validator always throws Errors on Address.line cardindality if you specify a pattern on Address.</p>



<a name="224190552"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/224190552" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#224190552">(Jan 27 2021 at 14:44)</a>:</h4>
<p>Looks good. Just please add a line describing the change to the RELEASE_NOTES.md file</p>



<a name="224190580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/224190580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#224190580">(Jan 27 2021 at 14:44)</a>:</h4>
<p><code>* Fixed this issue by doing this</code></p>



<a name="224190588"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/224190588" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#224190588">(Jan 27 2021 at 14:44)</a>:</h4>
<p>something like that</p>



<a name="224190600"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/java%20validator%20bug/near/224190600" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mark Iantorno <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/java.20validator.20bug.html#224190600">(Jan 27 2021 at 14:44)</a>:</h4>
<p>with the proper details of course</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
