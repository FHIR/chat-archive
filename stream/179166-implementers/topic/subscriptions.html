---
layout: page
title: "FHIR Chat  · subscriptions · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html">subscriptions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153858673"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858673" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858673">(Nov 28 2016 at 13:47)</a>:</h4>
<p>What is the conceptual difference between messaging &amp; rest hook? Where is http long-polling, most used &amp; robust technology for event driven notifications in web?  For web-sockets and long-polling  - creation of subscription could be part of communication (i.e. first phase), so we do not need to coordinate two operations on servers.</p>



<a name="153858674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858674">(Nov 28 2016 at 13:52)</a>:</h4>
<p>For REST hooks additional security configuration &amp; workflow should be specified (like signatures or message verification).</p>



<a name="153858677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858677">(Nov 28 2016 at 13:59)</a>:</h4>
<p>The main difference in my understanding is that in the case of Messaging, the configuration of the trigger events is out-of-band... Where in rest hook they are inline. -- Security should be considered equally for both, risk based.</p>



<a name="153858716"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858716" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858716">(Nov 28 2016 at 18:43)</a>:</h4>
<p>do we need to specify anything for long-polling? I think not...?<br>
as for additinoal things about REST hooks.... what else do you think we need to specify?</p>



<a name="153858752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858752">(Nov 28 2016 at 21:38)</a>:</h4>
<p>For example, for long-polling it could be like this - POST with subscription resource will be kept until new event with update message response or timeout. Ephemeral Subscription resource will be created during long-polling request.</p>



<a name="153858754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858754">(Nov 28 2016 at 21:42)</a>:</h4>
<p>Or post with long-polling subscription will return long-polling url with offset.</p>



<a name="153858757"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858757" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858757">(Nov 28 2016 at 21:44)</a>:</h4>
<p>For REST hook - secret token could be added to subscription.</p>



<a name="153858758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858758">(Nov 28 2016 at 21:46)</a>:</h4>
<p>but why not just make the query?</p>



<a name="153858759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858759">(Nov 28 2016 at 21:46)</a>:</h4>
<p>as for secret token, how would that work? be part of the URL? a header?  - already both supported</p>



<a name="153858760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858760">(Nov 28 2016 at 21:46)</a>:</h4>
<p>Looks like I missed getting the refactoring of the endpoint resource into it too. (don't recall if I created a task)</p>



<a name="153858836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858836">(Nov 29 2016 at 05:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, do you mean just do read, search or history with long-polling parameter?</p>



<a name="153858839"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858839" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858839">(Nov 29 2016 at 05:51)</a>:</h4>
<p>For REST hook, I think, secret should not be exposed for read/search i.e. masked or hidden.</p>



<a name="153858846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858846">(Nov 29 2016 at 06:19)</a>:</h4>
<p>yes that's what I meant. </p>



<a name="153858847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858847">(Nov 29 2016 at 06:19)</a>:</h4>
<p>does it work&gt; </p>



<a name="153858848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858848">(Nov 29 2016 at 06:20)</a>:</h4>
<p>for rest hook, how not to expose it? don't understand?</p>



<a name="153858856"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858856" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858856">(Nov 29 2016 at 07:12)</a>:</h4>
<p>Then we need new parameter to say it's "long-polling" request and some capability in conformance, and markers for search parameters (could be used in "long-polling")</p>



<a name="153858875"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858875" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858875">(Nov 29 2016 at 09:19)</a>:</h4>
<p>how would you typically use long polling? </p>



<a name="153858913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858913">(Nov 29 2016 at 10:34)</a>:</h4>
<p>We've implemented secure messaging using long-polling: for every subscriber there is current offset (stream) in event/message log, client (subscriber) do long-polling request with current offset, if server offset is bigger, then it respond instantly with new data or hangs this request until incoming  events (messages), respond includes next offset.  Client is responsible to reconnect and manage offset. (this pattern comes from popular kafka message queue pattern - <a href="https://kafka.apache.org/documentation" target="_blank" title="https://kafka.apache.org/documentation">https://kafka.apache.org/documentation</a>). Looks like the same pattern could be used for robust subscription stream.</p>



<a name="153858916"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858916" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858916">(Nov 29 2016 at 10:38)</a>:</h4>
<p>well, how would you imagine that? A history operation with a wait=true parameter?</p>



<a name="153858917"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858917" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858917">(Nov 29 2016 at 10:38)</a>:</h4>
<p>Yes</p>



<a name="153858920"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858920" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858920">(Nov 29 2016 at 10:41)</a>:</h4>
<p>so that's kind of a useful thing to add, but not equivalent because it doesn't have the search. </p>



<a name="153858921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858921">(Nov 29 2016 at 10:42)</a>:</h4>
<p>harder for me to imagine it on a search. a parameter future=true. - ignore what you could find now, and return a new resource next time it matches...?</p>



<a name="153858926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858926">(Nov 29 2016 at 10:48)</a>:</h4>
<p>We need to identify from which point in time we want to subscribe - it should be something like offset, etag or link in search bundle like paging  -   updates_url. Internally we gonna use transaction id as version id for resources and as natural offset for subscriptions (singular operations  will be transaction with one operation).</p>



<a name="153858929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858929">(Nov 29 2016 at 10:50)</a>:</h4>
<p>Another concern that not all search queries could be efficiently implemented as reactive, so may be some restrictions on search parameters for subscriptions are required.</p>



<a name="153858931"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858931" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858931">(Nov 29 2016 at 10:52)</a>:</h4>
<p>Also long-polling often fall back to just request if server has something to response</p>



<a name="153858964"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858964" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858964">(Nov 29 2016 at 13:55)</a>:</h4>
<p>Note that with long-polling; the socket needs to be created with keep-alive enabled. This allows for detection of a broken connection, thus allowing cleanup of resources.</p>



<a name="153858985"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858985" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858985">(Nov 29 2016 at 17:56)</a>:</h4>
<p>Probably going to need a SubscriptionCapability resource so clients can introspect the subscription capability of the server. that'd be an STU4 thing. In the meantime, I'm still not clear on how search would / should work. Maybe </p>
<p>GET [base]/Observation?code=[LN]&amp;_future=true</p>
<p>Then, every time there's a match, the server sends a chunked budle, with trunk for each entry. Client has to read each chunk individually. Well, can, at least</p>



<a name="153858989"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858989" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858989">(Nov 29 2016 at 18:03)</a>:</h4>
<p>Hope, we will prototype and evaluate this approach soon. In most cases notifying client  - that something has changed - even more valuable, than deliver this changes, because client could just retrieve changed data with ordinary REST request.</p>



<a name="153858995"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153858995" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153858995">(Nov 29 2016 at 18:26)</a>:</h4>
<p>ok, well let us know...</p>



<a name="153859245"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859245" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859245">(Nov 30 2016 at 13:03)</a>:</h4>
<p>As for not exposing secrets: @<strong>nicola (RIO)</strong> are your concerns not addressed by the use of TLS?  I usually see these schemes for things like GitHub web Hooks where they need to be able to deliver over regular http.</p>



<a name="153859246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859246">(Nov 30 2016 at 13:05)</a>:</h4>
<p>I just followed analogy with password :) It's good practice never expose password.</p>



<a name="153859322"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859322" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859322">(Nov 30 2016 at 21:21)</a>:</h4>
<p>Typically during a sign-in flow (like, for a web app), clients do send a password to a server (protected via TLS). Then the password is hashed and checked on the server side against a stored hashed/salted password.</p>



<a name="153859324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859324">(Nov 30 2016 at 21:26)</a>:</h4>
<p>Josh, that would be true for some forms based authentication. I thought we were recommending OpenID Connect authentication flows. For which there might be a forms based interaction between the client and the OpenID Connect authority; but that communication does not involve the Client-Server communication. It is orthogonal, yet results in OAuth credential used in Client-Server communications. Yes that form is covered by https. But the most important part is that the authentication step is independent. Thus that authentication step can leverage any authentication methods that the authentication authority wants to use (smart-card, id-token, biometrics, etc). And none of that is exposed to the Client or Server.</p>



<a name="153859326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859326">(Nov 30 2016 at 21:29)</a>:</h4>
<p>an OAuth token can be used in a subscription. It is important to recognize expirations of the token. Often this is managed through the long-polling resulting in only a notification that something has changed, requiring the client to try again. That try again might need a refreshed token... All the kinds of Security-Risks one needs to think about and manage.</p>



<a name="153859327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859327">(Nov 30 2016 at 21:32)</a>:</h4>
<p>Hence the Apple model of simply holding the TCP in FIN-WAIT; with the server closing when it has something to say.</p>



<a name="153859331"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859331" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859331">(Nov 30 2016 at 21:43)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> Sorry, we're talking past each other. @<strong>nicola (RIO)</strong> was using an analogy and I was replying in kind.</p>



<a name="153859332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859332">(Nov 30 2016 at 21:43)</a>:</h4>
<p>Certainly SMART on FHIR uses OpenID Connect for authentication, and a user should not be entering their EHR or portal password directly into an app.</p>



<a name="153859333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859333">(Nov 30 2016 at 21:44)</a>:</h4>
<p>understood. I was mostly trying to get details into the thread, not so much worried about responding to you.  It is hard to get people to use  'good practices', with the hope that someday we have a 'best practice' :-)</p>



<a name="153859334"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859334" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859334">(Nov 30 2016 at 21:45)</a>:</h4>
<p>I'm just saying that when you sign into a web site, like your bank or whatever... when you fill in a password box, that password is sent directly as a form param to the bank (not hashed client-side, or whatever).</p>



<a name="153859337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859337">(Nov 30 2016 at 21:46)</a>:</h4>
<p>Yes, with Forms based (authentication), like any form, the result is sent to the server. In authentication it is hoped that the server uses hashes (salted), rather than non-secure comparison mechanisms.</p>



<a name="153859338"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859338" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859338">(Nov 30 2016 at 21:47)</a>:</h4>
<p>the 'good practice' I want to encourage is the use of 'off-the-shelf' OpenID Connect solutions where ALL of this is not re-invented by healthcare developers.</p>



<a name="153859580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859580">(Dec 01 2016 at 08:21)</a>:</h4>
<p>....</p>



<a name="153859585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153859585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153859585">(Dec 01 2016 at 10:48)</a>:</h4>
<p>I mean, if we have subscription as resource - so we could list &amp; search subscriptions, it looks more secure do not show sensitive information like secret (access_token or whatever) as result of search/read operations, because this is  vulnerability for recipient - i.e. when attacker will get access to list of subscriptions, she will get access to REST hook or message endpoint of subscriber.</p>



<a name="153904378"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904378" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904378">(Sep 04 2017 at 07:50)</a>:</h4>
<p>Regarding the text on subsciptions on <a href="http://build.fhir.org/subscription.html" target="_blank" title="http://build.fhir.org/subscription.html">http://build.fhir.org/subscription.html</a> - section ""2.47.2" - <em>As an alternative to subscriptions, the RESTful API describes a polling-based subscription method using bundles and the history operation. This method of polling allows for a much tighter relationship between the client and the server that doesn't involve missing updates and/or deletes.</em></p>



<a name="153904379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904379">(Sep 04 2017 at 07:50)</a>:</h4>
<p>What does polling a REST service has to do with subscriptions?</p>



<a name="153904380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904380">(Sep 04 2017 at 07:52)</a>:</h4>
<p>I can't see how polling a server is any guarantee that updates are missed. Actually, it more or less guarantees the opposite.</p>



<a name="153904381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904381">(Sep 04 2017 at 07:54)</a>:</h4>
<p>With polling you are guaranteed to become stale right after you as a client has polled. So the sentence makes little sense</p>



<a name="153904391"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904391" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904391">(Sep 04 2017 at 15:32)</a>:</h4>
<p>The polling based approach allows you to see what's changed since you last looked.  If things have changed more than once - and you care about interim changes - you'd need to do a subsequent "history" query to get the remainder or your polling query would itself need to be a history query.</p>



<a name="153904411"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904411" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904411">(Sep 05 2017 at 01:29)</a>:</h4>
<p>polling with any filter creates problems where a resource changes to not meet the filter</p>



<a name="153904412"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904412" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904412">(Sep 05 2017 at 01:29)</a>:</h4>
<p>it silently falls out</p>



<a name="153904426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904426">(Sep 05 2017 at 09:37)</a>:</h4>
<p>Regarding the phrase - 'The consequence of this is that there is no notification when a resource is deleted, or when a resource is updated so that it no longer meets the criteria.'</p>



<a name="153904432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904432">(Sep 05 2017 at 11:06)</a>:</h4>
<p>Imagine the following flow:<br>
When the client issues a subscription, the server acknowledges the subscription and returns a bundle including the subscription as well as the evaluated result of the criteria (initial result set). now, whenever a change occurs that would result in a different result set, the change is sent - this could be either an update, create or delete. To my understanding there is no such mechanism defined currently within this spec. Does this sound out of scope to you?</p>



<a name="153904433"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904433" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904433">(Sep 05 2017 at 11:09)</a>:</h4>
<p>It probably requires versioned bundles ...</p>



<a name="153904434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904434">(Sep 05 2017 at 11:22)</a>:</h4>
<p>I don't think we've talked about returning the initial set. the rest is ok. Are you on the subscription stream here?</p>



<a name="153904436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153904436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153904436">(Sep 05 2017 at 11:42)</a>:</h4>
<p>I now subscribe to the subscription channel ;)</p>



<a name="153914032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914032">(Oct 16 2017 at 09:10)</a>:</h4>
<p>Hi<br>
My system handles appointments and I am working with the business need: Notify external systems when a patient with an appointment arrives.<br>
We only have appointments with one patient - not many patients.<br>
My system has a high volume of appointments, an appointment is updated around every second.</p>
<p>Initially my approach was to go with the subscription&amp;rest-hook pattern with a pooling done by the subscrieber.<br>
The frequency of patients arrivals is assumed to be low enough for this pattern to make sense, it could also make sense to narrow the criteria into specific organizations/locations.</p>
<p>However I can see some issues with this:<br>
1) One would naively think that you should use the criteria: "&amp;status=arrived".<br>
But the subscrieber is probably looking for something like "&amp;previousStatus!=arrived&amp;status=arrived" (where previousStatus is a homemade representation for "the status of the previous version of this appointment")<br>
2) using the pooling pattern will possible hide updates for you<br>
Eg. if the appointment has already changed to status=fulfilled when the pooling-search "&amp;status=arrived&amp;_lastUpdated=gt&lt;lastQueryTime&gt;" is done by the subscrieber</p>
<p>Issue 1) could be handled by introducing a criteria like "&amp;patientDidArrive=true" to cover "&amp;previousStatus!=arrived&amp;status=arrived" (I haven't seen any standard for querying with criteria on previous version of a resource)</p>
<p>In fact we could (and probaly also will) introduce an patientArrived (Date) extension which could solve problem 2. But then we go against the description at FHIR and assume that that the subscrieber will do a different search than the subscription criteria, because the pooling will be:<br>
"&amp;patientArrived:missing=false&amp;_lastUpdated=gt&lt;lastQueryTime&gt;"  (I assume that that the _since parameter is a typo at FHIR)<br>
This will remove the possibility of loosing updates but will widening the search results to changes at appointments for already arrived patients.</p>
<p>Alternative the subscrieber should use a different criteria narrowing down "the appoitments of my interest" and just subscriebe to &amp;patientArrived:missing).<br>
Or maybe I should look for a different mechanism altogether.</p>
<p>Any thoughts on this?</p>



<a name="153914033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914033">(Oct 16 2017 at 09:14)</a>:</h4>
<p>you should look at the last connectathon stream on subscriptions:</p>



<a name="153914034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914034">(Oct 16 2017 at 09:14)</a>:</h4>
<p><a href="http://wiki.hl7.org/index.php?title=201709_FHIR_Subscriptions" target="_blank" title="http://wiki.hl7.org/index.php?title=201709_FHIR_Subscriptions">http://wiki.hl7.org/index.php?title=201709_FHIR_Subscriptions</a></p>



<a name="153914035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914035">(Oct 16 2017 at 09:14)</a>:</h4>
<p>and see here:</p>



<a name="153914036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914036">(Oct 16 2017 at 09:15)</a>:</h4>
<p><a href="https://chat.fhir.org/#narrow/stream/subscriptions" target="_blank" title="https://chat.fhir.org/#narrow/stream/subscriptions">https://chat.fhir.org/#narrow/stream/subscriptions</a></p>



<a name="153914038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914038">(Oct 16 2017 at 09:26)</a>:</h4>
<p>Thanks- I'll have a look and maybe repost the question in the core "subscriptions"-stream</p>



<a name="153914064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914064">(Oct 16 2017 at 10:46)</a>:</h4>
<p>My conclusion after reading at the main-subscriptions stream (if others are reading along): <br>
1) The connectathon introduces a extension "topics" with a reference to an eventDefinition.<br>
For my scenario this would be something like:<br>
{<br>
"criteria": "Appointment", -- could include filtering of appointments - if subscrieber only wants to hear of specific appointments<br>
"extension": {[<br>
    "url": "<a href="http://hl7.org/fhir/subscription/topics" target="_blank" title="http://hl7.org/fhir/subscription/topics">http://hl7.org/fhir/subscription/topics</a>",<br>
    "valueReference": {<br>
    "reference": "<a href="https://example.com/EventDefinition/123" target="_blank" title="https://example.com/EventDefinition/123">https://example.com/EventDefinition/123</a>",<br>
    "display": "Patient with appointment arrived",<br>
}<br>
]</p>
<p>2) the connectathon mainly addresses pushing the updated resource(s), no pooling mechanism.</p>



<a name="153914065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914065">(Oct 16 2017 at 10:54)</a>:</h4>
<p>we didn't focus on polling, no. The subscription stream addressed event based subscriptions rather than than search based subscriptions - so you can do before and after comparison</p>



<a name="153914083"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914083" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914083">(Oct 16 2017 at 11:13)</a>:</h4>
<p>I just mentioned polling as an alternative to using Subscriptions, since not every FHIR server will implement Subscriptions.</p>



<a name="153914087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914087">(Oct 16 2017 at 11:17)</a>:</h4>
<p>It is not polling as an alternative to Subscriptions, it is rather Subscription with polling (as opposed to Subscription with pushing (adding a payload))</p>



<a name="153914091"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914091" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914091">(Oct 16 2017 at 11:22)</a>:</h4>
<p>subscription with polling?</p>



<a name="153914093"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914093" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914093">(Oct 16 2017 at 11:24)</a>:</h4>
<p>yes, a rest-hook subscription with a notification with no payload, and a subsequent polling of data by the subscriber.</p>



<a name="153914094"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914094" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914094">(Oct 16 2017 at 11:25)</a>:</h4>
<p>oh - so that's just how it works</p>



<a name="153914095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914095">(Oct 16 2017 at 11:26)</a>:</h4>
<p>To avoid confusion I would say 'subsequent GETting the data by the subscriber', since 'polling' is often understood as 'periodically querying the server to see whether there is any data of interest'.</p>



<a name="153914096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Allan Bro Hansen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914096">(Oct 16 2017 at 11:32)</a>:</h4>
<p>I agree but still I think polling is the correct term: With the POST of the no-payload-Subscription, the subscriber just knows that there is a big chance of getting data of interest. <br>
Anyways: sorry for the confusion :-)</p>



<a name="153914168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153914168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Abbie Watson <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153914168">(Oct 16 2017 at 20:15)</a>:</h4>
<blockquote>
<p>What does polling a REST service has to do with subscriptions?<br>
With polling you are guaranteed to become stale right after you as a client has polled. So the sentence makes little sense</p>
</blockquote>
<p>Correct.  There are pull based subscriptions (GET polling), and there are push based subscriptions (database hooks/triggers).   Much of the FHIR spec is designed around REST based architectures, so most people think of GET polling by default.  But messaging and other architectures are supported; and the Meteor community has been using push-based FHIR subscriptions over websockets for nearly 2 years now; with at least a half-dozen production implementations.</p>



<a name="153916161"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916161" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916161">(Oct 25 2017 at 22:35)</a>:</h4>
<p>The current spec of subscription needs some TLC and I agree with <span class="user-mention" data-user-id="192120">@Allan Bro Hansen</span> . IMHO, the scheme defined with an empty body sent from the server to which a client subscribes more sounds like a notification to me - as in: you as a client is notified about that stuff has changed. It then forces the client to poll for the information - AND - in the mean time the state COULD have changed. This design can however be justified by means of security</p>



<a name="153916163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916163">(Oct 25 2017 at 22:37)</a>:</h4>
<p><span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> I agree - polling is polling, IMHO. Polling by design is not determined by time - it is determined by initiative.</p>



<a name="153916165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916165">(Oct 25 2017 at 22:41)</a>:</h4>
<p>And also - once a subscription is created, the server ought to send all the data matching the criteria. Otherwise, events can be lost in the timespan as stated currently where the client 1) is encouraged to do the search 2) submit the subscription</p>



<a name="153916166"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916166" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916166">(Oct 25 2017 at 22:41)</a>:</h4>
<p>between step 1 and 2 all kinds of stuff can happen</p>



<a name="153916167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916167">(Oct 25 2017 at 22:49)</a>:</h4>
<p>Also, why is the following <strong>mandatory behaviour</strong>: "<em>The consequence of this is that there is no notification when a resource is deleted, or when a resource is updated so that it no longer meets the criteria</em>.". I would say it undermines the idea of an event based channel of data if only a selected part of the updates are sent. I could understand if such limitation was scoped by a given vendor by eg. being able to state this in the subscription resource,  but I do not understand why such limitation is the baseline</p>



<a name="153916172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916172">(Oct 25 2017 at 23:00)</a>:</h4>
<p>A scenario would be the following: I as a client have an idea of the current state. I would now like to get notified if that idea of the current state changes - be that additions, updates or deletes. Omitting a notification of either one of those means that no matter how many events I'll ever receive, my idea of the state will never be complete and it will be (I guess) impossible to say how the state is not correct - without doing additional work</p>



<a name="153916184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916184">(Oct 25 2017 at 23:41)</a>:</h4>
<p>That is why there is a discussion of event based vs search based criteria. Is currently defined as a search based criteria.  I think that would make the delete be discoverable</p>



<a name="153916231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153916231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153916231">(Oct 26 2017 at 06:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> - the case where a resource changes so that it no longer matches a given criteria is just as important</p>



<a name="153917909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153917909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153917909">(Nov 07 2017 at 06:53)</a>:</h4>
<p>I know why it is very hard to implement reporting deletes, but I agree that it should not be prohibited to do so.</p>



<a name="153918959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153918959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153918959">(Nov 11 2017 at 00:22)</a>:</h4>
<p>In the case where the item no longer matches the criteria, what would you expect to be reported?<br>
If you receive the resource do you assume that the server knew that it _was_ in the scope previously, or now is, or is the server to fake a delete?</p>



<a name="153919226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153919226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153919226">(Nov 13 2017 at 13:04)</a>:</h4>
<p>Lets talk about it in amsterdam ;)</p>



<a name="153919752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153919752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Marks <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153919752">(Nov 15 2017 at 15:17)</a>:</h4>
<p>link to Nikko's subscriptions issue: <a href="https://gist.github.com/jkiddo/e773d033c245c2c4fdef6d35cbe1a75b" target="_blank" title="https://gist.github.com/jkiddo/e773d033c245c2c4fdef6d35cbe1a75b">https://gist.github.com/jkiddo/e773d033c245c2c4fdef6d35cbe1a75b</a></p>



<a name="153968527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968527">(Jun 11 2018 at 20:29)</a>:</h4>
<p>Subscription.reason ... why's that mandatory ... wouldn't the reason of the subscription be kind of obvious given its criteria? It seems a bit weird ...</p>



<a name="153968529"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968529" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968529">(Jun 11 2018 at 20:32)</a>:</h4>
<p>and would eg. GET [base]/?_type=Observation,Patient…[and so on]&amp;_lastUpdated=gt2018-10-01 as Subscription.criteria effectively be a way of specifying that all resources must be sent [except when deleting]</p>



<a name="153968577"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968577" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968577">(Jun 11 2018 at 23:15)</a>:</h4>
<p>reason... a human can provide additional context... 'this subscription is for the clinician ward round app' - says things that are useful that the technical query does not</p>



<a name="153968578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968578">(Jun 11 2018 at 23:15)</a>:</h4>
<p>and yes</p>



<a name="153968778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jens Villadsen <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968778">(Jun 12 2018 at 21:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> </p>
<blockquote>
<p>reason... a human can provide additional context... 'this subscription is for the clinician ward round app' - says things that are useful that the technical query does not</p>
</blockquote>
<p>actually not ... with the current modelling a human/bot/whatever SHALL provide additional context - that is what I don't get. Why is that modelled as 1..1? Why this hard requirement? Why would one mandate a field where the content is mainly a narrative/unstructured data?</p>



<a name="153968788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968788">(Jun 12 2018 at 22:55)</a>:</h4>
<p>pretty much the reason for that is that any resource design, we make as much as we can 1..1 to find out whether that's supportable. It's very hard to ever go the other way. In this case, is is it a problem to have some reason?</p>



<a name="153968790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968790">(Jun 12 2018 at 22:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span>, Umm, that's not the normal design rule.  The normal design rule is make things minOccurs=0 unless:<br>
a) you believe they're essential to be able to use the resource instance for pretty much every conceivable use-case<br>
b) you believe almost all implementation should be able to populate the element all the time</p>



<a name="153968796"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968796" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968796">(Jun 12 2018 at 23:02)</a>:</h4>
<p>well, ok, within the framework of (b), if you think they should, it's better to try for 1.1 at the start than to try to elevate to that later</p>



<a name="153968797"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153968797" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153968797">(Jun 12 2018 at 23:03)</a>:</h4>
<p>Sure.  But it's hard to make a case for (a) here...</p>



<a name="153971722"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/153971722" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sanjay Karmakar <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#153971722">(Jun 26 2018 at 06:06)</a>:</h4>
<p>I am being able to create the subscription using Vonk server, rest-hook, through proper channel endpoint but the notifications are not being seen.</p>



<a name="197653719"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/197653719" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> A K Azad <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#197653719">(May 15 2020 at 06:59)</a>:</h4>
<p>How do you match the search criteria/pattern against a resource in memory? I can see two options: </p>
<ol>
<li><code>FhirPathEngine</code>: but I need to evaluate each criterion, and multiplied by all Fhir Versions, it is very cumbersome</li>
<li><code>IGenericClient + InMemoryResourceMatcher</code>: but it needs a Fhir Server with SearchParameter capability. I do not have such a server.</li>
</ol>
<p>Has anyone efficiently tried matching a resource against a search pattern using the HAPI FHIR library?</p>



<a name="213805700"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/213805700" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> OS <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#213805700">(Oct 19 2020 at 15:47)</a>:</h4>
<p>I'm building a system for taking FHIR data and mastering (MDM) certain elements, and pushing certain elements to a data lake. The data we get (mostly practitioner/practitionerRole resources) can come in massive batches at times (1000s of resource entries). If that happens, and if we have a SubscriptionTopic and Subscription set up with a rest hook, how will that data be pushed. I know during the querying process, bundles are limited to 200 resource 'pages'. Will the subscription post multiple bundles in that case of 200 resources? Or Would it post a larger bundle? Or would it fail? Any guidance here would be super helpful. Thank you so much.</p>



<a name="213805840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/213805840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#213805840">(Oct 19 2020 at 15:48)</a>:</h4>
<p>You might want to raise this on <a class="stream" data-stream-id="179229" href="/#narrow/stream/179229-subscriptions">#subscriptions</a></p>



<a name="234189194"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/234189194" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martin Hoffmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#234189194">(Apr 12 2021 at 16:28)</a>:</h4>
<p>Hello everyone, I would like to ask if there are already solutions for FHIR R4 that can be used as an alternative to subscriptions to notify applications as soon as certain resources are deleted.<br>
If it's possible, the method should not be polling-based.<br>
If I am properly informed, the SubscriptionTopic resource from Version 4.5.0: R5 Draft should allow the notification by deletion.<br>
Still, I'm looking for a solution for R4.</p>



<a name="234192830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/234192830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> ryan moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#234192830">(Apr 12 2021 at 16:52)</a>:</h4>
<p>if the r5 subscription changes work for you there is an IG to backport them into R4: <a href="https://build.fhir.org/ig/HL7/fhir-subscription-backport-ig/">https://build.fhir.org/ig/HL7/fhir-subscription-backport-ig/</a></p>



<a name="234198314"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/234198314" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Martin Hoffmann <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#234198314">(Apr 12 2021 at 17:28)</a>:</h4>
<p>My current framework does not yet have the option to use the functionality of R5.<br>
I am rather looking for a short-term possibility to implement a deletion notification in R4.</p>



<a name="234276402"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/subscriptions/near/234276402" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/subscriptions.html#234276402">(Apr 13 2021 at 06:48)</a>:</h4>
<p>The backport is your best option, the backport = R4. You will need to configure your server somehow to detect deletes. If you can't do that, then you'll have to use a client side solution based on history and/or polling.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
