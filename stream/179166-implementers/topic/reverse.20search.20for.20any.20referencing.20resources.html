---
layout: page
title: "FHIR Chat  · reverse search for any referencing resources · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html">reverse search for any referencing resources</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="177204273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177204273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177204273">(Oct 03 2019 at 00:05)</a>:</h4>
<p>If I have resource A and B that references resource C, is there a way to search for <em>any</em> resources that reference resource C. In other words, if I only know of resource C and want to find anything that references it, is that possible?</p>



<a name="177208119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177208119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177208119">(Oct 03 2019 at 01:39)</a>:</h4>
<p>I don't think so.  Both _revinclude and _has require specifying the specific target class and relationship.</p>



<a name="177208311"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177208311" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177208311">(Oct 03 2019 at 01:44)</a>:</h4>
<p>That was my conclusion as well, <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> ... I ended up submitting a tracker (24888) for this.</p>



<a name="177208381"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177208381" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177208381">(Oct 03 2019 at 01:47)</a>:</h4>
<p>It's a really expensive search to run - you'd need to hit every resource and every element that could have extensions that could possibly point to the resource.  What's the use-case?</p>



<a name="177213710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177213710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177213710">(Oct 03 2019 at 04:16)</a>:</h4>
<p>If you were to supply a GraphDefinition as the intended response structure, it could be defined (well, not right now, but its within its scope) to be a "any resource with a reference to C" graph. That won't make the query less expensive, but it just goes to show we could already support the use case (once we finalise the GraphDefintion resource, and if/when implemented by servers :-) )</p>



<a name="177213997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177213997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177213997">(Oct 03 2019 at 04:25)</a>:</h4>
<p>Wow.  Didn't realize that 'path' was optional in 'link'.  That's pretty scary given that you'd then have to check all extensions within the source resource as well as all elements that have outbound relationships.</p>



<a name="177249745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177249745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177249745">(Oct 03 2019 at 14:28)</a>:</h4>
<p>To support that, I would think you would want to create an index of references. When a resource is POST/PUT to a server, extensions would be traversed and any references extracted.</p>



<a name="177249785"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177249785" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177249785">(Oct 03 2019 at 14:29)</a>:</h4>
<p>But really, I'm less concerned about extensions than I am about the core spec's References.</p>



<a name="177249851"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177249851" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177249851">(Oct 03 2019 at 14:29)</a>:</h4>
<p>The challenge is that most people will care about "the relationships I care about" - which will likely be a subset of both core elements and extensions</p>



<a name="177250213"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177250213" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177250213">(Oct 03 2019 at 14:33)</a>:</h4>
<p>I think the main benefit of something like this is to ensure referential integrity.</p>



<a name="177250225"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177250225" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177250225">(Oct 03 2019 at 14:33)</a>:</h4>
<p>for example, HAPI enforces referential integrity by default</p>



<a name="177250285"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177250285" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177250285">(Oct 03 2019 at 14:34)</a>:</h4>
<p>so, if I wanted to delete a resources that is referenced by other things, right now I have no way of determining what resources reference it</p>



<a name="177250299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177250299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177250299">(Oct 03 2019 at 14:34)</a>:</h4>
<p>short of a TON of queries</p>



<a name="177250358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177250358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177250358">(Oct 03 2019 at 14:35)</a>:</h4>
<p>it is less likely that a system will enforce referential integrity on references in extensions. if it does, then it likely processes references in extensions like I mentioned above (via an index)</p>



<a name="177258928"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177258928" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177258928">(Oct 03 2019 at 16:02)</a>:</h4>
<p>Enforcing referential integrity sounds like something that should be handled at the persistence layer rather than as a query capability?</p>



<a name="177260014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177260014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177260014">(Oct 03 2019 at 16:13)</a>:</h4>
<p>In HAPI, for example, referential integrity IS enforced at the persistence layer. So, you can't delete a resource that is referenced by something else. But, how do you find out what that "something else" is?? you can't...</p>



<a name="177260808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177260808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177260808">(Oct 03 2019 at 16:21)</a>:</h4>
<p>you could always write a custom interceptor on the <code>STORAGE_PRESTORAGE_DELETE_CONFLICTS</code> hook.. it gets called when a conflict is about to prevent deletion in order to allow you to resolve it</p>



<a name="177261841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177261841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177261841">(Oct 03 2019 at 16:33)</a>:</h4>
<p>we actually <em>like</em> the way referential integrity is enforced right now... we wouldn't want to change that</p>



<a name="177261870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177261870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177261870">(Oct 03 2019 at 16:33)</a>:</h4>
<p>but to an end-user trying to delete a resource, they need a way of knowing what is referencing it, that may be affected by the change</p>



<a name="177261921"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177261921" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177261921">(Oct 03 2019 at 16:34)</a>:</h4>
<p>but right now there is no way to know that</p>



<a name="177262525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177262525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177262525">(Oct 03 2019 at 16:41)</a>:</h4>
<p>GCP does handle this in the persistence layer and not in the search index...sort of. Not all references are the subject of search parameters; the ones that are do appear in the search index so there are tricks that can be used to find them. It turns out that "?_content=Patient/123" on the base URL works, but that's not guaranteed by the spec. I don't think the search index is the right place to solve this problem.</p>
<p>Even if we give you a nice error message "can't delete Patient/123 because it's referred to by Observation/456, Observation/789, ..." (and we currently don't) this is not parseable in an interoperable way, and there could be an unbounded number of references.</p>
<p>For the specific case of any resource that has a compartment definition, retrieving the compartment might help.</p>
<p>Define a new operation? It would be relatively easy for us to page through the references from storage and return them.</p>



<a name="177262678"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177262678" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177262678">(Oct 03 2019 at 16:42)</a>:</h4>
<p>If the error response from the delete request included a computable list of references that are stopping the delete, that would solve the problem for me...</p>



<a name="177262777"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177262777" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177262777">(Oct 03 2019 at 16:43)</a>:</h4>
<p>for example, perhaps an OperationOutcome with a specific code, and multiple OperationOutcome.issue.expression entries for each of the referenced resources</p>



<a name="177263140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177263140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177263140">(Oct 03 2019 at 16:47)</a>:</h4>
<p>I think the biggest risk there is that there are too many of them and you can't paginate an OperationOutcome response.</p>



<a name="177265204"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177265204" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177265204">(Oct 03 2019 at 17:09)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> does HAPI enforce referential integrity on references that are in extensions?</p>



<a name="177266146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177266146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177266146">(Oct 03 2019 at 17:19)</a>:</h4>
<p><span class="user-mention" data-user-id="197072">@Paul Church</span> We do, but only if there is a search parameter on that extension, and the server is configured to enforce referential integrity.</p>



<a name="177267484"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177267484" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177267484">(Oct 03 2019 at 17:34)</a>:</h4>
<p>...and Sean, you could definitely implement that logic (the OO resource containing the conflicts) using an interceptor on the hook I mentioned. Honestly that sounds pretty useful to me.</p>
<p>There is a catch though: If you can't delete Patient/1 because Observation/2 links to Patient/1, you'd get that in the response.. but there is no guarantee you would be able to delete Observation/2, since DiagnosticReport/3 might link to it.</p>



<a name="177268115"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177268115" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177268115">(Oct 03 2019 at 17:40)</a>:</h4>
<p>No, but you could delete just the reference inside Observation/2, effectively leaving it blank...</p>



<a name="177268171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177268171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177268171">(Oct 03 2019 at 17:41)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span> is that logic you mentioned something you would want in core hapi-fhir, or as part of hapi-fhir-jpaserver-starter</p>



<a name="177268216"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177268216" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177268216">(Oct 03 2019 at 17:41)</a>:</h4>
<p>if in core hapi-fhir, I would think you would want that logic built into framework, not implemented via hooks... could be wrong though</p>



<a name="177270781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177270781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177270781">(Oct 03 2019 at 18:09)</a>:</h4>
<p>I think it would make sense in core hapi fhir... but as a hook. These days our philosophy is increasingly that if something can be done with interceptors, that's how we do it. It enforces a nice separation of concerns, and means it's really easy to turn on and off features (you'll notice that a lot of the new flags being added to jpaserver-started actually just toggle interceptors actually).</p>



<a name="177279144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177279144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177279144">(Oct 03 2019 at 19:38)</a>:</h4>
<p>no idea if/when I will be able to get to this...</p>



<a name="177279165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177279165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sean McIlvenna <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177279165">(Oct 03 2019 at 19:38)</a>:</h4>
<p>but if I ever do, that's the approach I'll try</p>



<a name="177309929"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/177309929" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#177309929">(Oct 04 2019 at 04:35)</a>:</h4>
<p>You could craft a search parameter that does this (which I noted when considering how to locate all the resources for processing a patient merge).<br>
Only way around it is to scan everything in the way in and tag a special search parameter <code>patient-for-merge</code><br>
search expression: <code>descendants.ofType(ResourceReference).resolve().ofType(Patient)</code><br>
I know probably wrong and expensive but that gives the idea.<br>
And maybe use it on the system level search?</p>



<a name="219136548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219136548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219136548">(Dec 07 2020 at 20:51)</a>:</h4>
<p>There's a proposal to support _include and _revinclude syntaxes that allow "*" as a relationship type.  Questions to consider:</p>
<ul>
<li>would this only match on the specific search criteria the system supports, or would it handle all references, even if they aren't supported as independent search criteria?  (The latter is necessary to safely use this for referential integrity purposes)</li>
<li>what are the performance ramifications of supporting this?</li>
<li>If we introduce this, would the syntax allow constraining what resource types relationships are considered for?</li>
<li>if we don't do this in search, should we support a custom operation instead?</li>
</ul>



<a name="219136677"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219136677" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219136677">(Dec 07 2020 at 20:52)</a>:</h4>
<p>It may be we don't actually want a search set, but rather just the resource ids that have references.</p>



<a name="219136737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219136737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bas van den Heuvel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219136737">(Dec 07 2020 at 20:53)</a>:</h4>
<p>We encountered this issue also in FHIRcast were we want to find all resources that relate to an "Anchor" - all referred and and all referred from. Having this as a search criteria would be great as we can use R5 subscriptions for it.</p>



<a name="219137036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219137036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219137036">(Dec 07 2020 at 20:55)</a>:</h4>
<p>That gets at the idea of subscribing to changes to a patient, but more generally. I believe this is an area where search-based subscription definitions becomes quite awkward, but is the only tool we currently have.</p>



<a name="219138157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219138157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219138157">(Dec 07 2020 at 21:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="197072">Paul Church</span> <a href="#narrow/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources/near/219137036">said</a>:</p>
<blockquote>
<p>That gets at the idea of subscribing to changes to a patient, but more generally. I believe this is an area where search-based subscription definitions becomes quite awkward, but is the only tool we currently have.</p>
</blockquote>
<p>The R4 backport of topic-based subscriptions is up for ballot in January, so it will hopefully be available <code>Soon(tm)</code></p>



<a name="219193045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/219193045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#219193045">(Dec 08 2020 at 10:50)</a>:</h4>
<p>I can't really judge the usefulness of it, but implementing it is quite doable for Vonk. <br>
For _include, both options are feasible (all reference searchparameters or all reference elements), but for efficient evaluation of _revInclude it would have to be on searchparameters only. <br>
Having a type modifier seems useful to me, e.g. for Observation that can have many basedOn or partOf references, most of which may not be of interest to the search at hand.<br>
But I do expect problems with :iterate.</p>



<a name="221575005"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/221575005" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#221575005">(Jan 04 2021 at 20:17)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191319">@James Agnew</span> - thoughts on this?</p>



<a name="221620218"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/221620218" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#221620218">(Jan 05 2021 at 07:47)</a>:</h4>
<p>Mind you, we already have wildcards for 'reference-type search parameters', to _(rev)include=Encounter:* - this isn't actually supported on (the public version of) HAPI, Vonk, <a href="http://test.fhir.org">test.fhir.org</a> last I tested.</p>



<a name="224235001"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224235001" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224235001">(Jan 27 2021 at 19:28)</a>:</h4>
<p>Question for <span class="user-mention" data-user-id="191319">@James Agnew</span> <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> Are we in favor of adding support for _revInclude=*</p>



<a name="224237578"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224237578" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224237578">(Jan 27 2021 at 19:48)</a>:</h4>
<p>HAPI already supports <code>_revInclude=*</code>, at the time it was implemented I don't think we knew it wasn't in the spec :)</p>



<a name="224237760"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224237760" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224237760">(Jan 27 2021 at 19:49)</a>:</h4>
<p><code>_revinclude=*</code> has been in the spec for a while, I thought this was about being able to revinclude on incoming references that aren't the subject of any search parameter?</p>



<a name="224240168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224240168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224240168">(Jan 27 2021 at 20:08)</a>:</h4>
<p>As far as I can tell, it's not specified.  The <a href="https://www.hl7.org/fhir/search.html#revinclude">section in search</a> says that you can use an <code>*</code> in place of the search parameter name.  It does not indicate anything about the resource name, or being able to override the <code>&lt;resource&gt;:&lt;search param&gt;</code> format with a single <code>*</code>.</p>
<p>(btw, I am for the change - just stating why I think a change is necessary)</p>



<a name="224246360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224246360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> James Agnew <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224246360">(Jan 27 2021 at 20:59)</a>:</h4>
<p>Ah, didn't realize this was about supporting if for non-searchparameter revincludes.</p>
<p>I'm indifferent to that idea. It wouldn't be hard to implement, but it'd certainly have an impact on indexing speed so I'd probably want it to be configurable at the server level. Do0able though, if there was a good use case.</p>



<a name="224248737"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224248737" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224248737">(Jan 27 2021 at 21:17)</a>:</h4>
<p>I'm pretty sure that's part of the question.  <a href="http://jira.hl7.org/browse/FHIR-24888">FHIR#24888</a> is asking for a way to search for all references to a resource.  Since the behavior of <code>_include=*</code> and <code>_revInclude=*</code> isn't defined, does/should it:</p>
<ul>
<li>Match every resource with a search parameter of the correct linkage.</li>
<li>Match every resource with a link.</li>
</ul>
<p>If it's agreed on the latter, then that fills the need of the request (with additional docs, etc.).  Otherwise... an operation? another parameter?</p>



<a name="224257267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224257267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224257267">(Jan 27 2021 at 22:23)</a>:</h4>
<p>I have always been in favour of an operation for this, Resource/$references-to. I don't think something that explicitly isn't limited to search parameters is a good fit for search.</p>



<a name="224298369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224298369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224298369">(Jan 28 2021 at 08:51)</a>:</h4>
<p>If _include=* were to mean "it's up to the server to include as may as possible (without any guarantees of completeness) resources that have a reference to the focal resource" then I'd be in favor of such a suggestion. Note that even $everything doesn't guarantee you get 'everything'.  If you want a guaranteed 100% set of resources - which is harder to implement, it sounds like an operation to me, which a server may or may not wish to support.  Note that we already have a wildcard on the searching of compartments, adoption of which is low AFAIK.</p>



<a name="224300884"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/reverse%20search%20for%20any%20referencing%20resources/near/224300884" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/reverse.20search.20for.20any.20referencing.20resources.html#224300884">(Jan 28 2021 at 09:16)</a>:</h4>
<p>Reading <a href="https://www.pewtrusts.org/en/research-and-analysis/reports/2021/01/standard-technology-presents-opportunities-for-medical-record-data-extraction">https://www.pewtrusts.org/en/research-and-analysis/reports/2021/01/standard-technology-presents-opportunities-for-medical-record-data-extraction</a> I see lots of / some of US EHR/EMR vendors are going to charge "per API call", which means clients will try and minimize API calls, which in FHIR terms means they'll try and squeeze as much data out of a server in one API call as they can, a) thus subverting the nature of REST [multiple more atomic exchanges when one really needs the data], and b) probably leading to a client duplicating the data on their own system rather than requesting a new fresh copy of that data each and every time they need it. (b) has patient safety issues associated with it, one would be working with potentially outdated data.</p>
<p>Whilst I understand that some would like to use a fee per call  scheme (reminds me of the fee per message scheme in the 1990s) - such a choice has negative repercussions. IMHO It would be best if US regulators were to move away from this specific payment scheme.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
