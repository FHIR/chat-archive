---
layout: page
title: "FHIR Chat  · R4 AuditEvent.agent · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html">R4 AuditEvent.agent</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="168141474"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168141474" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168141474">(Jun 14 2019 at 14:49)</a>:</h4>
<p>Our audit log contains the id of the user that performed the logged action (pretty standard I guess). Mapping it to AuditEvent in DSTU2  / STU3 we used AuditEvent.agent.userId. In R4 that's gone - the best match is AuditEvent.agent.who, but our users are not necessarily Practitioner or Patient - we actually map them to FHIR Person - and that's not an allowed target type for who - so not sure what to do</p>



<a name="168141621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168141621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168141621">(Jun 14 2019 at 14:50)</a>:</h4>
<p>use AuditEvent.agent.who.identifier - just record the user id as the identifier.</p>



<a name="168141807"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168141807" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168141807">(Jun 14 2019 at 14:53)</a>:</h4>
<p>I see - and add the id a an identifier to our Person resource I guess?</p>



<a name="168142319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168142319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168142319">(Jun 14 2019 at 14:59)</a>:</h4>
<p>The is no need to add the id to the Person resource, but you might want to do that for other reasons. Cross-referencing business identifiers into the various agent Resources is always useful for Provisioning and Identity proofing.</p>



<a name="168142421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168142421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168142421">(Jun 14 2019 at 15:00)</a>:</h4>
<p>There is no expectation that using a Reference.Identifier will result in a positive lookup; only that it is technically possible for that business identifier could be found as one of the Reference types.</p>



<a name="168142918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168142918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168142918">(Jun 14 2019 at 15:06)</a>:</h4>
<p>(scratch that - adding the identifier to Person would not give us anything: the client would not know which resource to look for, and in any case won't look at Person because it is not one of the possible references there)</p>



<a name="168145306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168145306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168145306">(Jun 14 2019 at 15:32)</a>:</h4>
<p>Oh - and the <code>user</code> search parameter is gone</p>



<a name="168146752"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168146752" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168146752">(Jun 14 2019 at 15:47)</a>:</h4>
<p>yup, just ?agent now</p>



<a name="168146846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168146846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168146846">(Jun 14 2019 at 15:48)</a>:</h4>
<p>These changes are all driven by the FHIR methodology move to Reference inclusive of Reference.identifier.</p>



<a name="168146899"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168146899" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168146899">(Jun 14 2019 at 15:49)</a>:</h4>
<p>yes - but that's a reference search parameter and what we have is an id, so it will take some hacks to make it work</p>



<a name="168147049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168147049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168147049">(Jun 14 2019 at 15:51)</a>:</h4>
<p>nope, very easy -- <a href="http://build.fhir.org/search.html#reference" target="_blank" title="http://build.fhir.org/search.html#reference">http://build.fhir.org/search.html#reference</a></p>



<a name="168147252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168147252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168147252">(Jun 14 2019 at 15:52)</a>:</h4>
<p>The specs might be easy, the implementation is not: all our reference search parameters expect actual references to existing resources, and this will break that pattern and so require special code</p>



<a name="168173613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168173613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168173613">(Jun 14 2019 at 21:36)</a>:</h4>
<p>pattern might happen elsewhere too</p>



<a name="168176820"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168176820" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168176820">(Jun 14 2019 at 22:31)</a>:</h4>
<p>yup, the main reason to use Reference.identifier is because the entity has not yet or may never be persisted as a formal FHIR Resource. If it has been, then Reference.reference is the better solution (aka the only one that should be used).</p>



<a name="168176915"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/R4%20AuditEvent.agent/near/168176915" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/R4.20AuditEvent.2Eagent.html#168176915">(Jun 14 2019 at 22:33)</a>:</h4>
<p>Main reason to populate Reference.identifier when there is an actual persisted formal FHIR Resource, is when you know the recipient of your data understands the business identifier and has no access rights to the FHIR Resource. This is possible, but unlikely, and especially unlikely that the sender knows that this is the case on the recipient.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
