---
layout: page
title: "FHIR Chat  · constraints questions · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraints.20questions.html">constraints questions</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154009175"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/constraints%20questions/near/154009175" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Sasa <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/constraints.20questions.html#154009175">(Oct 15 2018 at 16:50)</a>:</h4>
<p>I have some questions about constraints on Observations and the vitalSigns profile for Observations. Specifically I'm interested in the following constraints with respect to some resource (I'll add the resources down below.) I'd like to know if the constraints should pass or fail on the specific resource and why.</p>
<p>1.) If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource<br>
<code>dom-3: contained.where(('#'+id in %resource.descendants().reference).not()).empty()</code><br>
The resource follows</p>
<div class="codehilite"><pre><span></span>{
  &quot;resourceType&quot;: &quot;Bundle&quot;,
  &quot;type&quot;: &quot;collection&quot;,
  &quot;entry&quot;: [
    {
      &quot;resource&quot;: {
        &quot;resourceType&quot;: &quot;Claim&quot;,
        &quot;contained&quot;: [
          {
            &quot;resourceType&quot;: &quot;Bundle&quot;,
            &quot;type&quot;: &quot;collection&quot;,
            &quot;entry&quot;: [
              {
                &quot;resource&quot;: {
                  &quot;resourceType&quot;: &quot;Claim&quot;,
                  &quot;information&quot;: [
                    {
                      &quot;sequence&quot;: 1
                    }
                  ]
                }
              }
            ]
          }
        ],
        &quot;information&quot;: [
          {
            &quot;sequence&quot;: 1
          }
        ],
        &quot;invalid&quot;: &quot;cannot have extra fields&quot;
      }
    }
  ]
}
</pre></div>


<p>What is <code>%resource</code> in this example? What "should" the constraint evaluate to?</p>
<hr>
<p>1.) If code is the same as a component code then the value element associated with the code SHALL NOT be present <br>
<code> obs-7:  (value.empty() or code!=component.code)</code></p>
<p>2.) If there is no component or related element then either a value[x] or a data absent reason must be present<br>
<code>vs-2: (component.empty() and related.empty()) implies (dataAbsentReason or value)</code></p>
<p>The resource follows.</p>
<div class="codehilite"><pre><span></span>{

            &quot;resourceType&quot;: &quot;Observation&quot;,
            &quot;meta&quot;: {
                &quot;profile&quot;: [&quot;http://hl7.org/fhir/StructureDefinition/vitalsigns&quot;]
            },
            &quot;status&quot;: &quot;registered&quot;,
            &quot;code&quot;: {
                &quot;coding&quot;: [
                    {
                        &quot;system&quot;: &quot;http://loinc.org&quot;,
                        &quot;code&quot;: &quot;29463-7&quot;,
                        &quot;display&quot;: &quot;Body Weight&quot;
                    }
                ]
            },
            &quot;category&quot;: [
                {
                    &quot;coding&quot;: [
                        {
                            &quot;system&quot;: &quot;http://hl7.org/fhir/observation-category&quot;,
                            &quot;code&quot;: &quot;vital-signs&quot;
                        }
                    ]
                }
            ],
            &quot;subject&quot;: {
                &quot;reference&quot;: &quot;Patient/aPatientId&quot;
            },
            &quot;effectiveDateTime&quot;: &quot;2018-02-14T13:42:00+10:00&quot;,
            &quot;valueQuantity&quot;: {
                &quot;value&quot;: 60,
                &quot;unit&quot;: &quot;mmHg&quot;,
                &quot;system&quot;: &quot;http://unitsofmeasure.org&quot;,
                &quot;code&quot;: &quot;mm[Hg]&quot;
            }
    }
</pre></div>


<p>For the example above If you have  <code>(component.empty() and related.empty()) implies (dataAbsentReason or value)</code> then<br>
1.) component.empty() -&gt; true<br>
2.) related.empty() -&gt; true<br>
3.) left had side -&gt; true i.e. the right hand side will be what we return<br>
4.)  dataAbsentReason -&gt; {}<br>
5.) value -&gt; { valueQuantity:{..} }<br>
6.) {} or { valueQuantity:{..} } -&gt; Error</p>
<p>In this example the constraint will always error. it doesn't have a defined behavior when it is being or'd with a list with some actual values inside of it. How can this be remedied?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
