---
layout: page
title: "FHIR Chat  · Subsumption testing in Token search params · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html">Subsumption testing in Token search params</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153944034"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944034" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944034">(Mar 12 2018 at 23:51)</a>:</h4>
<p>Hi, I read the relevant info in the documentation, but still cannot understand the concept of Subsumption for implementation of the modifiers <code>:below</code> and <code>:above</code> on search parameters of type "Token". Could someone please help me with a more intuitive explanation?</p>



<a name="153944045"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944045" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944045">(Mar 13 2018 at 01:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> ?</p>



<a name="153944073"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944073" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944073">(Mar 13 2018 at 01:43)</a>:</h4>
<div class="codehilite"><pre><span></span>GET [base]/Condition?code=http://snomed.info/sct|126851005
</pre></div>



<a name="153944074"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944074" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944074">(Mar 13 2018 at 01:44)</a>:</h4>
<p>find all conditions that have the SCT code Neoplasm of liver</p>



<a name="153944075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944075">(Mar 13 2018 at 01:45)</a>:</h4>
<p>Here are a couple of examples that I've used in the FHIR terminology tutorial:</p>
<blockquote>
<p>Subsumption-based Modifiers<br>
Code in a resource subsumes the specified search code (e.g. is-a* relationship): <strong>below “Diabetes mellitus” (73211009)</strong><br>
<a href="http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009" target="_blank" title="http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009">http://fhirtest.uhn.ca/baseDstu3/Condition?code:below=http://snomed.info/sct|73211009</a><br>
Code in a resource is subsumed by the specified search code (e.g. is-a* relationship): <strong>above “Viral pneumonia” (75570004)</strong><br>
<a href="http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004" target="_blank" title="http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004">http://fhirtest.uhn.ca/baseDstu3/Condition?code:above=http://snomed.info/sct|75570004</a></p>
</blockquote>
<p>The :below search is returning Condition resources for "Type 2 diabetes mellitus" (44054006) (however, for some reason the HAPI server is returning some resource instances with incorrect 'display' values!), which is "below" “Diabetes mellitus” in the code system hierarchy.  The :above search is generally less useful, and in this case it's not returning any Condition resource instances, but it might be expected to return cases of "Pneumonia" if they existed on the server.</p>



<a name="153944076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944076">(Mar 13 2018 at 01:46)</a>:</h4>
<p>ah I'll let Rob answer this nicely</p>



<a name="153944081"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944081" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944081">(Mar 13 2018 at 01:47)</a>:</h4>
<p>I guess the markdown doesn't work correctly inside the quote block, but hopefully it's readable</p>



<a name="153944451"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944451" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944451">(Mar 13 2018 at 19:14)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191405">@Rob Hausam</span> , I understand the concept. But how do I –as an implementer– know that "Type 2 diabetes mellitus" (44054006) is "below" “Diabetes mellitus” (73211009)?</p>



<a name="153944457"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944457" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944457">(Mar 13 2018 at 19:34)</a>:</h4>
<p>Well, I guess there are a couple of basic answers.  Assuming that you trust the implementation of the FHIR terminology services, you will know that because the resources with those codes were returned by your :below search, because that's how it's supposed to work.  If within the FHIR context you still need to verify that for some reason you can ask the server to verify it using the CodeSystem $subsumes operation (although that should be unnecessary to do in addition to the :below search).  If you need to verify it outside of the FHIR terminology services context, you can do that manually in a variety of ways with different tools - possibly starting with the SNOMED CT browser at <a href="http://browser.ihtsdotools.org/" target="_blank" title="http://browser.ihtsdotools.org/">http://browser.ihtsdotools.org/</a>.  If you enter 44054006 in the search there you will see that it shows 73211009 as the immediate parent concept.  Sometimes you have to traverse multiple levels to see the descendant or ancestor relationship, but theoretically that is doable.</p>



<a name="153944608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Lawley <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944608">(Mar 14 2018 at 00:44)</a>:</h4>
<p><span class="user-mention" data-user-id="195133">@emilio</span> One option is that for every Condition in your server you add the associated code to a $closure table, and then also add the :below code (73211009) when the search happens.  Then your closure table will tell you directly all the things that are below "Diabetes mellitus” (73211009). Alternatively, you could expand a ValueSet with a filter of "concept is-a 73211009" and use the results to test against the codes in your Conditions.<br>
The best / most efficient approaches depend on how you store/index your data, what terminology service capabilities you have, and whether you need to also handle infinite CodeSystems/ValueSets and things like post coordination.</p>



<a name="153944890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> emilio <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944890">(Mar 14 2018 at 21:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191405">@Rob Hausam</span> Oh,  so, I, as the implementer of a FHIR server with search capabilities, but no terminology service, each time that I get a query with a <code>:below</code> modifier, will have to consult with a terminology service to know the parents of the code in the query?</p>



<a name="153944892"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153944892" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153944892">(Mar 14 2018 at 21:15)</a>:</h4>
<p>well, you have several choices:</p>
<ul>
<li>you can consult a terminology service each time you get the query</li>
<li>you can maintain a closure table internally using the closure table maintenance service from the terminology server interface (several open source implementations provide this). </li>
<li>you can not support the :below modifier</li>
</ul>



<a name="153945355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Subsumption%20testing%20in%20Token%20search%20params/near/153945355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Subsumption.20testing.20in.20Token.20search.20params.html#153945355">(Mar 16 2018 at 12:39)</a>:</h4>
<p>Another option is that you can build your own terminology service capabilities (whether exposed as a FHIR endpoint or accessed internally).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
