---
layout: page
title: "FHIR Chat  · Schematron validation fails for R4 resource · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Schematron.20validation.20fails.20for.20R4.20resource.html">Schematron validation fails for R4 resource</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173535364"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Schematron%20validation%20fails%20for%20R4%20resource/near/173535364" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mukesh Sharma <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Schematron.20validation.20fails.20for.20R4.20resource.html#173535364">(Aug 19 2019 at 11:12)</a>:</h4>
<p>I am using HAPI implementation for FHIR. When I apply Schematron validation on an R4 Patient resource, I get the following failure:<br>
Failed to apply Schematron bundleresource://367.fwk360062456:7/org/hl7/fhir/r4/model/schema/patient.sch onto XML source</p>
<p>Resource input:<br>
&lt;Patient xmlns="<a href="http://hl7.org/fhir" target="_blank" title="http://hl7.org/fhir">http://hl7.org/fhir</a>"&gt;<br>
&lt;identifier&gt;<br>
&lt;period&gt;<br>
&lt;start value="2003-05-06"/&gt;<br>
&lt;end value="2000-05-07"/&gt;<br>
&lt;/period&gt;<br>
&lt;/identifier&gt;<br>
&lt;/Patient&gt;<br>
Schematron is present and has a rule :<br>
&lt;sch:rule context=“f:Patient/f:identifier/f:period”&gt;<br>
&lt;sch:assert test=“not(exists(f:start/@value)) or not(exists(f:end/@value)) or (xs:dateTime(f:start/@value) &lt;= xs:dateTime(f:end/@value))”&gt;per-1: If present, start SHALL have a lower value than end&lt;/sch:assert&gt;<br>
&lt;/sch:rule&gt;</p>
<p>I am using a 3.7.0 version of HAPI libraries.<br>
This issue is faced only on R4.<br>
STU3 and DSTU2 version pass with a proper OperationOutcome object. See below:<br>
&lt;OperationOutcome&gt;<br>
&lt;issue&gt;<br>
&lt;severity value="error"/&gt;<br>
&lt;code value="processing"/&gt;<br>
&lt;diagnostics value="[error] in /*:Patient[namespace-uri()='<a href="http://hl7.org/fhir'][1]/*:identifier[namespace-uri()='http://hl7.org/fhir'][1]/*:period[namespace-uri()='http://hl7.org/fhir'][1]" target="_blank" title="http://hl7.org/fhir'][1]/*:identifier[namespace-uri()='http://hl7.org/fhir'][1]/*:period[namespace-uri()='http://hl7.org/fhir'][1]">http://hl7.org/fhir'][1]/*:identifier[namespace-uri()='http://hl7.org/fhir'][1]/*:period[namespace-uri()='http://hl7.org/fhir'][1]</a> @ Patient per-1: If present, start SHALL have a lower value than end Test=not(exists(f:start)) or not(exists(f:end)) or (f:start/@value &lt;= f:end/@value)"/&gt;<br>
&lt;location value="Patient"/&gt;<br>
&lt;/issue&gt;<br>
&lt;/OperationOutcome&gt;</p>
<p>Please help on this issue.</p>



<a name="173675167"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Schematron%20validation%20fails%20for%20R4%20resource/near/173675167" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Schematron.20validation.20fails.20for.20R4.20resource.html#173675167">(Aug 20 2019 at 16:58)</a>:</h4>
<p><span class="user-mention" data-user-id="191319">@James Agnew</span></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
