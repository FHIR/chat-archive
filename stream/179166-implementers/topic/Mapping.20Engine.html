---
layout: page
title: "FHIR Chat  · Mapping Engine · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html">Mapping Engine</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="159740114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159740114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> VP Herisse <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159740114">(Mar 01 2019 at 19:09)</a>:</h4>
<p>I'm looking to map resources from DSTU2 to STU3.<br>
Has anyone found a mapping engine that can take a FHIR map and execute this task?</p>



<a name="159740744"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159740744" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159740744">(Mar 01 2019 at 19:17)</a>:</h4>
<p><a href="http://hl7.org/fhir/STU3/r2maps.html" target="_blank" title="http://hl7.org/fhir/STU3/r2maps.html">http://hl7.org/fhir/STU3/r2maps.html</a></p>



<a name="159743754"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159743754" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159743754">(Mar 01 2019 at 19:56)</a>:</h4>
<p>The FHIR Java validator (<a href="http://hl7.org/fhir/validator" target="_blank" title="http://hl7.org/fhir/validator">http://hl7.org/fhir/validator</a>) includes a mapping engine.  If you run the validator with no parameters, it'll provide instructions.  (<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> are there instructions online anywhere?)</p>



<a name="159743969"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159743969" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> VP Herisse <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159743969">(Mar 01 2019 at 19:59)</a>:</h4>
<p>Okay I will investigate that engine, thank you!</p>



<a name="159751138"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159751138" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> VP Herisse <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159751138">(Mar 01 2019 at 21:34)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> ,</p>
<p>I tried running this:</p>
<p>java -jar org.hl7.fhir.validator.jar allergyintolerance-example.json -transform <a href="http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3" target="_blank" title="http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3">http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3</a> -ig hl7.fhir.transforms.v2v3 -output R3resource.json</p>
<p>and received this error:</p>
<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-09T15:30:00.249-05:00 - Git 53fa82582dda<br>
Arguments: allergyintolerance-example.json -transform <a href="http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3" target="_blank" title="http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3">http://hl7.org/fhir/StructureMap/AllergyIntolerance2to3</a> -ig hl7.fhir.transforms.v2v3 -output R3resource.json<br>
  .. connect to tx server @ <a href="http://tx.fhir.org" target="_blank" title="http://tx.fhir.org">http://tx.fhir.org</a><br>
  .. definitions from hl7.fhir.core#4.0.0<br>
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space<br>
        at java.util.HashMap.newNode(Unknown Source)<br>
        at java.util.HashMap.putVal(Unknown Source)<br>
        at java.util.HashMap.put(Unknown Source)<br>
        at java.util.HashSet.add(Unknown Source)<br>
        at org.hl7.fhir.utilities.xhtml.XhtmlParser.&lt;init&gt;(XhtmlParser.java:243)<br>
        at org.hl7.fhir.r4.formats.JsonParserBase.parseXhtml(JsonParserBase.java:210)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseNarrativeProperties(JsonParser.java:236)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseNarrative(JsonParser.java:225)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseDomainResourceProperties(JsonParser.java:1920)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinitionProperties(JsonParser.java:23484)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinition(JsonParser.java:23479)<br>
        at org.hl7.fhir.r4.formats.JsonParser.parseResource(JsonParser.java:27656)<br>
        at org.hl7.fhir.r4.formats.JsonParserBase.parse(JsonParserBase.java:113)<br>
        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadFromFileJson(SimpleWorkerContext.java:262)<br>
        at org.hl7.fhir.r4.context.SimpleWorkerContext.loadDefinitionItem(SimpleWorkerContext.java:211)<br>
        at org.hl7.fhir.r4.context.SimpleWorkerContext.fromDefinitions(SimpleWorkerContext.java:199)<br>
        at org.hl7.fhir.r4.validation.ValidationEngine.loadDefinitions(ValidationEngine.java:321)<br>
        at org.hl7.fhir.r4.validation.ValidationEngine.loadInitialDefinitions(ValidationEngine.java:283)<br>
        at org.hl7.fhir.r4.validation.ValidationEngine.&lt;init&gt;(ValidationEngine.java:308)<br>
        at org.hl7.fhir.r4.validation.Validator.main(Validator.java:367)</p>
<p>Any ideas? Maybe my syntax is off?</p>



<a name="159751314"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159751314" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159751314">(Mar 01 2019 at 21:36)</a>:</h4>
<p>Nope, that sounds like a memory issue.  First, make sure you're running the jar with a 64 bit version of Java.  (To do the transformations, the validator first loads all of the FHIR structures and quite a bit of the terminologies, so you typically need a good chunk of memory).  If that doesn't address the problem, you may need to increase the memory available to Java using one of the -Xm parameters</p>



<a name="159751519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/159751519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> VP Herisse <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#159751519">(Mar 01 2019 at 21:39)</a>:</h4>
<p>Ah Excellent! thank you Lloyd!</p>



<a name="160042822"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/160042822" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> VP Herisse <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#160042822">(Mar 05 2019 at 21:41)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> ,</p>
<p>I think I'm really close to having this work.</p>
<p><strong>I've got this for a command:</strong></p>
<p>java -jar org.hl7.fhir.validator.jar c:\temp\r3\patient.xml -version 3.0 -ig <a href="http://hl7.org/fhir/us/core" target="_blank" title="http://hl7.org/fhir/us/core">http://hl7.org/fhir/us/core</a> -output c:\temp\outputPatient.xml -transform <a href="http://hl7.org/fhir/StructureMap/Patient3to4" target="_blank" title="http://hl7.org/fhir/StructureMap/Patient3to4">http://hl7.org/fhir/StructureMap/Patient3to4</a></p>
<p><strong>Results:</strong></p>
<p>FHIR Validation tool Version 3.8.0-SNAPSHOT - Built 2019-02-11T12:49:16.829-05:00 - Git 7a8671008476<br>
Arguments: c:\temp\r3\patient.xml -version 3.0 -ig <a href="http://hl7.org/fhir/us/core" target="_blank" title="http://hl7.org/fhir/us/core">http://hl7.org/fhir/us/core</a> -output c:\temp\outputPatient.xml -transform <a href="http://hl7.org/fhir/StructureMap/Patient3to4" target="_blank" title="http://hl7.org/fhir/StructureMap/Patient3to4">http://hl7.org/fhir/StructureMap/Patient3to4</a><br>
  .. connect to tx server @ <a href="http://tx.fhir.org" target="_blank" title="http://tx.fhir.org">http://tx.fhir.org</a><br>
  .. definitions from hl7.fhir.core#3.0.1<br>
    (v3.0.1)<br>
+  .. load IG from <a href="http://hl7.org/fhir/us/core" target="_blank" title="http://hl7.org/fhir/us/core">http://hl7.org/fhir/us/core</a><br>
   ... Using version 1.1.0<br>
 ...Failure: null</p>
<p>Could it be failing because of this structure map url is returning a 404 not found?<br>
<strong>http://hl7.org/fhir/StructureMap/Patient3to4</strong></p>



<a name="160044517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/160044517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#160044517">(Mar 05 2019 at 22:01)</a>:</h4>
<p>That seems like a reasonable cause.  Feel free to submit a change request to have the engine return a better message, but you'll definitely need to pass in a path to a transform that actually resolves :)</p>



<a name="160058467"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/160058467" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#160058467">(Mar 06 2019 at 01:38)</a>:</h4>
<p>it's not because of that....</p>



<a name="164165443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164165443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexey Chistiakov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164165443">(Apr 25 2019 at 12:28)</a>:</h4>
<p>Hello! Do you have the implementation of engine of  FHIR mapping language?</p>



<a name="164173525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164173525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164173525">(Apr 25 2019 at 14:12)</a>:</h4>
<p>The FHIR Validator includes an implementation</p>



<a name="164173984"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164173984" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexey Chistiakov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164173984">(Apr 25 2019 at 14:16)</a>:</h4>
<p>Thank you so much!</p>



<a name="164532893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164532893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexey Chistiakov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164532893">(Apr 30 2019 at 12:06)</a>:</h4>
<p>Hello!<br>
We are planning R3/R4 Conversion and have some questions regarding ClaimResponse fields transformation described here: <a href="https://www.hl7.org/fhir/claimresponse-version-maps.html" target="_blank" title="https://www.hl7.org/fhir/claimresponse-version-maps.html">https://www.hl7.org/fhir/claimresponse-version-maps.html</a></p>
<p>1. ClaimResponse.outcome<br>
Transition is described as follows:<br>
 src.outcome as vs then {<br>
    vs.coding as c then {<br>
      c.code where value in ('queued' | 'complete' | 'error' | 'partial') -&gt; tgt.outcome;<br>
    };</p>
<p>Outcome field was a codeableConcept in R3 and became a code in R4. CodeableConcept is a list of Codings, so what will we get  if we copy such list to a one variable? What if there are several codes which match the target codes (‘queued' | 'complete' | 'error' | 'partial') - which one will be chosen as tgt.outcome? What if there are no match at all ?</p>
<p>Currently, we are using claimStatus code set for .outcome (‘processed as primary’ | ‘secondary’ | ‘denied’ | ‘reversal’| ‘forwarded’) - could you suggest how can we convert to R4 in such case without loosing the  initial .outcome value which is more reach than any target code?</p>
<p>2. In the old version of the resource .outcome field was optional but  it became mandatory in R4. How can we do the switch to a new version of a resource if such a field does not exist in the old one?</p>



<a name="164536424"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164536424" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164536424">(Apr 30 2019 at 13:00)</a>:</h4>
<blockquote>
<p>What if there are no match at all ?</p>
</blockquote>
<p>You can try to map the codes you have - eg ‘processed as primary’ -&gt; 'complete'</p>
<blockquote>
<p>Currently, we are using claimStatus code set for .outcome (‘processed as primary’ | ‘secondary’ | ‘denied’ | ‘reversal’| ‘forwarded’) - could you suggest how can we convert to R4 in such case without loosing the initial .outcome value which is more reach than any target code?</p>
</blockquote>
<p>You can put it into an extension - but it will be something custom to your system</p>
<blockquote>
<p>How can we do the switch to a new version of a resource if such a field does not exist in the old one?</p>
</blockquote>
<p>You have to decide on a default value to use</p>



<a name="164608860"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164608860" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexey Chistiakov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164608860">(May 01 2019 at 08:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span><br>
<span class="user-mention" data-user-id="191912">@Michele Mottini</span><br>
 Thanks a lot for useful information! By the way, I do not understand how I can convert the codeableConcept into code?</p>



<a name="164621396"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164621396" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164621396">(May 01 2019 at 13:01)</a>:</h4>
<p>Look through the Codings in the CodeableConcept and find the one that corresponds to the valueset for the target 'code'.  If you find one, that's your code.  If you don't find any, omit the element.  Any extra Codings and CodeableConcept.text will need to be sent as extensions.</p>



<a name="164627626"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/164627626" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexey Chistiakov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#164627626">(May 01 2019 at 14:33)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> Thanks!</p>



<a name="201677591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/201677591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anshu Nigam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#201677591">(Jun 23 2020 at 00:36)</a>:</h4>
<p>I'm looking for FHIR Mapping engine, I know about Vonk/Firely. Is there any other stable engine available?<br>
Thanks!</p>



<a name="201684505"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/201684505" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#201684505">(Jun 23 2020 at 03:24)</a>:</h4>
<p>There's one in the FHIR validator as well (<a href="https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content">https://wiki.hl7.org/Using_the_FHIR_Validator_to_transform_content</a>)</p>



<a name="201749283"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/201749283" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anshu Nigam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#201749283">(Jun 23 2020 at 16:29)</a>:</h4>
<p>Thanks Lloyd, Is there any other Mapping Engine, which is commercially supported ,  support as API etc.?</p>



<a name="201757168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/201757168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#201757168">(Jun 23 2020 at 17:33)</a>:</h4>
<p>Out of curiosity, what are the criteria that you are looking for?</p>



<a name="201757706"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Mapping%20Engine/near/201757706" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Anshu Nigam <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Mapping.20Engine.html#201757706">(Jun 23 2020 at 17:38)</a>:</h4>
<p>Looking for FHIR mapping engine which can be called from FHIR server to translate custom objects to FHIR resource</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
