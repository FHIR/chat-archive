---
layout: page
title: "FHIR Chat  · Canonical identifiers · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html">Canonical identifiers</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="172135173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172135173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172135173">(Jul 31 2019 at 15:01)</a>:</h4>
<p>Are all data elements with name &lt;ResourceName&gt;.url and datatype uri canonical identifiers which have to be globally unique? Examples are Library.url and Measure.url. In other words, can I enforce uniqueness on every such &lt;ResourceName&gt;.url data element? Or is there an explicit way to detect, with a StructureDefinition at hand, that a data element is such a unique identifier?</p>



<a name="172136039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172136039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172136039">(Jul 31 2019 at 15:11)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="197470">@Alexander Kiel</span>, the <code>.url</code> values should uniquely identify the resource:<br>
<a href="http://hl7.org/fhir/measure-definitions.html#Measure.url" target="_blank" title="http://hl7.org/fhir/measure-definitions.html#Measure.url">http://hl7.org/fhir/measure-definitions.html#Measure.url</a></p>
<blockquote>
<p>...also called its canonical identifier. This SHOULD be globally unique... This URL can be the target of a canonical reference. It SHALL remain the same when the measure is stored on different servers.</p>
</blockquote>
<p>cf. <code>StructureDefinition.url</code>:<br>
<a href="http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.url" target="_blank" title="http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.url">http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.url</a></p>
<p>Compare canonical url (author-assigned) vs. resource Id (usually server-assigned). Different copies of the same resource will have separate resource ids, however they will all share a common canonical url. The resource Id uniquely identifies a specific instance on a single server. The canonical url uniquely identifies a set of instances (clones) of the same resource (across many different servers).</p>



<a name="172136231"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172136231" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172136231">(Jul 31 2019 at 15:13)</a>:</h4>
<p>References to such resources are always based on the canonical url, i.e. refers to any matching instance of this resource (within context), not a single specific instance on a specific server.</p>



<a name="172138302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172138302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172138302">(Jul 31 2019 at 15:38)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> Thanks. I have read all that stuff. But is _every_ <code>.url</code> data element, regardless of concrete resource, a canonical identifier? I just generate my database schema from structure definitions and like to know if I can mark such data elements as unique. Oh wait, as I write this, I discover that <code>.url</code> isn't unique, because only the combination of <code>.url</code> and <code>.version</code> would be unique.</p>



<a name="172140062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172140062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172140062">(Jul 31 2019 at 16:01)</a>:</h4>
<p><code>StructureDefinition.version</code> is an author-assigned value:<br>
<a href="http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.version" target="_blank" title="http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.version">http://hl7.org/fhir/structuredefinition-definitions.html#StructureDefinition.version</a><br>
FHIR dictates that if an author introduces breaking changes to a profile, then they should also change the canonical url. Because the new profile is no longer compatible with the previous version, they cannot share a common canonical url.<br>
In practice, I don't expect production servers to contain multiple compatible versions of the same profile, as this would be ambiguous. Typically, in a production environment, you install a single, final, definitive version of each profile.</p>



<a name="172141162"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172141162" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172141162">(Jul 31 2019 at 16:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> I think we talk about different things. My question was whether I can detect that data elements like <code>Library.url</code> or also <code>StructureDefinition.url</code> actually hold URIs which should be globally unique. Say I like to implement a FHIR server which uses a relational database as storage and I have a table for all my Library resources. Can I mark the <code>URL</code> column as unique? </p>
<p>I discovered by myself, while asking, that I cannot because there can be two instances of say a Library resource with the same <code>Library.url</code> but different <code>Library.version</code>. </p>
<p>On the other hand, the combination of <code>Library.url</code> and <code>Library.version</code> should be unique within one FHIR server. Or do I interpret to much in this and it would be ok for a FHIR server to hold multiple instances of resources with the same <code>.url</code> and <code>.version</code>?</p>



<a name="172142751"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172142751" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172142751">(Jul 31 2019 at 16:37)</a>:</h4>
<p>Usually, in a production scenario, canonical url's will be unique. This ensures that a client/server can resolve conformance resources uniquely, which is required for validation.<br>
However there are (advanced) scenario's where this is not the case. For example Simplifier allows different users to upload profiles using the same canonical url; canonical url's are only unique within a user project. This requires a lot of additional complex logic, usually you don't have to deal with this c.q. reject this.</p>



<a name="172142816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172142816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172142816">(Jul 31 2019 at 16:38)</a>:</h4>
<p>So Simplifier uses a compound database key of the form { ProjectId, CanonicalUrl }</p>



<a name="172142855"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172142855" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172142855">(Jul 31 2019 at 16:39)</a>:</h4>
<p>However unless you are planning to implement a profile registry, you shouldn't have to worry about this.</p>



<a name="172143018"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172143018" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172143018">(Jul 31 2019 at 16:41)</a>:</h4>
<p>So generally a FHIR db could contain duplicate canonical urls, but usually this will not the case (nor desired).</p>



<a name="172143504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172143504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172143504">(Jul 31 2019 at 16:48)</a>:</h4>
<p>Even within a project canonical URL is not expected to be unique.  You can easily have multiple versions of the same profile or value set (distinguished by different .version elements) in the same project.</p>



<a name="172144776"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172144776" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172144776">(Jul 31 2019 at 17:04)</a>:</h4>
<p>I especially look at <a href="https://www.hl7.org/fhir/library.html" target="_blank" title="https://www.hl7.org/fhir/library.html">Library</a> and <a href="https://www.hl7.org/fhir/measure.html" target="_blank" title="https://www.hl7.org/fhir/measure.html">Measure</a> which also have <code>.url</code> and <code>.version</code> data elements and are not terminology resources. However Measure references Library through canonical type. In case that reference would be point to multiple libraries, I wouldn't know which one to use for my queries. But then, it's the same with <code>Meta.profile</code>. In case a server has multiple profiles with the same url/version pair, the validation should properly just fail. </p>
<p>So you would not check for duplicate url/version pairs at creation time? You would just fail in case you need to follow a canonical link?</p>



<a name="172144810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172144810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172144810">(Jul 31 2019 at 17:05)</a>:</h4>
<p>Yes!</p>



<a name="172145125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172145125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172145125">(Jul 31 2019 at 17:08)</a>:</h4>
<p>Because a single canonical url can be shared by many instances (clones) on different servers, per definition it is not <em>globally</em> unique. However canonical url's are expected to be unique within the limited scope of a (production) environment, for example within a single FHIR database. FHIR does not define how to implement the actual "resolving" of a canonical url to the target conformance resource. In a simple case, this only involves a simple lookup of the key (url) value in a local database or file system. However in advanced scenario's , the resolving process may also involve some contextual information, in addition to the canonical url; e.g. Simplifier also needs the ProjectId. Of course, this is implementation-specific.</p>



<a name="172145235"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172145235" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172145235">(Jul 31 2019 at 17:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> That's not true.  Canonical URLs are <em>NOT</em> expected to be unique in a single production environment.  Only the combination of url + version is expected to be unique.</p>



<a name="172145300"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172145300" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172145300">(Jul 31 2019 at 17:11)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> - I sidestepped versioning here, to not further confuse matters</p>



<a name="172145447"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172145447" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172145447">(Jul 31 2019 at 17:13)</a>:</h4>
<p>So if you're building a very generic server, then you need to deal with all of this...</p>



<a name="172145708"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172145708" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Kiel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172145708">(Jul 31 2019 at 17:16)</a>:</h4>
<p>Thank you both. I will move forward without any uniqueness checks upfront. I will just see that such canonical links (combination of uri and version) resolves to one single resource. It's right that the canonical resolution can be very divers.</p>



<a name="172170209"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172170209" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172170209">(Jul 31 2019 at 22:02)</a>:</h4>
<p>generally, operational servers would ensure that the combination of url+version is unique but the scope in which this happens is a business logic question, and there are use cases - general interop servers - where the business rule wouldn't apply</p>



<a name="172203324"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Canonical%20identifiers/near/172203324" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Canonical.20identifiers.html#172203324">(Aug 01 2019 at 08:56)</a>:</h4>
<p>Concerning versioning, also see: <a href="http://hl7.org/fhir/resource.html#versions" target="_blank" title="http://hl7.org/fhir/resource.html#versions">http://hl7.org/fhir/resource.html#versions</a></p>
<blockquote>
<p>There is no single best practice here; the correct choice depends on many factors outside the scope of this specification.</p>
</blockquote>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
