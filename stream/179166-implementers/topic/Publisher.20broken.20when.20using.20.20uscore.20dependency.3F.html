---
layout: page
title: "FHIR Chat  · Publisher broken when using  uscore dependency? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html">Publisher broken when using  uscore dependency?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153945450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153945450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153945450">(Mar 16 2018 at 17:31)</a>:</h4>
<p>I am trying to publish an IG (based on FHIR 3.0.1) that declares a dependency on uscore in the ig.json:</p>
<div class="codehilite"><pre><span></span>&quot;dependencyList&quot;: [
    {
      &quot;name&quot;: &quot;uscore&quot;,
      &quot;location&quot;: &quot;http://hl7.org/fhir/us/core/1.0.1&quot;
    }
  ],
</pre></div>


<p>Using the 3.0.1 publisher jar, it works fine.  If I use the current build publisher jar, however, it crashes:</p>
<div class="codehilite"><pre><span></span>Load uscore (http://hl7.org/fhir/us/core/1.0.1) from http://hl7.org/fhir/us/core/1.0.1 (11.0686sec)
Version mismatch. This IG is version 3.2.0, while the IG &#39;uscore&#39; is from version 3.1.0. Will try to run anyway) (12.0035sec)
Exception in thread &quot;main&quot; java.lang.Error: Not the right type for ElementDefinition.binding.valueSet[x]: Reference
    at org.hl7.fhir.r4.model.ElementDefinition$ElementDefinitionBindingComponent.setValueSet(ElementDefinition.java:3466)
    at org.hl7.fhir.r4.formats.JsonParser.parseElementDefinitionElementDefinitionBindingComponentProperties(JsonParser.java:1739)
    at org.hl7.fhir.r4.formats.JsonParser.parseElementDefinitionElementDefinitionBindingComponent(JsonParser.java:1723)
    at org.hl7.fhir.r4.formats.JsonParser.parseElementDefinitionProperties(JsonParser.java:1526)
    at org.hl7.fhir.r4.formats.JsonParser.parseElementDefinition(JsonParser.java:1363)
    at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinitionStructureDefinitionSnapshotComponentProperties(JsonParser.java:20735)
    at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinitionStructureDefinitionSnapshotComponent(JsonParser.java:20726)
    at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinitionProperties(JsonParser.java:20675)
    at org.hl7.fhir.r4.formats.JsonParser.parseStructureDefinition(JsonParser.java:20543)
    at org.hl7.fhir.r4.formats.JsonParser.parseResource(JsonParser.java:24564)
    at org.hl7.fhir.r4.formats.JsonParserBase.parse(JsonParserBase.java:90)
    at org.hl7.fhir.igtools.publisher.Publisher.loadIg(Publisher.java:1151)
    at org.hl7.fhir.igtools.publisher.Publisher.initialize(Publisher.java:869)
    at org.hl7.fhir.igtools.publisher.Publisher.execute(Publisher.java:352)
    at org.hl7.fhir.igtools.publisher.Publisher.main(Publisher.java:4125)
</pre></div>


<p>I've tried also adding a "source" parameter to the dependency object, but that doesn't seem to fix it.</p>
<p>If I remove the uscore dependency, however, the publisher jar doesn't crash and I get my published IG.  Any tips or is this a flat-out bug?</p>



<a name="153945466"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153945466" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153945466">(Mar 16 2018 at 18:09)</a>:</h4>
<p>To make a long story short - here is a good definitions.json.zip.  I had to update US-Core to run on latest ig-pub.but not ready to be added to CI build since refactored the folders and still in the middle of ballot changes.</p>
<p><a href="/user_uploads/10155/avaVIgtUE54PcgAQygoY_mwv/definitions.json.zip" target="_blank" title="definitions.json.zip">definitions.json.zip</a></p>



<a name="153945608"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153945608" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153945608">(Mar 17 2018 at 03:51)</a>:</h4>
<p>Thanks, <span class="user-mention" data-user-id="191401">@Eric Haas</span> -- that seems to have done the trick!</p>



<a name="153947050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947050">(Mar 22 2018 at 01:50)</a>:</h4>
<p>So the publisher only runs cleanly  when dependencyList in the ig.json file is empty.<br>
Is there another work-around?</p>



<a name="153947058"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947058" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947058">(Mar 22 2018 at 04:45)</a>:</h4>
<p>Cross posted to implementers: <a href="https://chat.fhir.org/#narrow/stream/IG.20creation/topic/Problem.20with.20dependencyList" target="_blank" title="https://chat.fhir.org/#narrow/stream/IG.20creation/topic/Problem.20with.20dependencyList">https://chat.fhir.org/#narrow/stream/IG.20creation/topic/Problem.20with.20dependencyList</a></p>



<a name="153947072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947072">(Mar 22 2018 at 05:42)</a>:</h4>
<p>Previously I fixed it like this:</p>



<a name="153947075"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947075" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947075">(Mar 22 2018 at 05:44)</a>:</h4>
<div class="codehilite"><pre><span></span>&quot;dependencyList&quot;: [
    {
      &quot;name&quot;: &quot;USCore&quot;,
      &quot;location&quot;: &quot;http://hl7.org/fhir/us/core/1.0.1&quot;,
      &quot;source&quot;: &quot;uscore&quot;
    }
  ],
</pre></div>


<p>And having a <code>uscore</code> folder in the root of my IG source project, containing the <code>definitions.json.zip</code> that Eric posted earlier in this thread.</p>



<a name="153947078"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947078" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947078">(Mar 22 2018 at 05:46)</a>:</h4>
<p>That worked the last few days, but apparently does not anymore.  See: <a href="https://chat.fhir.org/#narrow/stream/committers/subject/IG.20Publisher.20Error/near/136483" target="_blank" title="https://chat.fhir.org/#narrow/stream/committers/subject/IG.20Publisher.20Error/near/136483">https://chat.fhir.org/#narrow/stream/committers/subject/IG.20Publisher.20Error/near/136483</a></p>



<a name="153947172"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947172" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947172">(Mar 22 2018 at 13:35)</a>:</h4>
<p><span class="user-mention" data-user-id="191682">@Richard Townley-O'Neill</span> -- see the end of the thread linked above for the solution.</p>



<a name="153947436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Publisher%20broken%20when%20using%20%20uscore%20dependency%3F/near/153947436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Publisher.20broken.20when.20using.20.20uscore.20dependency.3F.html#153947436">(Mar 22 2018 at 23:42)</a>:</h4>
<p>Thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
