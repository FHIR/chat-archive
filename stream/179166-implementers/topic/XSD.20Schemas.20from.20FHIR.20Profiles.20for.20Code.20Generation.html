---
layout: page
title: "FHIR Chat  · XSD Schemas from FHIR Profiles for Code Generation · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html">XSD Schemas from FHIR Profiles for Code Generation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="224740883"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224740883" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224740883">(Feb 01 2021 at 15:23)</a>:</h4>
<p>Hello all, code generation XSD schemas for the FHIR base profiles are available <a href="https://www.hl7.org/fhir/downloads.html">for download</a>. How were these XSD schemas generated? Is there a way to generate XSD schemas programmatically for custom FHIR profiles? Thanks in advance, Marcus.</p>



<a name="224751630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224751630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224751630">(Feb 01 2021 at 16:26)</a>:</h4>
<p>The schemas for FHIR core are generated by custom code that's part of the FHIR publication process.  There are no schemas published for profiles, largely because such schemas are generally unhelpful.  Schema has no ability to support 'slicing', which is a key aspect of profile design (setting different constraints on different repetitions in an instance).  Good profiles generally don't constrain overall cardinality much because that interferes with interoperability.  (A profile shouldn't say "Patient can only have one name", but instead "Patient should have one name that meets these constraints" - and XML schema has no ability to enforce the latter.)</p>



<a name="224753465"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224753465" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224753465">(Feb 01 2021 at 16:38)</a>:</h4>
<p>Thanks a lot for your answer. So, while the complexity FHIR profiling allows for cannot be covered by XSD schemas, I am still thinking about whether they might be a useful tool for us to implement a specific FHIR profile. For instance, say we can safely assume that the resources we will create from our data source will always conform to a certain slicing variant of a profile; then a corresponding XSD schema might help us with code generation and avoid manual implementation of classes that conform to that profile variant. Or am I on the wrong track here?</p>



<a name="224754553"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224754553" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224754553">(Feb 01 2021 at 16:46)</a>:</h4>
<p>XSD can't enforce slices - it just doesn't have the technical capacity for multiple elements with the same name to have different constraints.</p>



<a name="224755924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224755924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224755924">(Feb 01 2021 at 16:54)</a>:</h4>
<p>But one XSD could reflect a single slicing variant?</p>



<a name="224757758"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224757758" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224757758">(Feb 01 2021 at 17:04)</a>:</h4>
<p>You should not generate custom classes corresponding to a profile, class structure cannot capture the important things that profile specifies (slicing, binding)</p>



<a name="224758228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224758228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224758228">(Feb 01 2021 at 17:07)</a>:</h4>
<p>Schematron can do some of that however, if the intention is validation rather than say code generation</p>



<a name="224758522"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224758522" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224758522">(Feb 01 2021 at 17:09)</a>:</h4>
<p>Slicing means different rules for different repetitions.  Schema can't define rules for one repetition unless you prohibit all other repetitions.</p>



<a name="224759108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224759108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224759108">(Feb 01 2021 at 17:13)</a>:</h4>
<p>So how is profile slicing and binding handled programmatically then? is it all "soft-coded" and not backed by any structures native to the language of implementation (e. g. classes)?</p>



<a name="224759486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224759486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224759486">(Feb 01 2021 at 17:15)</a>:</h4>
<p>(note that I am viewing from the perspective of a "data owner" so to say. we have medical data that we want to represent as FHIR resources which should conform to national profiles.)</p>



<a name="224759788"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224759788" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224759788">(Feb 01 2021 at 17:17)</a>:</h4>
<p>All 'soft coded'. Most of the work is in mapping codes</p>



<a name="224760146"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224760146" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224760146">(Feb 01 2021 at 17:19)</a>:</h4>
<p>That's the part where profiles are more relevant, the rest of the work is mostly just to generate FHIR structures, that do not really depend on profiles (and for which classes matching the general FHIR structure are very useful)</p>



<a name="224761206"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224761206" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224761206">(Feb 01 2021 at 17:26)</a>:</h4>
<p>Hmm. So, for example, when the German FHIR profile for Patient defines several custom fields as extensions - you would advise against creating a derived class that contains these fields so I can map them just like any other regular field?</p>



<a name="224761712"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224761712" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224761712">(Feb 01 2021 at 17:30)</a>:</h4>
<p>What you do with your internal software is totally up to you.  However, the XML and JSON are going to represent extensions as all one element and there's no chance of having a schema that will differentiate different extension requirements.</p>



<a name="224762702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224762702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224762702">(Feb 01 2021 at 17:37)</a>:</h4>
<p>Right. I better understand the limitations now. Thank you. :)</p>



<a name="224762949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224762949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224762949">(Feb 01 2021 at 17:38)</a>:</h4>
<blockquote>
<p>would advise against creating a derived class that contains these fields</p>
</blockquote>
<p>Yes, I advise against it, because if you do that you will also have to write custom serializer / de-serializer for your derived class</p>



<a name="224763291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224763291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rik Smithies <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224763291">(Feb 01 2021 at 17:41)</a>:</h4>
<p>@Marcus I guess that is a different question :-) That seems reasonable to me, but whether the best route to that is via XSD, I am not so sure. </p>
<p>But at any rate, in general, there are not XSDs created for profiles. The reason is that they can only cover some aspects of profiles. But there is nothing to stop you manually extending your XSD to add these extensions, and then code generating. You just cannot currently get the XSDs from the profiles automatically.</p>
<p>If you want code generation then a better route is perhaps to use the FHIR base structure definitions, plus the profile structure definitions. All the information is there. But I don't know of code generation that works directly from those. Some of the existing code frameworks (e.g. C#, java) have code generation from the base structure defs, but I don't know about from profiles. I have not heard of that existing but it seems plausible. </p>
<p>Yet another route is to change the base FHIR structures to add the extensions, as if they were normal named elements (cheat, basically), and then run that as a new custom build. Then you would get XSDs generated with the extra elements. Just don't check it back in :-)</p>



<a name="224765329"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224765329" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224765329">(Feb 01 2021 at 17:55)</a>:</h4>
<p><span class="user-mention" data-user-id="191651">@Rik Smithies</span> Yes, these are very much my thoughts. Actually I have been thinking about a "canonical" way to generate code (such as a classes) from FHIR profiles. The XSD route was one approach, but due to its limitation it seems as though it will never become canonical anyway.</p>
<p>So I might go the 'cheat' route, but probably class-based rather than XSD-based – I still have to work out the implications of that approach (such as possibly the need for custom serialization routines as Michele pointed out, for instance).</p>



<a name="224939362"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224939362" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224939362">(Feb 02 2021 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="263785">@Marcus Wurlitzer</span> it's on my todo list to write a generator for HAPI that takes a profile and generates a series of facade classes that provide an interface to the underlying FHIR POJOs but express the semantics of the profile </p>
<p>e.g. extensions get native accessors, there's no accessor for things that aren't allowed, and slices become named accessors. </p>
<p>it hasn't happened because the last item - which is necessary to make it work - is super hard.</p>



<a name="224988336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/224988336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marcus Wurlitzer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#224988336">(Feb 03 2021 at 08:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191316">@Grahame Grieve</span> great to know, thanks. I agree it is a sophisticated task, like building a compiler, basically.</p>



<a name="225549623"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225549623" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225549623">(Feb 08 2021 at 14:16)</a>:</h4>
<p>This is very interesting.</p>
<p>I am currently looking for exactly this, how to create Resources for custom Profiles:</p>
<ul>
<li><a href="#narrow/stream/179167-hapi/topic/dynamic.20creation.20of.20resources">https://chat.fhir.org/#narrow/stream/179167-hapi/topic/dynamic.20creation.20of.20resources</a></li>
</ul>
<p>One idea was to implement a code generator, which takes the profiles and outputs all the necessary accessor methods to create resources on the fly. Or preferably not even code generation, but at least some dynamic way to create Resources for a given Profile, without hardcoding every special case.</p>
<p>Apparently, this has never been done before, and described here as "super hard". So I guess the manual hardcoding is the way to go?</p>



<a name="225570974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225570974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225570974">(Feb 08 2021 at 16:38)</a>:</h4>
<p>Be aware that if you're using custom resources, you're not FHIR conformant and won't be interoperable with FHIR systems.  The interoperable approach is to use Basic.</p>



<a name="225620252"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225620252" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225620252">(Feb 08 2021 at 22:40)</a>:</h4>
<p>that wasn't what <span class="user-mention" data-user-id="381442">@Marc Günther</span> meant. He was talking about "resources" as custom generated POJOs in a HAPI framework</p>



<a name="225620287"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225620287" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225620287">(Feb 08 2021 at 22:41)</a>:</h4>
<p>the attraction of doing it manually is that you can pick and choose how much complexity to get involved with</p>



<a name="225620400"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225620400" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225620400">(Feb 08 2021 at 22:42)</a>:</h4>
<p>I do think it's possible, if you have a good FHIRPath engine, and a solid fast terminology server supporting you, to do it entirely automatically, but I'm not sure it's possible to do it fast enough for production without being able to pick and choose</p>



<a name="225675033"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225675033" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225675033">(Feb 09 2021 at 11:30)</a>:</h4>
<p>Sorry, I don't want to hijack this thread, but this sounded at least somewhat related to my problem...</p>
<p>I am currently looking for a way to dynamically create Resources that conform to the _German Corona Consensus Data Set_ (Gecco), as I would like to avoid writing 68 Methods like the following example:</p>
<ul>
<li><a href="https://groups.google.com/g/hapi-fhir/c/3Aydx6uAOWs">https://groups.google.com/g/hapi-fhir/c/3Aydx6uAOWs</a></li>
</ul>
<p>Apparently, no one has ever done this before, and given that I am very new to this entire FHIR thing (for example I do not have the slightest idea what is  a terminology server,  why I would need one, nor why it would need to be fast), I guess I need to bite the bullet, and write custom code for all 68 Profiles by hand...</p>
<p>Regarding FHIRPath, I found a <em>FHIRPathResourceGenerator</em>, that has just recently been merged into HAPI, which sounded very interesting:</p>
<ul>
<li><a href="https://github.com/hapifhir/hapi-fhir/pull/2310/commits/5b3975df145b4cd0776230168d2603afc0172176">https://github.com/hapifhir/hapi-fhir/pull/2310/commits/5b3975df145b4cd0776230168d2603afc0172176</a></li>
</ul>
<p>Unfortunately, it doesn't seem to support lists of values (slicing?).</p>



<a name="225697106"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225697106" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225697106">(Feb 09 2021 at 14:29)</a>:</h4>
<p>My suggestion would be _not_ to create any custom class, just use the standard FHIR classes for the resources in whatever library you are using. Not worth the trouble</p>



<a name="225698057"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225698057" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225698057">(Feb 09 2021 at 14:34)</a>:</h4>
<p>Yes, that's what I did in the example I posted above. I use normal _Observation_ class from HAPI library. But I still need to write 68 of these methods, and I would like to avoid that...</p>



<a name="225698643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225698643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225698643">(Feb 09 2021 at 14:38)</a>:</h4>
<p>You have to code the mapping rules _somewhere_. If you have the mapping rules in some sort of standard format that is not code you could write mapping code that use them - just creating the standard FHIR classes</p>



<a name="225699236"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225699236" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225699236">(Feb 09 2021 at 14:43)</a>:</h4>
<p>But in my experience as soon as you get in the details of each individual mapping you'll find that a general approach is hard to use - because mappings vary depending on different values, terminology mismatch etc</p>



<a name="225700294"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225700294" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225700294">(Feb 09 2021 at 14:49)</a>:</h4>
<p>(our server implementation has 47K lines of code handling the mapping to / from FHIR of our data model)</p>



<a name="225703859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225703859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225703859">(Feb 09 2021 at 15:12)</a>:</h4>
<p>Well, I have no control over the format of the source data. It could be anything.</p>
<p>As I wrote in that other thread (sorry for hijacking this one), other people (with the neccessary domain knowledge) will define the mapping from their specific set of source data into FHIR.</p>
<p>My task is to provide the system (a UI to configure the mapping, and a process to execute it), which allows those other people to define their mappings.</p>
<p>I was hoping that the StructureDefinitions are enough to implement this in some generic way, without hardcoding the Gecco Profiles into my source code. This would allow us to support other profiles later, by simply uploading their StructureDefinitions.</p>
<p>But, unfortunately, it seems that this is not possible, or at least very hard. So, I guess I have to implement 68 different methods (one for each Gecco Resource), with a huge switch/case statement in front.</p>
<p>Is this really the way to go about this? It feels so wrong in every possible way.</p>



<a name="225714756"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225714756" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225714756">(Feb 09 2021 at 16:19)</a>:</h4>
<p>If you're talking about mappings, that's StructureMap, not StructureDefinition.</p>



<a name="225728757"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225728757" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225728757">(Feb 09 2021 at 17:48)</a>:</h4>
<p>From the Gecco Downloads page, I can download a zip file which contains lots of StructureDefinitions:</p>
<ul>
<li><a href="https://simplifier.net/forschungsnetzcovid-19/">https://simplifier.net/forschungsnetzcovid-19/</a></li>
</ul>
<p>I have nowhere seen a download that does contain a StructureMap.</p>



<a name="225735337"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225735337" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225735337">(Feb 09 2021 at 18:32)</a>:</h4>
<p>There won't be any standard StructureMaps.  The StructureMaps need to be created based on what you're mapping to or from - and of course that's not "standard" and can't be published as part of the spec.</p>



<a name="225748840"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225748840" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225748840">(Feb 09 2021 at 20:03)</a>:</h4>
<p>Well, as I said, I don't know from what I'm mapping from.</p>
<p>I need to implement a mechanism that allows others to define some mapping from their arbitrary data structure to FHIR/Gecco.</p>
<p>For that, the question was, if there is some generic way to generate the FHIR Resources based on the Gecco StructureDefinitions, without reimplementing and hardcoding entire of Gecco in Java. The answer seems to be, it has never been done, at least not with HAPI, it's not clear that it can be done, and if it is, it probably is super hard to implement.</p>
<p>Which sounds strange, as there seems to be a Validation mechanism in Hapi, which can read StructureDefinitions and validate Resources against them (at least that's what I understood from the docs?). So if there is enough information to validate resources, there should be enough information to generate them, no? And the code which does all the heavy lifting of understanding those StructureDefinitions (eg. applying differentials) could be easily adapted to that use case.</p>
<p>The reason I wrote here, is because of Grahame's comment:</p>
<blockquote>
<p>it's on my todo list to write a generator for HAPI that takes a profile and generates a series of facade classes that provide an interface to the underlying FHIR POJOs but express the semantics of the profile</p>
</blockquote>
<p>which sounds very much like what I am looking for.</p>



<a name="225749133"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749133" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749133">(Feb 09 2021 at 20:05)</a>:</h4>
<p>I don't really understand what you are trying to do</p>



<a name="225749244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749244">(Feb 09 2021 at 20:06)</a>:</h4>
<p>yes, the HAPI code includes a validator that uses the structure definitions to validate json or xml and see that it conforms to the definitions.</p>



<a name="225749263"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749263" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749263">(Feb 09 2021 at 20:06)</a>:</h4>
<p>Oh ;)</p>



<a name="225749299"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749299" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749299">(Feb 09 2021 at 20:06)</a>:</h4>
<p>but it doesn't inject any content from anywhere. It just knows what should be in the resources</p>



<a name="225749367"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749367" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749367">(Feb 09 2021 at 20:06)</a>:</h4>
<p>Also, the hapi code includes the code generator that creates the classes in org.hl7.fhir.r4.model etc</p>



<a name="225749382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749382">(Feb 09 2021 at 20:07)</a>:</h4>
<blockquote>
<p>So if there is enough information to validate resources, there should be enough information to generate them, no</p>
</blockquote>
<p>Definitely not</p>



<a name="225749428"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749428" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749428">(Feb 09 2021 at 20:07)</a>:</h4>
<p>this knows how to create java classes that read and write the base FHIR resource classes.</p>



<a name="225749432"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749432" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749432">(Feb 09 2021 at 20:07)</a>:</h4>
<p>Ah</p>



<a name="225749450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749450">(Feb 09 2021 at 20:07)</a>:</h4>
<p>the dotnet stack has equivalent code</p>



<a name="225749590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749590">(Feb 09 2021 at 20:08)</a>:</h4>
<p>the gecco structure definitions are a statement of additional rules over the top of these underlying definitions. They are a set of invariants on other class definitions, not a set of class definitions.</p>



<a name="225749926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749926">(Feb 09 2021 at 20:10)</a>:</h4>
<p>Yes, they specify various differentials over stuff that is in FHIR Core, eg. Gecco-BodyWeight has some constraints on Core-BodyWeight.</p>



<a name="225749967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225749967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225749967">(Feb 09 2021 at 20:10)</a>:</h4>
<p>so generating 'classes' that represent them isn't simple transform. The code generator doesn't know how to do that. (That's what on my todo list). But if you want a sense of the challenges involved in class generation, you could look at the validator code. Maybe, say, here:  <a href="https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/instance/InstanceValidator.java#L3457">https://github.com/hapifhir/org.hl7.fhir.core/blob/master/org.hl7.fhir.validation/src/main/java/org/hl7/fhir/validation/instance/InstanceValidator.java#L3457</a></p>



<a name="225750076"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750076" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750076">(Feb 09 2021 at 20:11)</a>:</h4>
<p>but even if you had solved all that, and had a working class generator, I still don't know how that would "implement a mechanism that allows others to define some mapping from their arbitrary data structure"</p>



<a name="225750169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750169">(Feb 09 2021 at 20:12)</a>:</h4>
<p>No, that part I can do.</p>



<a name="225750521"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750521" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750521">(Feb 09 2021 at 20:14)</a>:</h4>
<p>so you could implement that on the base Resources, such as Observation, instead of on generated classes for the profiles themselves. Most of the challenges are in the mapping part, and generating the classes is low yield.</p>



<a name="225750534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750534">(Feb 09 2021 at 20:14)</a>:</h4>
<p>I can say, ok, this field corresponds to BodyWeight, that field corresponds to BloodPressure.systolic, etc... And I need to take care of conversion of codings and units...</p>
<p>The thing I don't know is how to create Gecco conformant FHIR Resources.</p>



<a name="225750832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750832">(Feb 09 2021 at 20:16)</a>:</h4>
<p>I'm not understanding this question. You just use the FHIR resources in the hapi classes, e.g. Observation, and make sure they follow the rules</p>



<a name="225750876"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225750876" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225750876">(Feb 09 2021 at 20:17)</a>:</h4>
<p>Yes, I did an example of BodyWeight by creating an Observation, it's in that Google group posting:</p>
<ul>
<li><a href="https://groups.google.com/g/hapi-fhir/c/3Aydx6uAOWs">https://groups.google.com/g/hapi-fhir/c/3Aydx6uAOWs</a></li>
</ul>
<p>But what I did there is basically just taking the BodyWeight example provided, and convert that into Java code.</p>



<a name="225751019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225751019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225751019">(Feb 09 2021 at 20:18)</a>:</h4>
<p>So I need to write methods like this for all the 68 Gecco Resources?</p>



<a name="225751305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225751305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225751305">(Feb 09 2021 at 20:20)</a>:</h4>
<p>so this is mostly about the fixed values, and not manually coding them?</p>



<a name="225751496"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225751496" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225751496">(Feb 09 2021 at 20:22)</a>:</h4>
<p>Well, the fixed stuff, but also of course the values that come from the source data. BloodPressure for example has two, systolic and diastiolic.</p>



<a name="225751816"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225751816" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225751816">(Feb 09 2021 at 20:24)</a>:</h4>
<p>And, of course, getting the information, that there ARE two values for BloodPressure. Which also is information that is available in the StructureDefinitions, that I don't want to replicate into Java.</p>



<a name="225752173"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752173" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752173">(Feb 09 2021 at 20:27)</a>:</h4>
<p>the thing about the values that come from the source data is that the data acquisition is so variable...</p>
<p>Here's how I've seen people handle this:</p>
<ul>
<li>
<p>create a json/xml template that uses something like ST.template to fill out the content (xml is actually easier than json here, because of stinking commas, but the json parser in hapi can ignore commas) (also, much more sophisticated libraries that ST.template can be used - .e.g I've seen liquid, full blown PHP, etc)</p>
</li>
<li>
<p>create a template with doesn't contain the empty elements, load it in hapi, fill out the missing bits with your actual data, and then you're done </p>
</li>
<li>
<p>use a code generator to generate a factory the spits up the constructed resources/parts of resources, and then you orchestrate that from your code that is providing the data</p>
</li>
<li>
<p>just build it manually as you do in your example there, on the basis that mostly, the boilerplate is less than the code that matters anyway</p>
</li>
</ul>



<a name="225752473"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752473" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752473">(Feb 09 2021 at 20:29)</a>:</h4>
<p>Yea, point 3 is basically what I had in mind. Either a code generator, or just something that reads and understands the StructureDefinitions at runtime and acts accordingly.</p>



<a name="225752727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752727">(Feb 09 2021 at 20:31)</a>:</h4>
<p>But, it seems, this is super complicated to implement, so I probably will have to figure out something else.</p>



<a name="225752787"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752787" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752787">(Feb 09 2021 at 20:31)</a>:</h4>
<p>well, it has to be interactive - the code generator doesn't know which slices or optional elements you're going to want, based on which data you have at hand.</p>



<a name="225752904"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752904" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752904">(Feb 09 2021 at 20:32)</a>:</h4>
<p>I was even thinking of cheating, and just take all the examples they provide, and put wildcards in the appropriate places... :o</p>



<a name="225752924"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225752924" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225752924">(Feb 09 2021 at 20:32)</a>:</h4>
<p>Yes</p>



<a name="225753519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225753519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225753519">(Feb 09 2021 at 20:37)</a>:</h4>
<p>I have the guts of a code generator for HAPI, but it's aimed at making examples, uses all slices etc, and is implemented in pascal, so probably not useful for you</p>



<a name="225753555"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225753555" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225753555">(Feb 09 2021 at 20:37)</a>:</h4>
<p>Pascal :)</p>



<a name="225754002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225754002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225754002">(Feb 09 2021 at 20:40)</a>:</h4>
<p>Well, wow, I have a lot to think about now. Seems this is harder than I expected.</p>
<p>Thanks Grahame for taking the time to answer all my questions, and sorry again for hijacking this topic! Hope I finally made sense in the end... ;)</p>



<a name="225754327"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225754327" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225754327">(Feb 09 2021 at 20:43)</a>:</h4>
<blockquote>
<p>this is harder than I expected.</p>
</blockquote>
<p>Everything is harder than expected. Especially when you decide to abstract</p>



<a name="225754472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225754472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225754472">(Feb 09 2021 at 20:44)</a>:</h4>
<p>Well, I like generic solutions. I absolutely hate to duplicate code or hardcode stuff. It's a maintenance nightmare.</p>



<a name="225809561"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225809561" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225809561">(Feb 10 2021 at 09:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191912">Michele Mottini</span> <a href="#narrow/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation/near/225749382">said</a>:</p>
<blockquote>
<blockquote>
<p>So if there is enough information to validate resources, there should be enough information to generate them, no</p>
</blockquote>
<p>Definitely not</p>
</blockquote>
<p>Ah, I missed that yesterday.</p>
<p>So which information is missing from the StructureDefinitions?</p>



<a name="225835184"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225835184" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225835184">(Feb 10 2021 at 13:29)</a>:</h4>
<p>Where to get the data from, how to transform it</p>



<a name="225848850"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225848850" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225848850">(Feb 10 2021 at 15:04)</a>:</h4>
<p>But I have the data.</p>



<a name="225850212"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850212" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850212">(Feb 10 2021 at 15:13)</a>:</h4>
<p>For example, I have:</p>
<ul>
<li>two data values: 120 and 80</li>
<li>a patient: c786ac3c-0579-4aa2-adda-db784b214ad6</li>
<li>a date: 2020-09-25</li>
</ul>
<p>and I know that these two values correspond to the systolic/diastolic Bloodpressure values from this StructureDefinition:</p>
<ul>
<li><a href="https://simplifier.net/ForschungsnetzCovid-19/BloodPressure/~json">https://simplifier.net/ForschungsnetzCovid-19/BloodPressure/~json</a></li>
</ul>



<a name="225850342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850342">(Feb 10 2021 at 15:14)</a>:</h4>
<p>So I would think that this is enough information to produce this output:</p>
<ul>
<li><a href="https://simplifier.net/ForschungsnetzCovid-19/Observation-example-blood-pressure/~json">https://simplifier.net/ForschungsnetzCovid-19/Observation-example-blood-pressure/~json</a></li>
</ul>



<a name="225850507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850507">(Feb 10 2021 at 15:15)</a>:</h4>
<p>Yes, but the information on where those two values are and what they correspond to is not inside the StructureDefinition, it is  something _you_ know</p>



<a name="225850535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850535">(Feb 10 2021 at 15:15)</a>:</h4>
<p>I'm a software developer, so I don't want to hardcode that BloodPressure Profile in Java Code (along with all the 68 others from Gecco). Instead I would like to read the existing StructureDefinition, and then produce the result.</p>



<a name="225850649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850649">(Feb 10 2021 at 15:16)</a>:</h4>
<p>You need to have also something else that describe where the data is and where it goes to</p>



<a name="225850683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850683">(Feb 10 2021 at 15:16)</a>:</h4>
<p>Yes, that's what I wrote, I know that these two values correspond to systolic/diastolic bloodpressure</p>



<a name="225850694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850694">(Feb 10 2021 at 15:16)</a>:</h4>
<p>Yes, I have that</p>



<a name="225850732"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850732" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850732">(Feb 10 2021 at 15:17)</a>:</h4>
<p>OK, I give up</p>



<a name="225850802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225850802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225850802">(Feb 10 2021 at 15:17)</a>:</h4>
<p>Sorry, I don't understand</p>



<a name="225851038"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225851038" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225851038">(Feb 10 2021 at 15:19)</a>:</h4>
<p>I'm aware that years ago some Danes worked on a profile-based code generator, a variation of HAPI. But AFAIK we don't have this anymore, so you're stuck with HAPI itself. Which is as good as its gets. <br>
If you need something else, then you may have to create it - and please share whatever it is you'll be creating!</p>



<a name="225851103"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225851103" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225851103">(Feb 10 2021 at 15:19)</a>:</h4>
<p>I would be glad to! :)</p>



<a name="225851179"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225851179" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225851179">(Feb 10 2021 at 15:20)</a>:</h4>
<p>But I have the feeling that no one really understands what I'm talking about?</p>



<a name="225851371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225851371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225851371">(Feb 10 2021 at 15:21)</a>:</h4>
<p>And for me, knowing not a lot about FHIR, StructureDefinitions seem super hard to understand.</p>



<a name="225851419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225851419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225851419">(Feb 10 2021 at 15:21)</a>:</h4>
<p>For example, I wouldn't know how to apply a differential to a baseDefinition to get the actual snapshot in Hapi.</p>



<a name="225852066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225852066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225852066">(Feb 10 2021 at 15:25)</a>:</h4>
<p>That's a good question for the #hapi stream..</p>



<a name="225852128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225852128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225852128">(Feb 10 2021 at 15:25)</a>:</h4>
<p>(not to discourage you, but that's where the hapi experts hang out)</p>



<a name="225852306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225852306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225852306">(Feb 10 2021 at 15:27)</a>:</h4>
<p>As <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> said before you need some sort of mapping information on how to get the data values (e.g., your two data values: 120 and 80) to the correct element. You would need to have the information from where you can get that information in your source data and where to place it. That can be generically represented in a StructureMap (not SteructureDefinition!) resource.</p>



<a name="225852430"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225852430" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225852430">(Feb 10 2021 at 15:27)</a>:</h4>
<p>Just based on the information present in the StructureDefinition there is no way of generically build a mapping and thus generate the wanted output.</p>



<a name="225852812"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225852812" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225852812">(Feb 10 2021 at 15:30)</a>:</h4>
<p>And if you have that information present, there is no real added value in having generated classes...</p>



<a name="225853174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225853174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225853174">(Feb 10 2021 at 15:32)</a>:</h4>
<p>Yea, I'm sorry, I think my questions didn't belong here in the first place...</p>



<a name="225854437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225854437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225854437">(Feb 10 2021 at 15:40)</a>:</h4>
<p>You need to know what LOINC codes for blood pressure, systolic and diastolic and you need to know that the systolic and diastolic values go in Observation.component.value rather than separate Observation instances.  The only ways to capture that are to write custom code for each type of measurement (or perhaps a generic set of code that uses a table or something to map) or to write your own StructureMaps.  FHIR can't know what your values mean and map them for you.</p>



<a name="225870926"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225870926" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225870926">(Feb 10 2021 at 16:57)</a>:</h4>
<blockquote>
<p>You need to know what LOINC codes for blood pressure, systolic and diastolic</p>
</blockquote>
<p>Aren't these available in the StructureDefinition in:</p>
<ul>
<li>Observation.code.coding:loinc.code</li>
<li>Observation.component:systolicBloodPressure.code.coding:loinc.code</li>
<li>Observation.component:diastolicBloodPressure.code.coding:loinc.code</li>
</ul>
<p>?</p>
<blockquote>
<p>and you need to know that the systolic and diastolic values go in Observation.component.value rather than separate Observation instances.</p>
</blockquote>
<p>That I hoped would be apparent from the cardinality of the Observation.component which is 2..* and the slicing information in:</p>
<ul>
<li>Observation.component:systolicBloodPressure.value[x]</li>
<li>Observation.component:diastolicBloodPressure.value[x]</li>
</ul>
<p>in the StructureDefinition.</p>
<blockquote>
<p>The only ways to capture that are to write custom code for each type of measurement (or perhaps a generic set of code that uses a table or something to map) or to write your own StructureMaps. </p>
</blockquote>
<p>Yes, that's what I hear. It seems rather unfortunate.</p>
<blockquote>
<p>FHIR can't know what your values mean and map them for you.</p>
</blockquote>
<p>Yes, of course it doesn't know that, and cannot map them for me automagically. I'm a little bit at a loss as to why this topic is brought up all the time, as I never asked about it.</p>
<p>The system I'm currently writing will allow the source data owner to specify that:</p>
<ul>
<li>this source data value X will map to BloodPressure Profile with element path Observation.component:systolicBloodPressure.value[x], and</li>
<li>that source data value Y will map to BodyWeight Profile with element path Observation.value[x]"</li>
</ul>
<p>etc... </p>
<p>That mapping mechanism is easy to implement, and will be completely generic. What I don't understand, how to generate the FHIR Resources in a generic way, without hardcoding/reimplementing entire of Gecco in Java.</p>



<a name="225873811"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225873811" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225873811">(Feb 10 2021 at 17:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="193430">Alexander Zautke</span> <a href="#narrow/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation/near/225852430">said</a>:</p>
<blockquote>
<p>Just based on the information present in the StructureDefinition there is no way of generically build a mapping and thus generate the wanted output.</p>
</blockquote>
<p>I don't want to build a mapping automatically out of the StructureDefinitions. Of course this is not possible. They have no knowledge of the source data.</p>
<p>What I need is:</p>
<ul>
<li>given a mapping that someone already defined (see above, that mapping knows everything about the source data, and where each value should end up in which Gecco Resource),</li>
<li>to create the desired resources in a generic way.</li>
</ul>



<a name="225873937"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225873937" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225873937">(Feb 10 2021 at 17:17)</a>:</h4>
<p>Sorry, I don't really know how to explain this any better. I feel there is some fundamental misunderstanding here, which might entirely my fault, as I don't know FHIR and its use cases very much...</p>



<a name="225877133"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225877133" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225877133">(Feb 10 2021 at 17:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="381442">Marc Günther</span> <a href="#narrow/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation/near/225870926">said</a>:</p>
<blockquote>
<p>That mapping mechanism is easy to implement, and will be completely generic. What I don't understand, how to generate the FHIR Resources in a generic way, without hardcoding/reimplementing entire of Gecco in Java.</p>
</blockquote>
<p>You could allow the source data owner to look at the Gecco profiles and define a mapping between the source data elements and the final path to the corresponding element in FHIR. That's a manually process where the StructureDefinition doesn't help you a lot in the sense that you can't extract such information out of the profiles. Such a mapping can be captured and interpreted in a StructureMap resource. A StructureMap can be used if your source data elements can be uniquely identified and accessed in some way. The path of the target where you want to map to is not required to be bound to the profile. The slices and other details defined in the profile are important for validation but <strong>not</strong> for creating the profiles. It's sufficient to use the base classes. It's only necessary to look into the profile to see what elements are "hard-coded" like Observation.code.</p>



<a name="225877259"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225877259" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225877259">(Feb 10 2021 at 17:39)</a>:</h4>
<p>So the idea would be to go through the StructureDefinition, look for fixed values or patterns. Otherwise look up your mapping from the source to the target.</p>



<a name="225877959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225877959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225877959">(Feb 10 2021 at 17:43)</a>:</h4>
<p>If StructureMaps are too hard to generate or to interpret you can of course go with any other sort of mapping table</p>



<a name="225878192"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225878192" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Zautke <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225878192">(Feb 10 2021 at 17:44)</a>:</h4>
<p>And as an extra workaround you could also add the fixed elements from the profiles into your mapping table as well, so you only need to look at one source.</p>



<a name="225887933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225887933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225887933">(Feb 10 2021 at 18:48)</a>:</h4>
<p>Typically mappings are done to Observation, not to a particular profile.  Profiles, instead, simply guide where you choose to map.  So you won't map to an element called "systolicValue", instead, you'll map to Observation.component and assert that the code needs to have a specific LOINC coding and then map to the Observation.component.value.</p>



<a name="225902382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/225902382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#225902382">(Feb 10 2021 at 20:28)</a>:</h4>
<p><span class="user-mention" data-user-id="381442">@Marc Günther</span> you can generate the snapshot using org.hl7.fhir.r5.conformance.ProfileUtilities. </p>
<p>I could certainly write a resource generator that takes a profile and map of name / value pairs. It would construct the resource as specified in the profile, and marge in the data from the map, where the map name is the element id in the profile (in the snapshot).</p>
<p>Here's the problems I would anticipate:</p>
<ul>
<li>the generator wouldn't know how to decide whether to include an optional complex element or not (unless there was an arbitrary rule that it's only included if there's matching data elements)</li>
<li>for any repeating complex, you'd need to somehow match the data elements in the sub-elements to their matching pairs </li>
<li>the values would have to be complex values, in some cases, but you wouldn't know how to generate the complex values (because the profiles don't always profile down to primitive elements). That's both a java typing problem, and a more fundamental problem that the generating code has to understand the profiles inherently.</li>
<li>many profiles (don't know about the gecco)  still leave elements unspecified, elements you'd need to populate them. A profile based generator wouldn't be able to generate them</li>
</ul>



<a name="226018462"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/226018462" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Marc Günther <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#226018462">(Feb 11 2021 at 16:32)</a>:</h4>
<p>Thanks Grahame, <code>ProfileUtilities.generateSnapshot()</code> looks exactly like what I would need. That <code>processPaths()</code> method in there, which does the real work, looks like some serious piece of programming, there is absolutely no way I could understand how it works.</p>
<p>I fear, what I had in mind (which is exactly what you describe, thanks, I'm glad someone finally understands what I'm talking about), requires some similar complexity, even without the problems you mentioned, so while I have no doubt that you could write something like this, I guess this is out of my league.</p>
<p>So for now, I will try to hardcode Gecco in Java, I hope it should be possible without replicating too much code. Maybe later, when I got a better understanding of all the little details, I can try a more generic approach. That <code>generateSnapshot()</code> will definitely be very helpful.</p>
<p>Thanks all for your help, I hope I didn't steal too much of your time.</p>



<a name="226045740"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/226045740" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#226045740">(Feb 11 2021 at 19:33)</a>:</h4>
<p>no problems. processPaths has grown slowly over the years. I wish I had taken a different approach but it's never got to the 'let's rewrite from scratch' point.</p>



<a name="226461095"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/226461095" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lin Zhang <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#226461095">(Feb 16 2021 at 01:12)</a>:</h4>
<p><span class="user-mention" data-user-id="381442">@Marc Günther</span>  Integration/interface engines such as Mirth connect might provide some inspirations for your design of a generator and its UI.</p>



<a name="226488060"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/XSD%20Schemas%20from%20FHIR%20Profiles%20for%20Code%20Generation/near/226488060" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Timo Rosenblatt <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/XSD.20Schemas.20from.20FHIR.20Profiles.20for.20Code.20Generation.html#226488060">(Feb 16 2021 at 09:06)</a>:</h4>
<p><span class="user-mention" data-user-id="381442">@Marc Günther</span>  Seems like we're in the same boat stumbling to get into FHIR.<br>
A few days ago I found <a href="https://simplifier.net/downloads/firely-terminal">https://simplifier.net/downloads/firely-terminal</a>. This can be used to create snapshots from CLI.</p>
<p>Snapshot generation is described at <a href="https://docs.fire.ly/projects/Firely-Terminal/CommonScenarios/SnapshotGeneration.html">https://docs.fire.ly/projects/Firely-Terminal/CommonScenarios/SnapshotGeneration.html</a>.<br>
Maybe this helps you.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
