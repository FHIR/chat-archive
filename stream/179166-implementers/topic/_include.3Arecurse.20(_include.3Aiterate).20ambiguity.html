---
layout: page
title: "FHIR Chat  · _include:recurse (_include:iterate) ambiguity · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html">_include:recurse (_include:iterate) ambiguity</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="205994407"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/205994407" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Limor Lahiani <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#205994407">(Aug 05 2020 at 07:15)</a>:</h4>
<p>In the following search query,  is the parameter _include:recurse=Patient:general-practitioner refers to Patient resources resulted from the previous _include:recurse=MedicationRequest:patient or the first MedicationDispense:patient?</p>
<p>[base]/MedicationDispense?_include=MedicationDispense:patient&amp;_include=MedicationDispense:prescription&amp;_include:recurse=MedicationRequest:patient&amp;_include:Recurse=Patient:general-practitioner</p>



<a name="206086630"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206086630" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206086630">(Aug 05 2020 at 22:39)</a>:</h4>
<p>First, 'recurse' should be lower-case.  Upper case might not work on all servers.</p>
<p>'recurse' says "do this on any patients in the result set" - so it would be all patients identified - both the MedicationDispense and the MedicationRequests.</p>



<a name="206109351"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206109351" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Limor Lahiani <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206109351">(Aug 06 2020 at 06:43)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> , it was just a typo when writing the message. I use ':recurse' properly :)</p>
<p>Thanks for the info, I've probably missed it in the spec..</p>
<p>To follow up on this question then, does the order matter? I mean "do this on any patients in the result set" so far in the query, or overall? </p>
<p>For example in these queries, should all results bee the same?</p>
<p>MedicationDispense?_include=MedicationDispense:patient&amp;_include=MedicationDispense:prescription&amp;_include:recurse=MedicationRequest:patient&amp;<strong>_include:recurse=Patient:general-practitioner</strong></p>
<p>MedicationDispense?_include=MedicationDispense:patient&amp;<strong>_include:recurse=Patient:general-practitioner</strong>&amp;_include=MedicationDispense:prescription&amp;_include:recurse=MedicationRequest:patient</p>
<p>MedicationDispense?_include=MedicationDispense:patient&amp;<strong>_include:recurse=Patient:general-practitioner</strong>&amp;_include=MedicationDispense:prescription&amp;_include:recurse=MedicationRequest:patient&amp;<strong>_include:recurse=Patient:general-practitioner</strong></p>



<a name="206150387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206150387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206150387">(Aug 06 2020 at 14:43)</a>:</h4>
<p>The order in which parameters are listed does not matter</p>



<a name="206266948"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206266948" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206266948">(Aug 07 2020 at 14:56)</a>:</h4>
<p>? I'd expect the sequence to mater, for an initial _include (potentially :recurse) may have a n impact on a subsequent _include (:recurse). The sequence matters.</p>



<a name="206381610"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206381610" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Limor Lahiani <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206381610">(Aug 09 2020 at 06:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191372">@René Spronk</span>, <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  - That was my thinking. That the sequence of _include and _include:recurse matters... turns out it doesn't., which is counter intuitive, especially in this example:<br>
MedicationDispense?_include=MedicationDispense:prescription&amp;<strong>_include:recurse=MedicationRequest:patient</strong>&amp;_include:recurse=Patient:general-practitioner&amp;<strong>_include=MedicationDispense:patient</strong></p>



<a name="206393824"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/206393824" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#206393824">(Aug 09 2020 at 12:51)</a>:</h4>
<p>Order of parameters doesn't matter in HTTP calls in general - and some software isn't able to retain order.  If you think this needs additional clarification in the spec, please submit a pull request.</p>



<a name="213974829"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/213974829" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Limor Lahiani <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#213974829">(Oct 20 2020 at 20:24)</a>:</h4>
<p>Thanks. To follow up on this, according to <a href="https://www.hl7.org/fhir/references.html">https://www.hl7.org/fhir/references.html</a>, there are transitively cyclic references.<br>
Say we have  A --&gt; B --&gt; C --&gt; D --&gt; A. Wouldn't there be an ambiguity when using search queries with _include and _include:iterate  for those references? What is the expected behavior?</p>



<a name="213975272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/_include%3Arecurse%20%28_include%3Aiterate%29%20ambiguity/near/213975272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/_include.3Arecurse.20(_include.3Aiterate).20ambiguity.html#213975272">(Oct 20 2020 at 20:28)</a>:</h4>
<p>The search spec leaves it to the server's discretion how deep to iterate. There's no guarantee of what the depth limit will be.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
