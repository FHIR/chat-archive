---
layout: page
title: "FHIR Chat  · Search on AllergyIntolerance.patient · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html">Search on AllergyIntolerance.patient</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153966842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966842">(Jun 05 2018 at 01:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span> has picked up an issue in my server which is an an issue in the specification itself</p>



<a name="153966843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966843">(Jun 05 2018 at 01:49)</a>:</h4>
<p>the symptom is that the search <a href="http://test.fhir.org/r3/AllergyIntolerance?patient=1" target="_blank" title="http://test.fhir.org/r3/AllergyIntolerance?patient=1">http://test.fhir.org/r3/AllergyIntolerance?patient=1</a> returns an error which should be:</p>
<div class="codehilite"><pre><span></span>Parameter &quot;patient&quot; is invalid because the type of resource referenced is not specified
</pre></div>



<a name="153966844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966844">(Jun 05 2018 at 01:49)</a>:</h4>
<p>but if you check at <a href="http://hl7.org/fhir/STU3/allergyintolerance.html#search" target="_blank" title="http://hl7.org/fhir/STU3/allergyintolerance.html#search">http://hl7.org/fhir/STU3/allergyintolerance.html#search</a> you'll see that patient is apparently only defined for the patient resource, and so that error is wrong.</p>



<a name="153966845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966845">(Jun 05 2018 at 01:50)</a>:</h4>
<p>only... not so fast. if you look carefully, you'll see that it has 31 other resources using the common search parameter</p>



<a name="153966846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966846">(Jun 05 2018 at 01:52)</a>:</h4>
<p>and if you hunt down the formal definition in the downloads - because this it is never published - you'll see that this search parameter has 2 target types: Patient and Group. Because some of the other resources allow group, even though AllergyIntolerance doesn't</p>



<a name="153966847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966847">(Jun 05 2018 at 01:52)</a>:</h4>
<p>my server is actually implementing the underlying search parameter</p>



<a name="153966861"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153966861" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153966861">(Jun 05 2018 at 03:59)</a>:</h4>
<p>so the question is, what does it mean when a resource shares the parameter, but has a lesser target type range?</p>



<a name="153967035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967035">(Jun 05 2018 at 13:19)</a>:</h4>
<p>Isn't that a mistake in the formal definitions? (I actually did notice it in our own auto-generated code and I programmed around it...)</p>



<a name="153967036"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967036" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967036">(Jun 05 2018 at 13:20)</a>:</h4>
<p>See also <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13601" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13601">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=13601</a></p>



<a name="153967039"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967039" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967039">(Jun 05 2018 at 13:50)</a>:</h4>
<p>Yes, this is the same issue</p>



<a name="153967040"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967040" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967040">(Jun 05 2018 at 13:50)</a>:</h4>
<p>there's a mistake somewhere, but I'm not sure where it is.</p>



<a name="153967041"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967041" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967041">(Jun 05 2018 at 13:50)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> - you drove this...?</p>



<a name="153967125"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967125" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Silva <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967125">(Jun 05 2018 at 17:28)</a>:</h4>
<p>related question -- is this property name going to be 'harmonized' to 'subject' like is done in other STU3 or newer resources?  ( <a href="https://www.hl7.org/fhir/encounter.html#tabs-diff" target="_blank" title="https://www.hl7.org/fhir/encounter.html#tabs-diff">https://www.hl7.org/fhir/encounter.html#tabs-diff</a> )</p>



<a name="153967136"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967136" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967136">(Jun 05 2018 at 18:46)</a>:</h4>
<p>Our general rule is that if it's just patient, then it should be patient, where as it would be subject if it can be something other than patient (such as group)</p>



<a name="153967143"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967143" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967143">(Jun 05 2018 at 18:55)</a>:</h4>
<p>Just added to the issue that it is also raised on nr. #15903. In Vonk we override this searchparameter with a corrected version of it that targets only Patient because we got this same question several times.</p>



<a name="153967384"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967384" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967384">(Jun 06 2018 at 15:02)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> - you drove this...?</p>
</blockquote>
<p>In what sense do you mean?  </p>
<p>The background I have is this: We've found this because users of the .NET API reported it: <a href="https://github.com/ewoutkramer/fhir-net-api/issues/339" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/issues/339">https://github.com/ewoutkramer/fhir-net-api/issues/339</a>, on 30 june 2017 I wrote</p>
<p>"I found the cause. No, it's not all of them. Some resources have their own defined parameter "patient", here the target is just "Patient". However, there is a searchparameter in the spec called "clinical-patient" that is defined for a number of resources, and which has both Patient and Group. This is the cause. It does not seem to make sense to me. I'll continue this discussion in Zulip...."</p>
<p>this is talking about the search parameters in "search-parameters.xml", a file that we use to generate the API. It has</p>
<div class="codehilite"><pre><span></span>    &lt;target value=&quot;Patient&quot; /&gt;
    &lt;target value=&quot;Group&quot; /&gt;
</pre></div>


<p>so, this seems to be the cause.</p>



<a name="153967530"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967530" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967530">(Jun 06 2018 at 19:55)</a>:</h4>
<p>you drove that the cross-research search parameters should be correctly defined</p>



<a name="153967532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967532">(Jun 06 2018 at 19:57)</a>:</h4>
<p>what I'm not sure about here is which way to resolve this:<br>
- if the shared resource doesn't have all the target types on a particular resource to which it applies, then the target need not be specified<br>
- a search parameter can't be shared across multiple resources in this case<br>
- this search parameter is wrong because "patient" should never target "Group"</p>



<a name="153967795"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967795" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967795">(Jun 07 2018 at 08:43)</a>:</h4>
<p>So, I am leaning to the third option - if we've noticed these parameters are actually "the same" across resources, we might ask a committee why they deviate. The result of this discussion might be a conclusion that either</p>
<p>a)  the search parameter is not "the same", and should be renamed, so it is no longer shared<br>
b) yes, it should be aligned, and the additional targets added or removed</p>
<p>The second option is not possible I think - we consider adding a new reference type  a non-breaking change, but it would make a shared search parameter disappear - which is a breaking change.</p>
<p>The first option would cause "runtime" errors: there would be no way to avoid causing errors by looking at just the definitions we provide, unless we would define a parameter with the same name both on the general resource and on the more specific resource where it deviates.  This adds complexity.</p>
<p>I think we can get away with option 3 for now, as this might well be the only case.</p>



<a name="153967854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Search%20on%20AllergyIntolerance.patient/near/153967854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Search.20on.20AllergyIntolerance.2Epatient.html#153967854">(Jun 07 2018 at 17:49)</a>:</h4>
<p>+1 for changing the definition of the "patient" search parameter to target only Patient</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
