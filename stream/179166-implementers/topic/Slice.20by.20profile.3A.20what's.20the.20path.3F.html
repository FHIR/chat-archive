---
layout: page
title: "FHIR Chat  · Slice by profile: what&#x27;s the path? · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html">Slice by profile: what&#x27;s the path?</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153971486"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971486" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971486">(Jun 25 2018 at 10:39)</a>:</h4>
<p>Suppose I slice by profile. What would be in the discriminator.path? Is "meta.profile" too easy? I'm trying to profile MedicationRequest.supportingInformation that has Resource(any).</p>



<a name="153971487"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971487" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971487">(Jun 25 2018 at 10:41)</a>:</h4>
<p>Follow up question. If I slice by profile: am I effectively requesting at least that particular profile be present in the meta.profile of the instances? I would expect I am, but just making sure.</p>



<a name="153971489"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971489" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971489">(Jun 25 2018 at 10:47)</a>:</h4>
<p>If you slice by profile, you're checking whether the instance matches that profile and requiring that it can only match one of the profiles.</p>



<a name="153971490"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971490" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971490">(Jun 25 2018 at 10:47)</a>:</h4>
<p>There's no requirement if be declared</p>



<a name="153971517"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971517" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971517">(Jun 25 2018 at 11:09)</a>:</h4>
<p>In STU3 I get an error if I omit path. Also the definition in STU3 says "Each discriminator is a pair of values: a type that indicates how the field is processed when evaluating the discriminator, and a FHIRPath  expression that identifies the element in which the discriminator is found."</p>



<a name="153971519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971519">(Jun 25 2018 at 11:15)</a>:</h4>
<p>The thing with "resource that matches the profile", suggests that the instance needs to be valid against that profile.</p>
<p>Suppose I want to profile MedicationRequest.supportingInformation to BodyWeight and BodyHeight. Both are profiles on Observation.</p>
<p>If the supportingInformation instance reference goes to an Observation with meta.profile BodyWeight I would expect the validator to 'see' that BodyWeight is referenced and that this satisfies the supportingInformation requirement. </p>
<p>Next, if the Observation with profile BodyWeight then yields a validation error, then this would be reported only on BodyWeight, but not on MedicationRequest. Are my assumptions correct here?</p>



<a name="153971547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153971547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153971547">(Jun 25 2018 at 14:31)</a>:</h4>
<p>So supportingInformation would be the path and the profile would be the targetProfile of the resource</p>



<a name="153972253"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153972253" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153972253">(Jun 27 2018 at 22:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191375">@Alexander Henket</span> -- if I'm understanding you correctly, I think you want to put the <code>slicing</code> on <code>Medication.supportingInformation</code>, so you can't use <code>supportingInformation</code> as the discriminator path (since discriminator path is relative to the element with the <code>slicing</code>).  In this case, since it's a reference, and the discriminator type is <code>profile</code>, I think your discriminator path needs to be <code>reference.resolve()</code>.</p>



<a name="153972254"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153972254" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153972254">(Jun 27 2018 at 22:03)</a>:</h4>
<p>I could be wrong (slicing is tricky), but that's my understanding based on the STU3 spec docs here: <a href="http://hl7.org/fhir/STU3/profiling.html#discriminator" target="_blank" title="http://hl7.org/fhir/STU3/profiling.html#discriminator">http://hl7.org/fhir/STU3/profiling.html#discriminator</a>.  See the 3rd row in the discriminator examples table.</p>



<a name="153972302"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153972302" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alexander Henket <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153972302">(Jun 28 2018 at 06:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191469">@Chris Moesel</span> You could be right. I thought of that too and I'd agree with you that putting supportingInformation in the path when your context is already just that, doesn't seem right. </p>
<p>That path excludes use of Reference.identifier + display does it not? Because there is no reference to resolve in that case. Would a validator need to error on use of identifier + display or just warn because it cannot establish conformance to the targetProfile?</p>
<p>Is there something worth discussing here for R4? It feels like there are a couple of uncertainties we need to iron out.</p>
<p>Just in case: here's the profile we're discussing <a href="https://simplifier.net/NictizSTU3-Zib2017/ZIB-MedicationAgreement/~overview" target="_blank" title="https://simplifier.net/NictizSTU3-Zib2017/ZIB-MedicationAgreement/~overview">zib-MedicationAgreement</a></p>



<a name="153972355"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153972355" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Chris Moesel <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153972355">(Jun 28 2018 at 12:31)</a>:</h4>
<p>Ah.  Gotcha.  If you just have an <code>identifier</code> (or worse yet, just a <code>display</code>), then it may not be resolvable anyway-- and as you noted, it certainly would not be resolvable via the <code>reference.resolve()</code> path.  Without resolving it, it's impossible to check if the reference conforms to the profile.</p>
<p>That said, I <em>think</em> it would still pass validation?  You're using an <em>open</em> slicing and each of your slices (<em>BodyWeight</em> and <em>BodyHeight</em>) have a <em>min</em> 0.  If an instance had <code>supportingInformation</code> that used logical references (by <code>identifier</code>), I think the validator would not be able to identify them as belonging to one of the slices, but since it's an open slicing, it would still allow them to exist in the array anyway -- and since neither slice is required (<em>min</em> is 0), validation would pass without anything in the slices.  I think.</p>
<p>Of course, if it was <em>closed</em> slicing, or your slices had a <em>min</em> of 1 -- then it would be a different story.  In that case I'm not sure what a validator would do, but I <em>suspect</em> you'd essentially need to require that those references be literal (i.e., use the <code>reference</code>).</p>
<p>My caveat is that I haven't tried any of this -- I'm just going based on past similar (but still different) experiences.  The other caveat is that I think the validator may not know how to deal with profile-based discriminators anyway (see: <a href="#narrow/stream/99-IG-creation/topic/discriminators.20based.20on.20profiles.20is.20not.20yet.20supported" title="#narrow/stream/99-IG-creation/topic/discriminators.20based.20on.20profiles.20is.20not.20yet.20supported">https://chat.fhir.org/#narrow/stream/99-IG-creation/topic/discriminators.20based.20on.20profiles.20is.20not.20yet.20supported</a>) -- so even if you do it right it might not validate.</p>



<a name="153978226"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Slice%20by%20profile%3A%20what%27s%20the%20path%3F/near/153978226" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Townley-O&#x27;Neill <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Slice.20by.20profile.3A.20what&#x27;s.20the.20path.3F.html#153978226">(Jul 26 2018 at 06:30)</a>:</h4>
<p>(deleted)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
