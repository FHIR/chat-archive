---
layout: page
title: "FHIR Chat  · References between contained resources · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html">References between contained resources</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="198040542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198040542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Sauer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198040542">(May 19 2020 at 09:21)</a>:</h4>
<p>Im trying to make a reference between "Practitoner" and "PractitionerRole". Both are contained resources within an appointment.</p>
<div class="codehilite"><pre><span></span><code>&lt;contained&gt;
    &lt;Practitioner&gt;
      &lt;id value=&quot;1&quot; /&gt;
      &lt;text&gt;
        &lt;status value=&quot;generated&quot; /&gt;
        &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;vorname1 NachnameDesBehandlers&lt;/div&gt;
      &lt;/text&gt;
      &lt;name&gt;
        &lt;text value=&quot;vorname1 NachnameDesBehandlers&quot; /&gt;
        &lt;family value=&quot;NachnameDesBehandlers&quot; /&gt;
        &lt;given value=&quot;vorname1&quot; /&gt;
        &lt;given value=&quot;vorname2&quot; /&gt;
      &lt;/name&gt;
    &lt;/Practitioner&gt;
  &lt;/contained&gt;
  &lt;contained&gt;
    &lt;PractitionerRole&gt;
      &lt;id value=&quot;0&quot; /&gt;
      &lt;text&gt;
        &lt;status value=&quot;generated&quot; /&gt;
        &lt;div xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;Behandler: vorname1 NachnameDesBehandlers&lt;/div&gt;
      &lt;/text&gt;
      &lt;practitioner&gt;
        &lt;reference value=&quot;#1&quot; /&gt;
      &lt;/practitioner&gt;
      &lt;code&gt;
        &lt;coding&gt;
          &lt;system value=&quot;http://fhir.uniklinik-freiburg.de/ig/appointment/ValueSet/PractionerRoleVS&quot; /&gt;
          &lt;code value=&quot;Behandler&quot; /&gt;
          &lt;display value=&quot;Behandler: vorname1 NachnameDesBehandlers&quot; /&gt;
        &lt;/coding&gt;
        &lt;text value=&quot;vorname1 NachnameDesBehandlers&quot; /&gt;
      &lt;/code&gt;
    &lt;/PractitionerRole&gt;
  &lt;/contained&gt;
</code></pre></div>


<p>When validating, I got an error:</p>
<div class="codehilite"><pre><span></span><code>&lt;issue&gt;
    &lt;severity value=&quot;error&quot;/&gt;
    &lt;code value=&quot;processing&quot;/&gt;
    &lt;diagnostics value=&quot;ref-1: SHALL have a contained resource if a local reference is provided ( (url: 1; ids: )) [reference.startsWith(&#39;#&#39;).not() or (reference.substring(1).trace(&#39;url&#39;) in %resource.contained.id.trace(&#39;ids&#39;))]&quot;/&gt;
    &lt;location value=&quot;Appointment.contained[1].practitioner&quot;/&gt;
    &lt;location value=&quot;Line 31, Col 21&quot;/&gt;
&lt;/issue&gt;
</code></pre></div>



<a name="198062087"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198062087" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198062087">(May 19 2020 at 13:05)</a>:</h4>
<p><del>The Practitioner should be contained inside the PractitionerRole (...but it gets really weird)</del> (wrong, sorry, see below)</p>



<a name="198070014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198070014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198070014">(May 19 2020 at 14:03)</a>:</h4>
<p>contained resources can't contain other resources :)</p>



<a name="198070425"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198070425" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198070425">(May 19 2020 at 14:06)</a>:</h4>
<p>"Contained resources SHALL NOT contain additional contained resources." from <a href="http://hl7.org/fhir/references.html#contained">http://hl7.org/fhir/references.html#contained</a></p>



<a name="198070621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198070621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198070621">(May 19 2020 at 14:07)</a>:</h4>
<p>That validation seems wrong</p>



<a name="198070841"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198070841" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198070841">(May 19 2020 at 14:08)</a>:</h4>
<p>unless I'm missing something...</p>



<a name="198075165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198075165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> René Spronk <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198075165">(May 19 2020 at 14:37)</a>:</h4>
<p>It's  a resource with 2 sibling-contained-resources. That's ok. They should be able to reference each other.</p>



<a name="198076951"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198076951" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198076951">(May 19 2020 at 14:49)</a>:</h4>
<p>that is what I would expect too - may need to reach out to Hapi (if that's the validator) to see why this fails?</p>



<a name="198084342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198084342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198084342">(May 19 2020 at 15:36)</a>:</h4>
<p><span class="user-mention" data-user-id="191356">@Jenni Syed</span> is correct.  All contained resources must be siblings.  You can't have a contained within a contained.  The identifiers are all evaluated within the scope of the overall containing resource.  It looks like there's a problem with the invariant - it doesn't allow for the possibility of the linkage from the container to a contained resource being through <em>another</em> contained resource.  In the short term, you may need an extension to create a link to satisfy the invariant.  However, please submit a change request for us to fix the invariant <span class="user-mention" data-user-id="194649">@Michael Sauer</span></p>



<a name="198085925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/198085925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Sauer <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#198085925">(May 19 2020 at 15:47)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> Thank you very much for your clarification and for your explanation. I will submit a change request! :-)</p>



<a name="246470148"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/246470148" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shamil Nizamov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#246470148">(Jul 19 2021 at 15:27)</a>:</h4>
<p>Can one contained resource reference another contained resource within the same container? E.g., the List resource has Patient and Encounter as contained resources, and the contained Encounter reference to the contained Patient.</p>



<a name="246470296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/246470296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#246470296">(Jul 19 2021 at 15:28)</a>:</h4>
<p>Yes.</p>



<a name="246470940"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/246470940" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Shamil Nizamov <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#246470940">(Jul 19 2021 at 15:32)</a>:</h4>
<p>Then what will be the reference link - in the same way as List references to the contained Patient, e.g., <em>#patient1</em> , or back to the container and then to the contained, i.e., - <em>#/#patient1</em> ?</p>



<a name="246471099"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/246471099" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#246471099">(Jul 19 2021 at 15:33)</a>:</h4>
<p>It's just #patient1. Because contained resources cannot be nested, there is only one namespace.</p>



<a name="246471189"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/References%20between%20contained%20resources/near/246471189" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Church <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/References.20between.20contained.20resources.html#246471189">(Jul 19 2021 at 15:34)</a>:</h4>
<p>The only special case is that "#" refers to the container.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
