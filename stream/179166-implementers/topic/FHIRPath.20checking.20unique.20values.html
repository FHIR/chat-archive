---
layout: page
title: "FHIR Chat  · FHIRPath checking unique values · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html">FHIRPath checking unique values</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="174798227"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174798227" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> frank cao <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174798227">(Sep 03 2019 at 15:15)</a>:</h4>
<p>Hi, I'm trying to specify constraint to make sure patient address does not contain duplicate use and type values. Can this be done in FHIRPath, something like address.select(use, type).isDistinct()? The combination of address use and type needs to be unique. Thanks.</p>



<a name="174800574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174800574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174800574">(Sep 03 2019 at 15:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191359">@Bryn Rhodes</span></p>



<a name="174800769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174800769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174800769">(Sep 03 2019 at 15:42)</a>:</h4>
<p>Before enforcing the constraint, consider that patients may have multiple home or business addresses and may have 'historic' addresses that are no longer active.  It may be better to require that one address of each use+type combination be designated as primary/preferred using an extension.  That way you're not preventing the client from sending the addresses they know about.</p>



<a name="174802769"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174802769" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> frank cao <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174802769">(Sep 03 2019 at 16:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> <br>
Thanks Lloyd. I'll give it some thoughts. Can this be done in FHIRPath, though? I need some guidance on the syntax of the expression, especially the select(expression) part.</p>



<a name="174803394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174803394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174803394">(Sep 03 2019 at 16:12)</a>:</h4>
<p>That's why I drew Bryn's attention to the thread.  I'm not super familiar with the 'select' operation.  Best to get advice from an expert :)</p>



<a name="174819746"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174819746" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174819746">(Sep 03 2019 at 19:07)</a>:</h4>
<p><code>address.select(use | type).isDistinct()</code></p>
<p>the select returns a collections of collections where the inner collection contains the use and the type. The isDistinct() checks that the outer collection has no duplicates.</p>



<a name="174891532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174891532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> frank cao <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174891532">(Sep 04 2019 at 15:13)</a>:</h4>
<p>Thanks Grahame. I'm not sure if isDistinct() can be used here as it will only return true if all the items are distinct. If I have two addresses, one with use = "home", type = "physical", the other one with use = "home", type = "postal", your query will return false, but I want to compare the combination so this should pass. What I need is something like address[0].select(use|type) != address[1].select(use|type), but how do I expand it to work beyond 2 addresses?</p>



<a name="174920907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174920907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174920907">(Sep 04 2019 at 20:40)</a>:</h4>
<p>I thought that was how that FHIRPath works. Did you test it?</p>



<a name="174952548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174952548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174952548">(Sep 05 2019 at 07:54)</a>:</h4>
<p>The problem is that the select won't preserve the combinations, it will jut put them all in a single list. So you won't have a list of pairs of use/type elements, which is what you're really trying to say is unique here, if I'm understanding the question correctly.</p>



<a name="174952612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174952612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174952612">(Sep 05 2019 at 07:55)</a>:</h4>
<p>I think without a constructor, you'd have to do something hackish like <code>select(use &amp; type).isDistinct</code></p>



<a name="174952812"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/FHIRPath%20checking%20unique%20values/near/174952812" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/FHIRPath.20checking.20unique.20values.html#174952812">(Sep 05 2019 at 07:58)</a>:</h4>
<p>ok yes I missed this: </p>
<blockquote>
<p>(collections resulting from evaluation of <em>projection</em> are flattened)</p>
</blockquote>
<p>So yes, have to hack with &amp;</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
