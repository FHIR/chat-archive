---
layout: page
title: "FHIR Chat  · Extensions and Cardinality/Flag Changes · implementers"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/index.html">implementers</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html">Extensions and Cardinality/Flag Changes</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173136017"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/173136017" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#173136017">(Aug 13 2019 at 17:59)</a>:</h4>
<p>Given an extension E that is incorporated into a profile P.<br>
Assume E has a field F that has:<br>
  cardinality <br>
  flags (e.g., no Must support)<br>
Can the profile P constrain a published extension with a different (compatible) cardinality and a MS?</p>
<p>Or, is an extension, an extension, and is incorporated as-is.</p>
<p>For a concrete example, imagine an IG that is supposed to incorporate this extension:  <a href="http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-contactpoint-availabletime.html" target="_blank" title="http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-contactpoint-availabletime.html">http://hl7.org/fhir/uv/vhdir/2018Sep/StructureDefinition-contactpoint-availabletime.html</a></p>
<p>Here is the extension:<br>
<a href="/user_uploads/10155/6PRYWFYNAlY9pPBCDEN3cL4o/image-2.png" target="_blank" title="image-2.png">image-2.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/6PRYWFYNAlY9pPBCDEN3cL4o/image-2.png" target="_blank" title="image-2.png"><img src="/user_uploads/10155/6PRYWFYNAlY9pPBCDEN3cL4o/image-2.png"></a></div><p>Is it compatible with this specification when embedded in a profile (this is for davinci-plan-net):<br>
<a href="/user_uploads/10155/hxml1HoBzSXmVRqDrscCQAlX/image-3.png" target="_blank" title="image-3.png">image-3.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/hxml1HoBzSXmVRqDrscCQAlX/image-3.png" target="_blank" title="image-3.png"><img src="/user_uploads/10155/hxml1HoBzSXmVRqDrscCQAlX/image-3.png"></a></div><p>Thanks,<br>
Saul</p>



<a name="173138026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/173138026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#173138026">(Aug 13 2019 at 18:25)</a>:</h4>
<p>you have two choices:</p>
<p>1. constrain a defined extension  by profiling it.<br>
2. Make your own custom extension<br>
I never done the first and don't know if the tooling supports this</p>



<a name="173674905"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/173674905" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#173674905">(Aug 20 2019 at 16:55)</a>:</h4>
<p>It's definitely possible to profile an existing extension defining additional constraints (including mustSupport).  The fixed URL for the extension remains the same (because the semantics are the same), but you'd reference the canonical URL of the "profiled" extension in your profile to ensure that your constraints/expectations are enforced.  This works in the Java validator for sure (because I helped make the fixes when it initially didn't :&gt;)</p>



<a name="184286416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/184286416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#184286416">(Dec 26 2019 at 22:31)</a>:</h4>
<p>Hi <strong>Lloyd McKenzie</strong>  -- since the extensions are incorporated by reference, I'm not sure what this would look like.     Can you point me to an example where somebody has done this?    The current use cases (from Plan-Net) include:<br>
    - taking an extension with a reference to a VhDir type <a href="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-location-reference.html" target="_blank" title="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-location-reference.html">https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-location-reference.html</a>, and making it refer to a Plan-Net type  <a href="https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-Location-reference-extension.html" target="_blank" title="https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-Location-reference-extension.html">https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-Location-reference-extension.html</a> (Plan-Net is a first cousin to VhDir, not a descendant)<br>
    - taking an extension with an 'example' binding to a VS and making the binding 'extensible' <a href="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-endpoint-usecase.html" target="_blank" title="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-endpoint-usecase.html">https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-endpoint-usecase.html</a></p>



<a name="184286804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/184286804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#184286804">(Dec 26 2019 at 22:41)</a>:</h4>
<p>I don't know off the top of my head where this has been done that I can point you too.  You can profile an extension definition in the same way as you can profile a resource.  The derived profile won't changed the fixed URL declared in the original extension definition, but can tighten up whatever else you need to.  You point to the derived extension profile rather than the original.</p>



<a name="186904832"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/186904832" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Halina Labikova <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#186904832">(Jan 29 2020 at 16:51)</a>:</h4>
<p><span class="user-mention" data-user-id="215604">@Saul Kravitz</span>  - have you solved this since then? I'm dealing with a similar issue - I need to create a derived profile, where the valueSet used by its standard extension is constrained to a subset. A resource conforming to this derived profile needs to also conform to the parent profile. Since, as you said, the extension is incorporated by reference, deriving the extension itself won't work in this case. How have you approached this at the end?</p>



<a name="186906270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/186906270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#186906270">(Jan 29 2020 at 17:05)</a>:</h4>
<p>In theory, you could profile the extension.  The structure definition used for extensions and profiles is basically the same.<br>
With the tooling I used for my IG (CIMPL), this wasn't supported.   With FSH/Sushi it is easily done, but there is currently no direct path to a publishable IG.</p>
<p>What I did was just "clone" the extension within the IG I was developing, and impose constraints there.  IN my case, I needed to change a reference type.   YOu can see the original here:   <a href="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-newpatients.html" target="_blank" title="https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-newpatients.html">https://build.fhir.org/ig/HL7/VhDir//StructureDefinition-newpatients.html</a> and the 'clone' here <a href="https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-NewPatients-extension.html" target="_blank" title="https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-NewPatients-extension.html">https://build.fhir.org/ig/HL7/davinci-pdex-plan-net/StructureDefinition-plannet-NewPatients-extension.html</a> </p>
<p>From the perspective of the consumer of the data, they will have to deal with a different  extension (uri is different) either way, so I don't think my solution is that bad.</p>



<a name="186911112"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/186911112" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Halina Labikova <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#186911112">(Jan 29 2020 at 17:57)</a>:</h4>
<p><span class="user-mention" data-user-id="215604">@Saul Kravitz</span> </p>
<blockquote>
<p>With FSH/Sushi it is easily done, but there is currently no direct path to a publishable IG.</p>
</blockquote>
<p>From my understanding, fsh output is missing only the build file and the ig file for it to be ready to be consumed by the publisher scripts - both are easily generated manually, so tooling is not really an issue. </p>
<blockquote>
<p>From the perspective of the consumer of the data, they will have to deal with a different extension (uri is different) either way, so I don't think my solution is that bad.</p>
</blockquote>
<p>I guess this is my issue - I was hoping to find a way to impose constraints on an extension when used in a context of a specific profile, but without changing the referenced url (for conformance purposes). <br>
To give a specific example: I'm currently investigating whether using mCODE's PrimaryCancerCondition would cover all of our usecases. Let's say I need a derived profile to capture Mucosal Melanoma: I need to restrict the acceptable values in the onco-core-HistologyMorphologyBehavior-extension. If I do that by profiling the extension itself, the resource instance that will be conformant to my MM profile will no longer be conformant to the PrimaryCancerCondition profile.</p>



<a name="186916955"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/186916955" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#186916955">(Jan 29 2020 at 19:00)</a>:</h4>
<blockquote>
<p>From my understanding, fsh output is missing only the build file and the ig file for it to be ready to be consumed by the publisher scripts - both are easily generated manually, so tooling is not really an issue. </p>
</blockquote>
<p>for very simple and orthodox IGs, without pages, perhaps. but we're not there yet</p>



<a name="186917330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179166-implementers/topic/Extensions%20and%20Cardinality/Flag%20Changes/near/186917330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Saul Kravitz <a href="https://fhir.github.io/chat-archive/stream/179166-implementers/topic/Extensions.20and.20Cardinality.2FFlag.20Changes.html#186917330">(Jan 29 2020 at 19:04)</a>:</h4>
<p><span class="user-mention" data-user-id="194075">@Halina Labikova</span>   I think your conformance concern is accurate.  I did not face that since my IG (Plan-Net) is not derived from the IG I was borrowing extensions from (VhDir).      I might try to generate a profile of the mCode extension using Sushi, and then figure out how to slip it into your IG.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
