---
layout: page
title: "FHIR Chat  · Context for `.union` · fhirpath.js"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/index.html">fhirpath.js</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html">Context for `.union`</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="275991830"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179298-fhirpath.js/topic/Context%20for%20%60.union%60/near/275991830" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html#275991830">(Mar 20 2022 at 22:47)</a>:</h4>
<p>Is it expected that</p>
<div class="codehilite"><pre><span></span><code>name.select(use | given)
</code></pre></div>

<p>should return different results from</p>
<div class="codehilite"><pre><span></span><code>name.select(use.union(given))
</code></pre></div>

<p>? I would have expected these to be equivalent but <code>union</code> appears to be operating at the root level even when it occurs inside a <code>select</code>.</p>



<a name="275991949"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179298-fhirpath.js/topic/Context%20for%20%60.union%60/near/275991949" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html#275991949">(Mar 20 2022 at 22:50)</a>:</h4>
<p>Ah, <a href="https://hl7.org/fhirpath/#unionother-collection">https://hl7.org/fhirpath/#unionother-collection</a> explicitly states that these should be equivalent, so it looks like a bug in fhirpath.js unless I'm missing something.</p>



<a name="276089278"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179298-fhirpath.js/topic/Context%20for%20%60.union%60/near/276089278" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html#276089278">(Mar 21 2022 at 17:48)</a>:</h4>
<p>It is not clear us whether the documentation means "a" and "b" are elements of the same node.  For some functions, in a.someFunction(b), "b" is interpreted as being a child of the elements in "a", and I think that is how fhirpath.js is handling union.</p>



<a name="276089365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179298-fhirpath.js/topic/Context%20for%20%60.union%60/near/276089365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html#276089365">(Mar 21 2022 at 17:49)</a>:</h4>
<p>Note that in <a href="https://hl7.org/fhirpath/#function-invocations">https://hl7.org/fhirpath/#function-invocations</a>, the full path is used.<br>
<code>Patient.telecom.where(use = 'official').union(Patient.contact.telecom.where(use = 'official')).exists().not()</code><br>
(Though, that has "contact" in the path, so it not quite a counter-example.)</p>



<a name="276089387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179298-fhirpath.js/topic/Context%20for%20%60.union%60/near/276089387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Paul Lynch <a href="https://fhir.github.io/chat-archive/stream/179298-fhirpath.js/topic/Context.20for.20.60.2Eunion.60.html#276089387">(Mar 21 2022 at 17:49)</a>:</h4>
<p>Maybe this should be discussed on the fhirpath stream?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
