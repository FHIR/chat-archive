---
layout: page
title: "FHIR Chat  · Bullet points re: public apps etc · argonaut"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/index.html">argonaut</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html">Bullet points re: public apps etc</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="237199647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237199647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237199647">(May 03 2021 at 17:44)</a>:</h4>
<ol>
<li>Refresh tokens are important for providing a seamless consumer experience.  If an app is ineligible for refresh tokens, the developer is likely to seek other means of achieving this (e.g., saving a user's password and simulating login; or moving to a cloud-based architecture even though there's no use case for managing data off-device).</li>
</ol>



<a name="237200049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237200049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237200049">(May 03 2021 at 17:47)</a>:</h4>
<ol start="2">
<li>Client architectures that put data in the cloud (e.g., confidential apps) are open to certain attacks that purely-on-device apps are not subject to (e.g., cloud server becomes compromised and tokens/secrets leak). A breach in this context can be <em>widespread</em>, across many users.</li>
</ol>



<a name="237200243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237200243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237200243">(May 03 2021 at 17:48)</a>:</h4>
<ol start="3">
<li>Public clients (including, e.g., most native apps today, where an app is only registered once with a given EHR) are open to certain attacks that confidential clients can avoid (e.g., a malicious app on your device might steal tokens from a valid app, or might impersonate a valid app). A breach in this context is more likely to be <em>isolated to a given user or device</em>.</li>
</ol>



<a name="237200372"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237200372" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237200372">(May 03 2021 at 17:49)</a>:</h4>
<p>--&gt; The choice of app architecture should be based based on context. Apps that already need to manage data in the cloud should consider a confidential client architecture; apps that don't should consider a purely-on-device architecture.</p>



<a name="237200531"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237200531" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237200531">(May 03 2021 at 17:50)</a>:</h4>
<p>But this decision only works if refresh tokns are available in either case; otherwise, app developers will switch architectures <em>just to be able to maintain persistent access</em>, even if the overall security posture is dimnished.</p>
<p>^^ Is this assessment worth capturing in a "best practices / considerations" page?</p>



<a name="237200614"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237200614" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Marquard <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237200614">(May 03 2021 at 17:50)</a>:</h4>
<p>Don't worry, you didn't miss a meeting....Josh + I + Dan had a call to prepare for Friday call and thought why not post some thoughts to help generate discussion.</p>



<a name="237206547"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237206547" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237206547">(May 03 2021 at 18:27)</a>:</h4>
<p>What options exist that let an auth server verify that a client can secure a refresh token?  Dynamic Client Registration I think is one option.  Are there any others?</p>



<a name="237206844"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237206844" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237206844">(May 03 2021 at 18:29)</a>:</h4>
<p>Other than a simple self-attestation.</p>



<a name="237206967"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237206967" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237206967">(May 03 2021 at 18:30)</a>:</h4>
<blockquote>
<p>What options exist that let an auth server verify that a client can secure a refresh token? Dynamic Client Registration I think is one option. Are there any others?</p>
</blockquote>
<p>I don't think dynamic client registration itself does this, right? If this is per-device, then the refresh token and the per-device client_secret can leak through the same channels.</p>



<a name="237207110"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237207110" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237207110">(May 03 2021 at 18:30)</a>:</h4>
<p>I think attestation is a good practice from the "make sure everyone is thinking about this" perspective -- but it breaks down if apps that "admit" the truth aren't eligible for the access they need.</p>
<p>So: attestation <em>with the right incentives</em> seems like a good pattern.</p>



<a name="237892808"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237892808" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237892808">(May 07 2021 at 21:29)</a>:</h4>
<p>(deleted)</p>



<a name="237893781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237893781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237893781">(May 07 2021 at 21:38)</a>:</h4>
<p>OAuth 2.1 provides mechanisms for public clients to protect refresh tokens.  See [1] for details, but in summary cryptographic token binding is one mechanism, rotation of detection and replay of refresh tokens is another.</p>
<p>[1]: <a href="https://tools.ietf.org/html/draft-ietf-oauth-v2-1-02#section-6.1">https://tools.ietf.org/html/draft-ietf-oauth-v2-1-02#section-6.1</a></p>



<a name="237893866"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237893866" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237893866">(May 07 2021 at 21:39)</a>:</h4>
<p>In particular, DPOP should be a readily-accessible method for most applications to perform such cryptographic binding.  See <a href="https://tools.ietf.org/html/draft-ietf-oauth-dpop-02">https://tools.ietf.org/html/draft-ietf-oauth-dpop-02</a></p>



<a name="237895414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237895414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237895414">(May 07 2021 at 21:52)</a>:</h4>
<p>And the recommendations for refresh token rotation are something servers can do in a way that's totally transparent for (non-malicious) clients.</p>



<a name="237897157"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237897157" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237897157">(May 07 2021 at 22:06)</a>:</h4>
<p>The DPOP spec is really nice, but early. <span class="user-mention" data-user-id="191609">@Matt Randall</span> do you think this will move ahead?</p>
<blockquote>
<p>DPoP does not ensure the integrity of the payload or headers of requests.  The DPoP proof only contains claims for the HTTP URI and  method, but not, for example, the message body or general request headers.</p>
</blockquote>
<blockquote>
<p>This is an intentional design decision intended to keep DPoP simple to use,</p>
</blockquote>
<p>That's a really good call. Still, this is a fair amount of new surface area.</p>



<a name="237902044"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237902044" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237902044">(May 07 2021 at 22:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>  DPOP seems to have some weight behind it, I hadn't even realized I had linked to a previous version - draft 3 apparently was released last month, so it's definitely under active development.</p>
<p>Refresh token rotation seems fairly achievable without adding a 2nd draft spec into the mix, but has the negative side effect that if something goes awry in managing the state of that token on either side (client or authorization server), it could result in the user having to go back through the authorization flow. </p>
<p>DPOP on the other hand seems fairly robust and relatively straightforward for both client and server to implement, with the only drawback I see is that the crypto used to bind the refresh token initially won't last forever (after many years, whatever algorithm or key strength that was used would be considered defunct, likely requiring a revocation).</p>



<a name="237902281"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237902281" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matt Randall <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237902281">(May 07 2021 at 22:59)</a>:</h4>
<p>To add my opinion, refresh rotation seems favorable initially, given that refresh rotation as a possibility is already covered in 2.0 [1].  </p>
<p>[1] <a href="https://tools.ietf.org/html/rfc6749#section-10.4">https://tools.ietf.org/html/rfc6749#section-10.4</a></p>



<a name="237902376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/Bullet%20points%20re%3A%20public%20apps%20etc/near/237902376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/Bullet.20points.20re.3A.20public.20apps.20etc.html#237902376">(May 07 2021 at 23:00)</a>:</h4>
<p>I like that DPOP provides an answer to "how to mitigate the risk of tokens leaving a device". (We had discussed the idea of dynamic registration + asymmetric keys for otherwise public apps, which can also help in this situation; it's functionally pretty close, if you constrain the scope of "dynamic registration" to be "registering a local device instance associated with all the metadata about some already registered client")</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
