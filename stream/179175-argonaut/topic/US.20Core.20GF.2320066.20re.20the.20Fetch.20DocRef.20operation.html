---
layout: page
title: "FHIR Chat  · US Core GF#20066 re the Fetch DocRef operation · argonaut"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/index.html">argonaut</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html">US Core GF#20066 re the Fetch DocRef operation</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="159094896"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159094896" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159094896">(Feb 21 2019 at 19:07)</a>:</h4>
<p>See US Core <a href="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20066" target="_blank" title="http://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20066">GF#20066</a><br>
This tracker brings up a couple of issues making the case that  that this  $docref could be a search</p>
<ul>
<li>Who is using it?</li>
<li>Based on the the definition of  <a href="http://hl7.org/fhir/operations.html#3.2.0" target="_blank" title="http://hl7.org/fhir/operations.html#3.2.0">operation</a> it is clearly an operation.  The case is being made that this could be a search too since many times there aren't a bunch of FHIR resources being persisted ... so the first two bullets in the operation definition don't make a lot of sense since always creating "new" resources on the fly in the background in response to a search request</li>
<li>what <em>should</em> it be? ( I am inclined to agree with John)</li>
<li>do we ned to edit the operation definition? </li>
</ul>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  <span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span>  <span class="user-mention" data-user-id="191357">@Andrew Torres</span></p>



<a name="159095169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159095169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159095169">(Feb 21 2019 at 19:11)</a>:</h4>
<p><a href="https://fhir.cerner.com/millennium/dstu2/infrastructure/document-reference/#operation-docref" target="_blank" title="https://fhir.cerner.com/millennium/dstu2/infrastructure/document-reference/#operation-docref">https://fhir.cerner.com/millennium/dstu2/infrastructure/document-reference/#operation-docref</a></p>



<a name="159095174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159095174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159095174">(Feb 21 2019 at 19:11)</a>:</h4>
<p>We are using it to meet MU3.</p>



<a name="159095200"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159095200" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159095200">(Feb 21 2019 at 19:11)</a>:</h4>
<p>The operation was used because we are asking the API to take action to generate a document.</p>



<a name="159095326"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159095326" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159095326">(Feb 21 2019 at 19:13)</a>:</h4>
<p>Yes, same for us</p>



<a name="159095611"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159095611" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159095611">(Feb 21 2019 at 19:16)</a>:</h4>
<p>We don't explicitly say anywhere that servers are prohibited from creating data on the fly in response to a query, however there's an implicit assumption that if I query the data today and I query the data tomorrow, all of yesterday's data will still be there unless it's been explicitly deleted.  With an operation, there's no expectation that information will be retained.</p>



<a name="159096214"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159096214" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159096214">(Feb 21 2019 at 19:24)</a>:</h4>
<p>$docref supports <code>start</code> and <code>end</code> parameters - that do not make much sense for a search</p>



<a name="159099353"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159099353" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159099353">(Feb 21 2019 at 19:56)</a>:</h4>
<p>My comment was specifically to express the difference between $docref and a query on DocumentReference. If the difference is indeed that there is an expectation that $docref will result in "a" DocumentReference that does not currently exist, and will not return all the other DocumentReference that do exist.. THEN I would be very happy. What I am worried about is that $docref does something similar but not exactly the same as a query on DocumentReference... I would still be concerned with this kind of OnDemand mechanism that seems to be different than doing a query on DocumentReference. This because, as Lloyd points out, it is very possible to create a DocumentReference during a query on DocumentReference. This is indeed what is described in IHE-MHD for support of OnDemand.   So I would be happy with a clarification of the behavior of $docref, and and note that DocumentReference query can achieve the same result...</p>



<a name="159099815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159099815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159099815">(Feb 21 2019 at 20:01)</a>:</h4>
<p>DocumentReference query cannot achieve the same result <code>$docref?start=x&amp;end=y</code> creates and returns a document with all the data for that period, that is not something a search can do</p>



<a name="159100343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100343">(Feb 21 2019 at 20:07)</a>:</h4>
<p>why not?</p>



<a name="159100437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100437">(Feb 21 2019 at 20:09)</a>:</h4>
<p><span class="user-mention" data-user-id="191912">@Michele Mottini</span>   I think that would be the same as <code>DocumentReference?patient=[patient]&amp;period=[period]</code>  assuming the server would respond with a an "on the fly' response to it as lloyd explains above</p>



<a name="159100439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100439">(Feb 21 2019 at 20:09)</a>:</h4>
<p>seems to be a simple use of the DocumentReference -period query parameter.</p>



<a name="159100463"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100463" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100463">(Feb 21 2019 at 20:09)</a>:</h4>
<p>Search parameter that result in modifying the data inside one of the returned resources?</p>



<a name="159100478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100478">(Feb 21 2019 at 20:09)</a>:</h4>
<p>right. Yes there needs to be some way that a server can declare that it will respond that way... but it is fully possible</p>



<a name="159100570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100570">(Feb 21 2019 at 20:10)</a>:</h4>
<p>but that is simply a profile declaration in the CapabilityStatement...</p>



<a name="159100580"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100580" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100580">(Feb 21 2019 at 20:10)</a>:</h4>
<p>however we do default to  'the latest the most recent or current document is in scope.' when no time period is given</p>



<a name="159100635"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100635" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100635">(Feb 21 2019 at 20:11)</a>:</h4>
<p>I'd say that search parameters should modify the set of resources that is returned. not  what is inside the resources</p>



<a name="159100643"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100643" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100643">(Feb 21 2019 at 20:11)</a>:</h4>
<p>@Michele  I don't understand 'result in modifying the data inside one of the returned resources'</p>



<a name="159100697"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100697" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100697">(Feb 21 2019 at 20:12)</a>:</h4>
<p>Maybe the specs do not explicitly prohibit - but it seems to me that would be a very strange behavior indeed</p>



<a name="159100780"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100780" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100780">(Feb 21 2019 at 20:13)</a>:</h4>
<p>It is not strange... when I use various RESTful api against classic internet providers, results are returned to me that clearly didn't exist prior to me asking. There is no way for a map API to have all possible responses.</p>



<a name="159100854"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100854" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100854">(Feb 21 2019 at 20:14)</a>:</h4>
<p>FHIR is an API, not a persistence model. Else we couldn't be using FHIR as an API to an EHR database... :-)</p>



<a name="159100867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100867">(Feb 21 2019 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> calling <code>$docref?start=2019-01-01</code> and <code>$docref?start=2018-01-01&amp;end=2018-12-31</code> returns one document in both cases, but _different_ documents: the first has all the data for this year, the second all the data for last year</p>



<a name="159100903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100903">(Feb 21 2019 at 20:15)</a>:</h4>
<p>and why is that an issue?</p>



<a name="159100907"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159100907" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159100907">(Feb 21 2019 at 20:15)</a>:</h4>
<p>again.. I am okay with $docref, as long as it is clear that is where one goes for ondemand documents, and as long as DocumentReference query is not forbidden from doing the same thing given the same query parameters.</p>



<a name="159101004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159101004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159101004">(Feb 21 2019 at 20:16)</a>:</h4>
<p>because search parameters do searches? and searches returns different sets of things depending on the value of the search parameters - do not change the things</p>



<a name="159101014"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159101014" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159101014">(Feb 21 2019 at 20:17)</a>:</h4>
<p>more specifically I think $docref needs to clearly NOT return non-ondemand document entries</p>



<a name="159101153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159101153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159101153">(Feb 21 2019 at 20:18)</a>:</h4>
<p>The Client does not know whether the resources are persisted or created on the fly so I not sure that matters for them.  If the resources are persisted then it would matter for the server.</p>



<a name="159101276"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159101276" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159101276">(Feb 21 2019 at 20:20)</a>:</h4>
<p>so back to <span class="user-mention" data-user-id="191404">@John Moehrke</span>  why can't one overload the operation with regular search?  what is the issue there?</p>



<a name="159102398"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159102398" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159102398">(Feb 21 2019 at 20:39)</a>:</h4>
<p>a naming opportunity: calling it something like <code>$generate-ccda</code> would be a heck of a lot clearer.</p>



<a name="159102421"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159102421" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159102421">(Feb 21 2019 at 20:39)</a>:</h4>
<p>Agree with Josh :)</p>



<a name="159102488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159102488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159102488">(Feb 21 2019 at 20:40)</a>:</h4>
<p>Also, the doc for us is not persisted, and wouldn't come back in a general search</p>



<a name="159102534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159102534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159102534">(Feb 21 2019 at 20:41)</a>:</h4>
<p>if that <em>is</em> persisted, and changes the state of the server/resource, that would be unexpected behavior for a GET</p>



<a name="159102536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159102536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159102536">(Feb 21 2019 at 20:41)</a>:</h4>
<p>which is precisely why we went operation (all the above)</p>



<a name="159103055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159103055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159103055">(Feb 21 2019 at 20:49)</a>:</h4>
<p>If the operation can be defined in a non-US-centric manner, that would be better.  CCDA is US-specific.</p>



<a name="159104232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159104232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159104232">(Feb 21 2019 at 21:04)</a>:</h4>
<p>Lloyd, the type of document is a parameter. so the client explicitly asks for C-CDA. it is not baked into the API</p>



<a name="159104859"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159104859" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159104859">(Feb 21 2019 at 21:13)</a>:</h4>
<blockquote>
<p>so back to <span class="user-mention silent" data-user-id="191404">@John Moehrke</span>  why can't one overload the operation with regular search?  what is the issue there?</p>
</blockquote>
<p>is this a question to me? Or is this a echoing my statement and asking others why not?   <br>
Because I am happy to keep the operation with a well defined behavior, but am also happy for it to go away and use query for that functionality.</p>



<a name="159105234"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159105234" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159105234">(Feb 21 2019 at 21:18)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> I was pushing back against the proposal for $generate-ccda as a name.</p>



<a name="159105649"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159105649" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159105649">(Feb 21 2019 at 21:24)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="191404">@John Moehrke</span> I was pushing back against the proposal for $generate-ccda as a name.</p>
</blockquote>
<p>ah, right... $generate-doc</p>



<a name="159105890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159105890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159105890">(Feb 21 2019 at 21:27)</a>:</h4>
<p>actually the current $docref does not have a parameter for the encoding of the document... it does expect C-CDA output...    <br>
which is a good behavior problem... if a server can give a document for the given LOINC code in 5 different formats (mime-type + profile-conformance), does it return 5 different DocumentReference? Or does the server guess at the best response?</p>



<a name="159106233"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106233" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106233">(Feb 21 2019 at 21:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span>  it was a question for you.   As it stands it does overload with search which at the  time seemed like a good idea as a  convenience for the client.  They don't know how or care how the document is fetched.   So would like to know the specific issues when is truly a search  ( assume you would get the best match )</p>



<a name="159106277"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106277" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106277">(Feb 21 2019 at 21:31)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>   the operation is not just for ccda</p>



<a name="159106385"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106385" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106385">(Feb 21 2019 at 21:32)</a>:</h4>
<p>right. That is why IHE XDS just folded OnDemand into normal XDS query. Most clients don't know they should ask two questions when they simply want to know what documents are available.</p>



<a name="159106431"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106431" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106431">(Feb 21 2019 at 21:33)</a>:</h4>
<p>so we went with a operation.   which is better?</p>



<a name="159106548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106548">(Feb 21 2019 at 21:35)</a>:</h4>
<blockquote>
<p>the current $docref does not have a parameter for the encoding of the document..</p>
</blockquote>
<p>The server chooses what it want to serve</p>



<a name="159106647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106647">(Feb 21 2019 at 21:36)</a>:</h4>
<p>...implementation detail...  but should mention that in the spec</p>



<a name="159106648"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106648" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106648">(Feb 21 2019 at 21:36)</a>:</h4>
<p>Re: naming, what's the common thread? <code>$generate-document</code>?</p>



<a name="159106662"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106662" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106662">(Feb 21 2019 at 21:36)</a>:</h4>
<p>Is it just about summary documents?</p>



<a name="159106993"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159106993" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159106993">(Feb 21 2019 at 21:40)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>   like John and  I said its more a client get doc operation adn trying to <strong>mush both</strong>  onthefly and existing docrefs into single transaction.  so I think any name should reflect the client side  more like $return-docref</p>



<a name="159107183"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107183" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107183">(Feb 21 2019 at 21:42)</a>:</h4>
<p>I'm still stumped then. What's the use case for an operation to return an existing doc?</p>



<a name="159107253"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107253" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107253">(Feb 21 2019 at 21:43)</a>:</h4>
<p>like John mentioned above</p>
<blockquote>
<p>Most clients don't know they should ask two questions when they simply want to know what documents are available.</p>
</blockquote>



<a name="159107369"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107369" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107369">(Feb 21 2019 at 21:45)</a>:</h4>
<p>Ideally <em>one</em> ask for a docref no matter whether is created anew or persisted somewheres</p>



<a name="159107383"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107383" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107383">(Feb 21 2019 at 21:45)</a>:</h4>
<blockquote>
<p>I'm still stumped then. What's the use case for an operation to return an existing doc?</p>
</blockquote>
<p>if we make it clear that the operation is to only return potential ondemand documents, and will NOT return existing documents; then the client can know that it doesn't have to have logic to look for redundant entries. One way or the other... I just want deterministic behavior.</p>



<a name="159107570"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107570" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107570">(Feb 21 2019 at 21:47)</a>:</h4>
<p>And IHE went with a search that does it all.   And the intent was for $docref to do it all as well.   ( which is the focus of his tracker - although I could counter his tracker with a tracker on IHE and say the same ... :-))</p>



<a name="159107687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107687">(Feb 21 2019 at 21:49)</a>:</h4>
<p><code>$generate-or-retrieve-document</code></p>



<a name="159107699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107699">(Feb 21 2019 at 21:49)</a>:</h4>
<p>Bottom I am OK either way do it all with search or do is all with an operation.  Just need the community to decide what we want to do and then we can address the name</p>



<a name="159107713"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107713" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107713">(Feb 21 2019 at 21:50)</a>:</h4>
<p>It's the reference that throws me off, I think -- it's not expressing the intent of the caller.</p>



<a name="159107773"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107773" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107773">(Feb 21 2019 at 21:50)</a>:</h4>
<p>I see your point there</p>



<a name="159107819"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107819" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107819">(Feb 21 2019 at 21:51)</a>:</h4>
<p><code>$get-documents</code>allows for the possibility of generation or retrieval and is shorter...</p>



<a name="159107872"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107872" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107872">(Feb 21 2019 at 21:52)</a>:</h4>
<p>$get-doc ??</p>



<a name="159107909"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159107909" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159107909">(Feb 21 2019 at 21:53)</a>:</h4>
<p>Maybe is not a good name, but it had been there a long time and it is deployed in production already - why break things?</p>



<a name="159108032"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159108032" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159108032">(Feb 21 2019 at 21:54)</a>:</h4>
<p>Mostly I'm just trying to understand it; sometimes naming things helps :) It might not be worth renaming in real life.</p>



<a name="159108476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159108476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159108476">(Feb 21 2019 at 22:01)</a>:</h4>
<p>The way we implemented it is that we (1) generate the documents for the specified type(s) and period if we know how (2) fetch the existing document for the specified type and period (3) return the combination of (1) and (2)</p>



<a name="159111815"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159111815" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159111815">(Feb 21 2019 at 22:40)</a>:</h4>
<p>what I am confused at is... a DocumentReference resource is a metadata resource, it does not return the document. The client needs to invoke the URL in DocumentReference.content.attachment.url to get the bytes. <br>
What I expect is that DocumentReference.content.attachment.url will be equal to the $document operation. <br>
So, we have cascading operations... why?</p>



<a name="159112992"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159112992" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159112992">(Feb 21 2019 at 22:59)</a>:</h4>
<p>We preferred it that way to not have to mix the generated document vs documents that live in the system. When you query DocumentReference?Patient=1234 we only return documents that exist in the system (not the generated ones). Your point is valid. In our implementation you can skip the DocoumentReference by doing: Binary/$autogen-ccd-if?patient=1316035, but support the operation on Documentreference lets the consumer get the metadata about the document without actually generating the document.</p>



<a name="159120140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159120140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159120140">(Feb 22 2019 at 01:12)</a>:</h4>
<p>(We actually stick the document inside attachment.data so there is no second GET needed)</p>



<a name="159181647"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159181647" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Marquard <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159181647">(Feb 22 2019 at 18:57)</a>:</h4>
<p>Just finished reading this 65+ chain and I am little fuzzy on the conclusion:<br>
 A) Remove operation<br>
 B) Rename operation <code>$generate-or-retrieve-document</code><br>
 C) Be more clear about difference in expectations on search vs <code>$docref</code> operation</p>



<a name="159181738"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159181738" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159181738">(Feb 22 2019 at 18:58)</a>:</h4>
<p>I vote for C. Stuff is in production. Haven't had many complaints. Why rock the boat?</p>



<a name="159203973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159203973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159203973">(Feb 23 2019 at 00:26)</a>:</h4>
<p>C is not completely correct.  John correctly understood the fact that $docref was defined to return <strong>both</strong> on the fly and pre-exisiting docrefs.    IHE does this same thing using search.     As stated above  <em>the client doesn't give a hoot about the mechanics behind returning a docref</em> and should not be required to make two separate calls (i.e., a search and an operation ) each time.  So its seems the consensus is to keep $docref and therefore I think the choice should be:</p>
<p>d) go <strong>all in</strong> on $docref  for all searching  (sorry John)  since having both search and operation both confusing  and onerous for the client.   this means making all search on docref optional and removing from docref.</p>



<a name="159204171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159204171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159204171">(Feb 23 2019 at 00:31)</a>:</h4>
<p>If that  not acceptable then a) remove operation and supercharge the search as John suggests</p>



<a name="159284694"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159284694" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159284694">(Feb 24 2019 at 17:49)</a>:</h4>
<p>correct. I prefer ( a )... query is all that is needed. It will work against a basic FHIR server, where as forcing the operation means that everyone must add the operation... and there is no functional benefit to an operation.</p>



<a name="159336518"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159336518" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159336518">(Feb 25 2019 at 13:25)</a>:</h4>
<p>It is not a search - 'Search operations traverse through an _existing_ set of resources _filtering_ by parameters supplied to the search operation.'</p>



<a name="159336583"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159336583" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159336583">(Feb 25 2019 at 13:26)</a>:</h4>
<p>Besides that: it has been implemented, it works, implementers are OK with it - why change things?</p>



<a name="159343591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/159343591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#159343591">(Feb 25 2019 at 15:07)</a>:</h4>
<p>I am not forcing change, I am asking for clarity. I think you have expressed that in your case the operation will only return one ondemand document. That would be a fine clarification. In that case I can know that I will not get duplicates between the operation and a search. As long as I can understand this, I am good with the result. but I also don't think we should have an operation when one is not needed, as it forces clients to do two things.</p>



<a name="160580690"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160580690" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Marquard <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160580690">(Mar 12 2019 at 15:35)</a>:</h4>
<p>FYI - after long discussion Eric/I plan to propose deprecation of $docref on SD this Thursday</p>



<a name="160580825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160580825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160580825">(Mar 12 2019 at 15:36)</a>:</h4>
<p>In favor of IHE approach using search.  Deprecate means keep in for one more cycle before removing.</p>



<a name="160583781"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160583781" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160583781">(Mar 12 2019 at 16:11)</a>:</h4>
<p>You cannot use search to return document created on the fly: 'Search operations traverse through an _existing_ set of resources _filtering_ by parameters supplied to the search operation'</p>



<a name="160584692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160584692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160584692">(Mar 12 2019 at 16:23)</a>:</h4>
<p>We to distinguish something... the Query on DocumentReference can return DocumentReference items that indicate the ability to request that a document be created. If a client does a GET on the DocumentReference.content.attachment.url, that is when the document is created. Not at query time.  This is the model that has been in XDS/XCA/MHD for a long time.<br>
I recognize the distinction that some see the $docref as returning the DocumentReference and also the Document that was created during that operation.</p>



<a name="160584893"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160584893" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160584893">(Mar 12 2019 at 16:25)</a>:</h4>
<p>so, if we can clarify that distinction, then I will be happy.. Can we make clear that $docref is used to create an ondemand document, where the result is both the DocumentReference and the document ?   Specifically it would NOT return static entries, just the one requested to be created.</p>



<a name="160585291"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160585291" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160585291">(Mar 12 2019 at 16:29)</a>:</h4>
<p>Implementers seems to be happy with how things are - once again, why do you want to change things? Especially things that are already in production?</p>



<a name="160585390"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160585390" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160585390">(Mar 12 2019 at 16:30)</a>:</h4>
<p>I submitted ballot comment against the IG aligning with FHIR R4... not DSTU2... many things changed between DSTU2 and R4.</p>



<a name="160585519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160585519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160585519">(Mar 12 2019 at 16:31)</a>:</h4>
<p>That's not a reason to change even more things</p>



<a name="160585870"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160585870" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160585870">(Mar 12 2019 at 16:35)</a>:</h4>
<p>The comment points out that some servers are acting differently than other servers. I am just looking for everyone to implement the same behavior. Some return all results, some just one newly created document. Some return the document , some don't.. I am looking for deterministic behavior that a client app can rely on. I don't care what that behavior is. It just needs to be consistent, else we are not talking 'standards' we are talking custom code in client apps to deal with custom behavior by various servers.</p>



<a name="160586119"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160586119" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160586119">(Mar 12 2019 at 16:37)</a>:</h4>
<p>We are concerned about having 2 ways to do the same thing between IHE MHD and US Core.   We feel that these are two broadly implemented specs and see an opportunity to align.   After other feedback, we are considering limiting the scope of docref to CCD as a compromise and adding in the  IHE like search.  </p>
<p>Thinking aloud ....Or should we support both as an interim solution.   </p>
<p>RE John;'s concerns  the operation is clearly defined to return DocRef.  So that is not an issue with the specification..</p>



<a name="160586392"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160586392" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160586392">(Mar 12 2019 at 16:40)</a>:</h4>
<p>Add more explanation / examples to the specs - do not change them<br>
(and having said that - there will be always incompatible / wrong implementations - that's not something that can be solved just writing specs unfortunately)</p>



<a name="160586674"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160586674" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160586674">(Mar 12 2019 at 16:43)</a>:</h4>
<p>does $docref return only onDemand documents? or not?   It says SHOULD today, which is confusing. A client can't tell if it will get duplicate results or not. Can we make this a SHALL-NOT?</p>



<a name="160586759"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160586759" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160586759">(Mar 12 2019 at 16:43)</a>:</h4>
<p>does $docref return the DocumentReference and the Binary of the document? Seems there is strongest support for YES, both.</p>



<a name="160586877"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160586877" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160586877">(Mar 12 2019 at 16:44)</a>:</h4>
<p>does $docref return one entry, or a set of documents that meet the criteria? I think the strongest support is that the server determines THE best match, returning one entry that best matches, not all entries that are close.</p>



<a name="160587265"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587265" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587265">(Mar 12 2019 at 16:48)</a>:</h4>
<p>No, not only on demand: 'The server SHOULD return at least all references for documents that it has made available in a document indexing system. This is the same as a simple query '</p>



<a name="160587295"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587295" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587295">(Mar 12 2019 at 16:49)</a>:</h4>
<p>so then you want it to say SHALL</p>



<a name="160587322"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587322" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587322">(Mar 12 2019 at 16:49)</a>:</h4>
<p>That is clarity I can live with. I don't think it is right, but it is more clear.</p>



<a name="160587422"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587422" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587422">(Mar 12 2019 at 16:50)</a>:</h4>
<p>'This is the same as a simple query' is crystal clear to me</p>



<a name="160587434"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587434" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587434">(Mar 12 2019 at 16:50)</a>:</h4>
<p>SHOULD is not the same as SHALL</p>



<a name="160587495"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587495" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587495">(Mar 12 2019 at 16:51)</a>:</h4>
<p>SHOULD means to a client... you might get them, you might not.   You are looking at the spec from a server perspective. I am looking at the spec from a client.</p>



<a name="160587585"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587585" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587585">(Mar 12 2019 at 16:52)</a>:</h4>
<p>make it a SHALL... but I suspect that is going to make other server vendors upset... as they return only the onDemand entry.</p>



<a name="160587621"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587621" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587621">(Mar 12 2019 at 16:52)</a>:</h4>
<p>Again, they look clear to me - from both sides - and implementers seems to be ok</p>



<a name="160587663"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587663" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587663">(Mar 12 2019 at 16:53)</a>:</h4>
<p>Im an implementer... I am not ok with it... hence my ballot comment... the whole reason for standards governance</p>



<a name="160587786"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587786" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587786">(Mar 12 2019 at 16:54)</a>:</h4>
<p>OK - clarify it if you want - but do not _change_ it please</p>



<a name="160587863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160587863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160587863">(Mar 12 2019 at 16:55)</a>:</h4>
<p>I presented three decisions.. what is your company position? We can then poll all the EHR vendors and see if there is a consensus.</p>



<a name="160590880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160590880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160590880">(Mar 12 2019 at 17:30)</a>:</h4>
<p>The three options above? We'll do C) Be more clear about difference in expectations on search vs $docref operation</p>



<a name="160591113"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160591113" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brett Marquard <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160591113">(Mar 12 2019 at 17:33)</a>:</h4>
<p>reading through chain I am not crystal clear on 'option C)' Please re paste here</p>



<a name="160591957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160591957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160591957">(Mar 12 2019 at 17:42)</a>:</h4>
<p>Just finished reading this 65+ chain and I am little fuzzy on the conclusion:<br>
A) Remove operation<br>
B) Rename operation $generate-or-retrieve-document<br>
C) Be more clear about difference in expectations on search vs $docref operation</p>



<a name="160592007"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160592007" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Drew Torres <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160592007">(Mar 12 2019 at 17:42)</a>:</h4>
<p>I like C too.</p>



<a name="160598526"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160598526" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160598526">(Mar 12 2019 at 18:49)</a>:</h4>
<p>I don't know about what C means... I pointed out three things that I think are not clear in the current specification. I am okay with keeping $docref if it has a well defined behavior.  Note that I think renaming is helpful to clarity, but clarity is more important first.<br>
1. does $docref return only onDemand documents? or not? It says SHOULD today, which is confusing. A client can't tell if it will get duplicate results or not. Can we make this a SHALL-NOT?<br>
2. does $docref return the DocumentReference and the Binary of the document? Seems there is strongest support for YES, both.<br>
3. does $docref return one entry, or a set of documents that meet the criteria? I think the strongest support is that the server determines THE best match, returning one entry that best matches, not all entries that are close.</p>



<a name="160601035"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160601035" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160601035">(Mar 12 2019 at 19:19)</a>:</h4>
<p>mmmm when I read it I don't interpret any of that...seems pretty clear to me</p>
<blockquote>
<p>1. does $docref return only onDemand documents? or not? It says SHOULD today, which is confusing. A client can't tell if it will get duplicate results or not. Can we make this a SHALL-NOT?</p>
</blockquote>
<p>it SHOULD return <strong>DocumentReferences</strong> for both pre-indexed ( I agree SHALL would be better) and on demand : "a Bundle... containing resources conforming to the US Core DocumentReference Profile for the patient"      I don't understand the duplicate comment.</p>
<blockquote>
<p>2. does $docref return the DocumentReference and the Binary of the document? Seems there is strongest support for YES, both. </p>
</blockquote>
<p>NO each DocRef has a URL pointing to a document.  This is a 2 step process get the docref and then the document.  "The document itself can be subsequently retrieved using the link provided from the DocumentQuery search results. The link could,for example, be a FHIR endpoint to a Binary Resource or some other document repository."</p>
<blockquote>
<p>3. does $docref return one entry, or a set of documents that meet the criteria? I think the strongest support is that the server determines THE best match, returning one entry that best matches, not all entries that are close.</p>
</blockquote>
<p>"The operation takes the input parameters:</p>
<p>patient id<br>
start date<br>
end date<br>
document type<br>
and returns a Bundle off type “searchset” containing resources conforming to the US Core DocumentReference Profile for the patient. "<br>
" If neither a start date nor an end date is provided, the most recent or current document is in scope."<br>
" If no type is provided, the CCD document if available SHALL be in scope and all other document types MAY be in scope."</p>
<p>Specific behavior by a implementation should be documented in its CapStatement.</p>



<a name="160658681"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160658681" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160658681">(Mar 13 2019 at 12:34)</a>:</h4>
<p>2 - <span class="user-mention" data-user-id="191401">@Eric Haas</span> you are asserting the exact opposite of what <span class="user-mention" data-user-id="191912">@Michele Mottini</span> indicated earlier.</p>



<a name="160658718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160658718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160658718">(Mar 13 2019 at 12:34)</a>:</h4>
<blockquote>
<p>(We actually stick the document inside attachment.data so there is no second GET needed)</p>
</blockquote>
<p>see 2 inline</p>



<a name="160658735"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160658735" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160658735">(Mar 13 2019 at 12:35)</a>:</h4>
<p>thus, the specification is not clear. on 2</p>



<a name="160658966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/160658966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#160658966">(Mar 13 2019 at 12:39)</a>:</h4>
<blockquote>
<p>DocumentReference query cannot achieve the same result <code>$docref?start=x&amp;end=y</code> creates and returns a document with all the data for that period, that is not something a search can do</p>
</blockquote>
<p>note this is the strongest argument for keeping $docref, and having it do different things than a query. Totally agree with <span class="user-mention" data-user-id="191912">@Michele Mottini</span> . This is why I am NOT trying to eliminate, but rather to make clear THIS is the behavior.</p>



<a name="161184380"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/161184380" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#161184380">(Mar 19 2019 at 19:54)</a>:</h4>
<p>here my proposed edits:  <a href="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20066&amp;start=0" target="_blank" title="https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20066&amp;start=0">https://gforge.hl7.org/gf/project/fhir/tracker/?action=TrackerItemEdit&amp;tracker_item_id=20066&amp;start=0</a></p>



<a name="161344050"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20GF%2320066%20re%20the%20Fetch%20DocRef%20operation/near/161344050" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20GF.2320066.20re.20the.20Fetch.20DocRef.20operation.html#161344050">(Mar 21 2019 at 13:19)</a>:</h4>
<p>I think I understand your edit proposal, and it seems to address my concerns. I understand that $docref shall return all static results that match the paramaters of $docref while also returning dynamicly created entries for onDemand.  Thanks</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
