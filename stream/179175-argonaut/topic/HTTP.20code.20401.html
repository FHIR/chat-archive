---
layout: page
title: "FHIR Chat  · HTTP code 401 · argonaut"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/index.html">argonaut</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html">HTTP code 401</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="189256692"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189256692" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189256692">(Feb 27 2020 at 21:03)</a>:</h4>
<p><a href="https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.html#behavior" target="_blank" title="https://www.hl7.org/fhir/us/core/CapabilityStatement-us-core-server.html#behavior">US Core 7.1.1.1</a>. The first section says </p>
<blockquote>
<p>...Return the following response classes: ...(Status 401/4xx): unauthorized request.</p>
</blockquote>
<p>The following security says </p>
<blockquote>
<p>A server SHALL reject any unauthorized requests by returning an HTTP 401 unauthorized response code.</p>
</blockquote>
<p>So what does 4xx codes mean where it first mentioned? And second question, if server returns 4xx for unauthorized request, is it valid or not?<br>
<span class="user-mention" data-user-id="191401">@Eric Haas</span> <span class="user-mention" data-user-id="191410">@Brett Marquard</span></p>



<a name="189257657"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189257657" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189257657">(Feb 27 2020 at 21:12)</a>:</h4>
<p>can you make a tracker.  should only be 401</p>



<a name="189261894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189261894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189261894">(Feb 27 2020 at 22:00)</a>:</h4>
<p>You should NOT force 401. See <a href="http://build.fhir.org/security.html#AccessDenied" target="_blank" title="http://build.fhir.org/security.html#AccessDenied">http://build.fhir.org/security.html#AccessDenied</a></p>



<a name="189261966"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189261966" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189261966">(Feb 27 2020 at 22:01)</a>:</h4>
<p>by forcing 401 you enable an attacker to determine what exists vs what does not exist.  Servers should have the ability to implement policy on what they do with access control failures</p>



<a name="189265373"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189265373" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189265373">(Feb 27 2020 at 22:41)</a>:</h4>
<blockquote>
<p>by forcing 401 you enable an attacker to determine what exists </p>
</blockquote>
<p>I'm not arguing we should specify any more than we already have -- but if we <em>did</em> require the use of <code>401</code> for requests that lacked an <code>Authorization</code> header this would <em>not</em> enable an attacker to determine what exists vs what does not exist. The <code>401</code> would be used for all paths if an access token was omitted (based on the request, not based on what data existed in a server).</p>



<a name="189265550"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189265550" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189265550">(Feb 27 2020 at 22:43)</a>:</h4>
<p>I didn't understand it was specific to that exchange only. as you can imagine I get many people going from one specific to a general rule too quickly without considering the ramifications.</p>



<a name="189270617"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189270617" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189270617">(Feb 27 2020 at 23:56)</a>:</h4>
<p>There are three scenarios: 1) the client sends request with valid token, 2) the client sends request with invalid token, 3) the client sends request without a token. Both case 2) and 3) shall end with Access Denied. My question is what is the correct response code for these two situation. I used to think 401 SHALL be the correct code for both 2) and 3) till I recently found some servers send 400.  So I started to look around but could not find any concrete answer.</p>



<a name="189270986"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189270986" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189270986">(Feb 28 2020 at 00:02)</a>:</h4>
<p><span class="user-mention" data-user-id="191404">@John Moehrke</span> I looked at <a href="http://build.fhir.org/security.html#AccessDenied" target="_blank" title="http://build.fhir.org/security.html#AccessDenied">http://build.fhir.org/security.html#AccessDenied</a>. My understanding for that section is that the code SHALL be 401 "This communicates that user authentication was attempted and failed to be authenticated."<br>
And what does this mean "by forcing 401 you enable an attacker to determine what exists vs what does not exist"?<br>
Thanks</p>



<a name="189309542"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189309542" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189309542">(Feb 28 2020 at 13:34)</a>:</h4>
<p>to explain that, let me ask what you would return if the request situation was the same, but there was no data that matched the query parameters? Most will answer that should either be 200 that is empty, or a 404 not found. Well now I can tell if there is data that exists (does match my query parameter) but for which I don't have access rights to.  I don't need access rights, I will just probe around with these query parameters until I can tell what the data is NOT, which tells me what the data is.</p>



<a name="189309634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189309634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189309634">(Feb 28 2020 at 13:35)</a>:</h4>
<p>so, the recommendation from many security professionals, we just quote them on the FHIR core security page, is that policy should choose what to return. When the data are very sensitive it can be best to return 200 with an empty bundle.</p>



<a name="189310702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189310702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189310702">(Feb 28 2020 at 13:48)</a>:</h4>
<p>There are cases, like what Josh indicated, where a specific error code is not going to lead to exposing data. Josh case is where a token is completely missing.</p>



<a name="189310942"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189310942" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> John Moehrke <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189310942">(Feb 28 2020 at 13:50)</a>:</h4>
<p>I am not against having recommended codes for access control failure. What I am against is SHALL language. The reason I am against that is that it forbids a service from imposing policy. It can also lead a client to believe that that error code is the only failure-mode, and thus the client is fragile to servers imposing a different policy. -- so what I am asking for is to recognize that hackers are creative, and the data you are protecting is valuable.  Think about Security Considerations, not just happy path.</p>



<a name="189339827"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189339827" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189339827">(Feb 28 2020 at 18:58)</a>:</h4>
<p>The OAuth 2 specification actually defines a lot about the errors: <a href="https://tools.ietf.org/html/rfc6750#section-3.1" target="_blank" title="https://tools.ietf.org/html/rfc6750#section-3.1">https://tools.ietf.org/html/rfc6750#section-3.1</a></p>



<a name="189339849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189339849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189339849">(Feb 28 2020 at 18:58)</a>:</h4>
<p>(this is the bearer token extension, which is the type of token SMART uses)</p>



<a name="189340153"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189340153" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189340153">(Feb 28 2020 at 19:01)</a>:</h4>
<p>So 400, 401, 403 specifically called out for different types of errors</p>



<a name="189340223"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189340223" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jenni Syed <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189340223">(Feb 28 2020 at 19:02)</a>:</h4>
<p>And if they're nice, hopefully the error code as well :)</p>



<a name="189531098"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/HTTP%20code%20401/near/189531098" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/HTTP.20code.20401.html#189531098">(Mar 02 2020 at 20:09)</a>:</h4>
<p>Yeah, we talked through these -- but looked like only the header details are defined at a "SHALL" (MUST) level, and specific response codes were "SHOULD"s.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
