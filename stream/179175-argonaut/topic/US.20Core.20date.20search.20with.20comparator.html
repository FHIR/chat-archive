---
layout: page
title: "FHIR Chat  · US Core date search with comparator · argonaut"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/index.html">argonaut</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html">US Core date search with comparator</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="248668671"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248668671" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248668671">(Aug 06 2021 at 21:07)</a>:</h4>
<p>Inferno received a question from a server implementer about the comparators in <a href="http://Procedure.date">Procedure.date</a> search.<br>
The FHIR <a href="https://www.hl7.org/fhir/search.html#prefix">seach page</a> says that</p>
<div class="codehilite"><pre><span></span><code>a prefix to the parameter value may be used to control the nature of the matching ... If no prefix is present, the prefix eq is assumed.
</code></pre></div>
<p>US Core 3.1.1 <a href="https://www.hl7.org/fhir/us/core/STU3/SearchParameter-us-core-procedure-date.html">Procedure.date search parameter</a> has (</p>
<div class="codehilite"><pre><span></span><code>comparator : eq ( Conformance Expectation = MAY)
</code></pre></div>
<p>So the server reject request like <code>/Procedure?date=2021&amp;patient=1</code> based on the reason that without comparator mean <code>eq</code> and <code>eq</code> comparator is not required<br>
Is that the correct interpretation?<br>
<span class="user-mention" data-user-id="191401">@Eric Haas</span></p>



<a name="248680144"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248680144" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248680144">(Aug 06 2021 at 23:28)</a>:</h4>
<p>???  I don't understand.  MAY means the server may support the comparator <code>eq</code>:</p>
<ol>
<li>if it does you can elect to use it or not it doesn't change the search outcome.  </li>
<li>if it does not  you can elect to use it and the server won't know what to do with it.</li>
</ol>



<a name="248680394"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248680394" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248680394">(Aug 06 2021 at 23:33)</a>:</h4>
<p>Also US Core is effectively silent on the MAYs, we are defining the SP for the sake of the CapabilityStatements.</p>



<a name="248686267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248686267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248686267">(Aug 07 2021 at 01:10)</a>:</h4>
<p>The question is on the date search with comparator. From this</p>
<div class="codehilite"><pre><span></span><code>GET [base]/Procedure?patient={Type/}[id]&amp;date={gt|lt|ge|le}[date]{&amp;date={gt|lt|ge|le}[date]&amp;...}
</code></pre></div>
<p>A server shall support searching by date without comparator <code>GET [base]/Procedure?patient=[id]&amp;date=[date]</code></p>
<p>If a server interpret "MAY support date search with<code>eq</code> comparator" as "MAY support date search without comparator", then a server can reject any date search without comparator.</p>



<a name="248695443"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248695443" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248695443">(Aug 07 2021 at 04:28)</a>:</h4>
<p>I don't understand the logic here,  we are laying down the minimum requirements, servers can layer additional stuff on it but that does not obviate these requirements.</p>



<a name="248722006"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248722006" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248722006">(Aug 07 2021 at 15:41)</a>:</h4>
<p>Let me ask in another way. Per <a href="http://hl7.org/fhir/us/core/STU3.1.1/StructureDefinition-us-core-procedure.html#quick-start">US Core v3.1.10 Procedure profile</a>, is server required to implement this search <code>GET [base]/Procedure?patient=[id]&amp;date=[date]</code>?</p>



<a name="248723165"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248723165" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248723165">(Aug 07 2021 at 16:07)</a>:</h4>
<p>Per</p>
<blockquote>
<p>SHALL support searching using the combination of the patient and date search parameters:</p>
</blockquote>
<p>?! This seems clear. Yunwei, can you spell out your logic/question step by step?</p>



<a name="248723274"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248723274" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248723274">(Aug 07 2021 at 16:09)</a>:</h4>
<p>Is the question whether a server needs to support state searches with no comparator? The answer seems to be a pretty obvious yes to me, since that's the default kind of data search and date searches required.</p>



<a name="248723405"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248723405" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248723405">(Aug 07 2021 at 16:12)</a>:</h4>
<p>(I will say the phrase "SHALL support searching using the combination of the patient and date search parameters<br>
....including optional support for composite AND search on date" is problematic for me:. First, fhire has something different called composite search, and while this uses the word composite I don't think it's talking about fhir composite searches  it is just talking about repeating a search parameter. Second, I don't know what the word optional means here, within the context of a SHALL. Is this like saying MAY?)</p>



<a name="248742414"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248742414" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248742414">(Aug 08 2021 at 00:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator/near/248723405">said</a>:</p>
<blockquote>
<p>(I will say the phrase "SHALL support searching using the combination of the patient and date search parameters<br>
....including optional support for composite AND search on date" is problematic for me:. First, fhire has something different called composite search, and while this uses the word composite I don't think it's talking about fhir composite searches  it is just talking about repeating a search parameter. Second, I don't know what the word optional means here, within the context of a SHALL. Is this like saying MAY?)</p>
</blockquote>
<p>This is what is says in the Quick start:</p>
<p><a href="/user_uploads/10155/9NhWT4fVdxYqEZaQ8Kwu-ddh/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/9NhWT4fVdxYqEZaQ8Kwu-ddh/image.png" title="image.png"><img src="/user_uploads/10155/9NhWT4fVdxYqEZaQ8Kwu-ddh/image.png"></a></div><p>source: <a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-procedure.html#mandatory-search-parameters">https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-procedure.html#mandatory-search-parameters</a></p>
<p>source: <a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-procedure.html#mandatory-search-parameters">https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-procedure.html#mandatory-search-parameters</a></p>



<a name="248744044"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248744044" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248744044">(Aug 08 2021 at 00:48)</a>:</h4>
<p>(Yes the image you included is a snapshot of the same text that I quoted. I'm saying the text is problematic for me because it puts an "optional" requirement directly within the body of a SHALL requirement in a section with the word "mandatory" in the name. Optional for whom, and how is it different from a "MAY")</p>



<a name="248747019"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248747019" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248747019">(Aug 08 2021 at 02:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator/near/248723274">said</a>:</p>
<blockquote>
<p>Is the question whether a server needs to support state searches with no comparator? The answer seems to be a pretty obvious yes to me, since that's the default kind of data search and date searches required.</p>
</blockquote>
<p>That is my interpretation too but I was different one in a practice. Thanks to confirm my thought.</p>



<a name="248747169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248747169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248747169">(Aug 08 2021 at 02:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator/near/248744044">said</a>:</p>
<blockquote>
<p>(Yes the image you included is a snapshot of the same text that I quoted. I'm saying the text is problematic for me because it puts an "optional" requirement directly within the body of a SHALL requirement in a section with the word "mandatory" in the name. Optional for whom, and how is it different from a "MAY")</p>
</blockquote>
<p>My reading is server SHALL do A and MAY do B as addition. I don't see a problem for that.</p>



<a name="248752301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248752301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248752301">(Aug 08 2021 at 04:36)</a>:</h4>
<p>(I just find "SHALL support... optional composite" to be confusing. I don't think it's a problematic requirement if it just means "MAY support repeated date parameters".)</p>



<a name="248836043"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248836043" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248836043">(Aug 09 2021 at 12:08)</a>:</h4>
<blockquote>
<p>A server shall support searching by date without comparator</p>
</blockquote>
<p><span class="user-mention" data-user-id="191506">@Yunwei Wang</span> Where are you seeing this?</p>



<a name="248842371"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248842371" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248842371">(Aug 09 2021 at 13:04)</a>:</h4>
<p><span class="user-mention" data-user-id="225612">@Stephen MacVicar</span> </p>
<p>From <code>GET [base]/Procedure?patient={Type/}[id]&amp;date={gt|lt|ge|le}[date]{&amp;date={gt|lt|ge|le}[date]&amp;...}</code>.   <br>
Variables surrounded by “{}” are optional for the client to supply<br>
removing all {...}, you get the base form: <code>GET [base]/Procedure?patient=[id]&amp;date=[date]</code></p>



<a name="248843504"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248843504" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248843504">(Aug 09 2021 at 13:11)</a>:</h4>
<p>Then it seems like an error that support for <code>eq</code> is a MAY rather than a SHALL.</p>



<a name="248869365"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248869365" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248869365">(Aug 09 2021 at 16:09)</a>:</h4>
<p><span class="user-mention" data-user-id="225612">@Stephen MacVicar</span>   it is not an error, that is intentional, the pattern is to define the SHALL and SHOULDS and everything else defaults to MAY.   Why do you think it was an error?</p>



<a name="248869682"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248869682" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248869682">(Aug 09 2021 at 16:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191315">@Josh Mandel</span>   I left mid thought above ....  I think you may have a valid point but let me dust off the reasoning (or lack of it  ) when creating the text templates for this section...</p>



<a name="248871090"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248871090" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248871090">(Aug 09 2021 at 16:20)</a>:</h4>
<p>First  the use of the term 'composite'  is overloaded.  We try to be consistent with the language used in the base FHIR spec and this term the the concept of 'joining single values with a $' comes from here: </p>
<p><a href="http://build.fhir.org/search.html#combining">http://build.fhir.org/search.html#combining</a></p>
<p>and is defined using the <code>SearchParamenter.multipleAnd</code> parameter.  This is the intent of its use in the guidance quoted above.</p>
<p>As you state is can also refer to a  type of search parameter  that take sequences of single values that match other defined parameters as an argument.</p>



<a name="248871725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248871725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248871725">(Aug 09 2021 at 16:25)</a>:</h4>
<p>If servers have to support date search without a prefix, but supporting <code>eq</code> is a MAY, that means that servers have to support the <code>eq</code> functionality when no prefix is sent, but don't have to support it when the <code>eq</code> prefix actually is sent.</p>



<a name="248871894"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248871894" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248871894">(Aug 09 2021 at 16:26)</a>:</h4>
<p><span class="user-mention" data-user-id="225612">@Stephen MacVicar</span>    that is correct</p>



<a name="248872994"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248872994" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248872994">(Aug 09 2021 at 16:35)</a>:</h4>
<p>multipleAnd conformance expectation on <code>date</code> is a  SHOULD and hence why shows up as an optional in the text.   SHOULDs are not enforceable and the same as a MAY from a testing perspective.  ( Just like <em>example</em> and <em>preferred</em> bindings are functionally the same)  But we felt it necessary to call it out.   @Josh do you have any suggestion how to rephrase it in the template to make it Clearer noting that there are SHALL and SHOULD sections and we don't want the same Search Parameter in both sections.</p>



<a name="248873836"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248873836" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248873836">(Aug 09 2021 at 16:41)</a>:</h4>
<p>Is this an improvement? </p>
<h3>Mandatory Search Parameters:</h3>
<p>The following search parameters and search parameter combinations SHALL be supported:</p>
<p><strong>SHALL</strong> support searching for all procedures for a patient using the patient search parameter:</p>
<p><code>GET [base]/Procedure?patient={Type/}[id]</code></p>
<p>Example:</p>
<p><code>GET [base]/Procedure?patient=1291938</code><br>
Implementation Notes: Fetches a bundle of all Procedure resources for the specified patient (how to search by reference)</p>
<p><strong>SHALL</strong> support searching using the combination of the patient and date search parameters:</p>
<ul>
<li>including support for these date comparators: <code>gt,lt,ge,le</code></li>
<li><del>including optional support for composite AND search on date</del> (e.g.<code>date=[date]&amp;date=[date]]&amp;..</code>.)<br>
<code>GET [base]/Procedure?patient={Type/}[id]&amp;date={gt|lt|ge|le}[date]{&amp;date={gt|lt|ge|le}[date]&amp;..</code>.}</li>
</ul>
<p><strong>CHANGE TO:</strong></p>
<ul>
<li>Note: support for composite AND search on date is recommended... </li>
</ul>
<p>...</p>



<a name="248874237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248874237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248874237">(Aug 09 2021 at 16:44)</a>:</h4>
<p>If support for date searches without a prefix is a requirement (which I think is a good idea), it should be stated more explicitly in the spec. I think it's too easy to look at the search parameter details, see <code>eq</code> as a MAY, and come to the conclusion that only date searches with the SHALL comparators need to be supported.</p>
<p>It could be the case that this is a base FHIR requirement, in which case that would be an appropriate place to address this, as the language there is also not very clear.</p>



<a name="248874345"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248874345" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248874345">(Aug 09 2021 at 16:45)</a>:</h4>
<p><span class="user-mention" data-user-id="225612">@Stephen MacVicar</span>  feel free to make a change request,  I would recommend it be conformance expectation of SHOULD  search requirements including modifiers need consensus from the community.</p>



<a name="248874947"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248874947" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248874947">(Aug 09 2021 at 16:50)</a>:</h4>
<p><span class="user-mention" data-user-id="225612">@Stephen MacVicar</span>  I agree this is assumed from the base FHIR requirements and that additional guidance would be helpful.</p>



<a name="248875685"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248875685" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248875685">(Aug 09 2021 at 16:57)</a>:</h4>
<p>I'll start a thread in implementers later today</p>



<a name="248876025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248876025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248876025">(Aug 09 2021 at 16:59)</a>:</h4>
<p>The discussion will get much more attention as a US Core  tracker,  I recommend making the tracker first and we can discuss as part of next US Core release.</p>



<a name="248880247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248880247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Stephen MacVicar <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248880247">(Aug 09 2021 at 17:27)</a>:</h4>
<p>Tracker item: <a href="https://jira.hl7.org/browse/FHIR-33156">https://jira.hl7.org/browse/FHIR-33156</a></p>



<a name="248882867"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248882867" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248882867">(Aug 09 2021 at 17:47)</a>:</h4>
<blockquote>
<p>support for composite AND search on date is recommended</p>
</blockquote>
<p>This term "composite" is still throwing me off. Do we mean <code>multipleAnd</code> (i.e., repeating the <code>date</code> param to specify an intersection)?</p>



<a name="248882973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248882973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248882973">(Aug 09 2021 at 17:48)</a>:</h4>
<p>And why "recommended" for this, but "SHOULD" for the requirements above? What is the distinction between "recommended" vs "SHOULD"?</p>



<a name="248884777"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248884777" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248884777">(Aug 09 2021 at 18:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator/near/248882867">said</a>:</p>
<blockquote>
<blockquote>
<p>support for composite AND search on date is recommended</p>
</blockquote>
<p>This term "composite" is still throwing me off. Do we mean <code>multipleAnd</code> (i.e., repeating the <code>date</code> param to specify an intersection)?</p>
</blockquote>
<p>as  I explained above,  this term is overloaded in the FHIR specification,  we use the first way is it defined as referenced above.  What do you suggest?</p>



<a name="248885343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248885343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248885343">(Aug 09 2021 at 18:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator/near/248882973">said</a>:</p>
<blockquote>
<p>And why "recommended" for this, but "SHOULD" for the requirements above? What is the distinction between "recommended" vs "SHOULD"?</p>
</blockquote>
<p>We try to avoid Nesting  conformance verbs (a <strong>SHOULD</strong> under  a  <strong>SHALL</strong>) to be clear and avoid confusion.    We think that is even more confusing than providing additional guidance in more informal language.</p>



<a name="248891149"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248891149" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248891149">(Aug 09 2021 at 18:53)</a>:</h4>
<blockquote>
<p>["composite"] is overloaded in the FHIR specification,  we use the first way is it defined as referenced above.  What do you suggest?</p>
</blockquote>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span> I don't see any overloading -- <a href="http://build.fhir.org/search.html#combining">http://build.fhir.org/search.html#combining</a> defines three distinct concepts:</p>
<ul>
<li>"<em>AND search parameter</em>" -- e.g., <code>Patient?language=FR&amp;language=NL</code> for French/Dutch bilingual patients</li>
<li>"<em>OR search parameter</em>" -- e.g., <code>Patient?language=FR,NL</code> for patients who speak at least one of French or Dutch</li>
<li>"<em>Composite search parameter</em>" -- e.g., <code>Group?characteristic-value=gender$mixed</code> for Groups with a single characteristic that means "gender: mixed" (rather than, say, one characteristic meaning "gender: male" and another meaning "preferred Chex cereal format: mixed", which you might inadvertently match with a non-composite query like<code>Group?characteristic=gender&amp;value=mixed</code>).</li>
</ul>
<p><em>(Edit: I do see why it's confusing that all three are introduced in a section called "Composite Search Parameters")</em></p>



<a name="248892232"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248892232" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248892232">(Aug 09 2021 at 19:01)</a>:</h4>
<p>"Composite search parameter" is defined as: </p>
<blockquote>
<p>Composite search parameters support joining single values with a $. For example, the result of the search operation is the intersection of the resources that match the criteria specified by each individual search parameter.</p>
</blockquote>



<a name="248892890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248892890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248892890">(Aug 09 2021 at 19:06)</a>:</h4>
<p>My point is however, we consciously tried to use the same language as in the base specification, any confusion here reflects lack of clarity in the FHIR standard.  We can change it to make it clearer in both places</p>



<a name="248894420"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248894420" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248894420">(Aug 09 2021 at 19:18)</a>:</h4>
<p>Composite is defined as joining with "$". Which isn't something we're doing with dates. Agreed that the core spec clarity can be improved, but I don't see any definitional issue.</p>



<a name="248900997"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248900997" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248900997">(Aug 09 2021 at 20:08)</a>:</h4>
<blockquote>
<p>Composite is defined as joining with "$". Which isn't something we're doing with dates. </p>
</blockquote>
<p>To be clear we are recommending doing this with dates     Get /Condition?_id=123&amp;<strong>date=ge2020&amp;date=le2021</strong></p>



<a name="248909767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248909767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248909767">(Aug 09 2021 at 21:20)</a>:</h4>
<p>I'm just saying we're <em>not</em> talking about using any FHIR search params whose <a href="http://hl7.org/fhir/searchparameter-definitions.html#SearchParameter.type"><code>SearchParameter.type</code></a> is <code>composite</code>.</p>
<p>Re: what we <em>do</em> need... what are the use cases we care about? I think asking for <code>onset-date=2020</code> or <code>onset-date=eq2020</code> today would find any Conditions with an onset in 2020, so we wouldn't <em>need</em> to repeat params (like <code>onset-date=ge2020&amp;onset-date=le2021</code>) just for this.</p>
<ul>
<li>
<p>Where you could get "something new" would be to express things like "Conditions diagnosed in 2018 or 2020" (this is not a compelling use case though).</p>
</li>
<li>
<p>There's a bug in the example using "date" instead of "onset-date"; filed <a href="http://jira.hl7.org/browse/FHIR-33157">FHIR-33157</a></p>
</li>
</ul>



<a name="248916336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248916336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248916336">(Aug 09 2021 at 22:20)</a>:</h4>
<p>re : </p>
<blockquote>
<p>There's a bug in the example using "date" instead of "onset-date"; filed <a href="http://jira.hl7.org/browse/FHIR-33157">FHIR-33157</a></p>
</blockquote>
<p>I just threw that example together here to illustrate</p>
<p>is not a bug in the spec:</p>
<p><a href="/user_uploads/10155/JB3gdYGpgT7jV9tOH7mekJgQ/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/JB3gdYGpgT7jV9tOH7mekJgQ/image.png" title="image.png"><img src="/user_uploads/10155/JB3gdYGpgT7jV9tOH7mekJgQ/image.png"></a></div>



<a name="248916591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248916591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248916591">(Aug 09 2021 at 22:23)</a>:</h4>
<blockquote>
<p>what we do need... what are the use cases we care about?</p>
</blockquote>
<p>... that is what we spent the last several years doing.... I don't think that is the issue here</p>



<a name="248917292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248917292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248917292">(Aug 09 2021 at 22:28)</a>:</h4>
<p>I still assert that he term "composite" is not limited to a type of search parameter as defined by FHIR, but that is also tangential.   Will consider a tracker to make the intent clearer and avoid the ambiguous FHIR jargon.</p>



<a name="248919174"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248919174" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248919174">(Aug 09 2021 at 22:49)</a>:</h4>
<blockquote>
<p>is not a bug in the spec</p>
</blockquote>
<p><span class="user-mention" data-user-id="191401">@Eric Haas</span>  screenshot includes the bug (at the very bottom, after a couple of valid examples):</p>
<p><a href="/user_uploads/10155/Zks9293k_OHAny-F6iTLS6lS/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/10155/Zks9293k_OHAny-F6iTLS6lS/image.png" title="image.png"><img src="/user_uploads/10155/Zks9293k_OHAny-F6iTLS6lS/image.png"></a></div><p>See where the current IG says <code>date</code> instead of <code>onset-date</code>? Or am I just confused?</p>



<a name="248920171"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248920171" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248920171">(Aug 09 2021 at 23:00)</a>:</h4>
<blockquote>
<blockquote>
<p>what we do need... what are the use cases we care about?<br>
... that is what we spent the last several years doing.... I don't think that is the issue here</p>
</blockquote>
</blockquote>
<p>Sure, I'm not asking to relitigate any decisions. I'm just trying to understand what is the use case for repeated "date" parameters? (I think it's fine to call out as an optional thing servers can choose to support; I'm just genuinely curious about why we are calling it out.)</p>
<blockquote>
<p>Eric Haas: I still assert that he term "composite" is not limited to a type of search parameter as defined by FHIR, but that is also tangential. Will consider a tracker to make the intent clearer and avoid the ambiguous FHIR jargon.</p>
</blockquote>
<p>Sounds good, submitted <a href="http://jira.hl7.org/browse/FHIR-33159">FHIR-33159</a> for this (and <a href="http://jira.hl7.org/browse/FHIR-33159">FHIR-33159</a> to clarify the underlying FHIR spec)</p>



<a name="248930903"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248930903" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248930903">(Aug 10 2021 at 01:36)</a>:</h4>
<ol>
<li>yeah its a bug.... I did not read it to the end.</li>
<li>the intent of supporting ANDs is so the date query get a specific period of time in the past.</li>
</ol>



<a name="248930954"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248930954" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248930954">(Aug 10 2021 at 01:37)</a>:</h4>
<p>It is indeed more of a "nice to have" feature and thus is a SHOULD vs SHALL.</p>



<a name="248932375"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179175-argonaut/topic/US%20Core%20date%20search%20with%20comparator/near/248932375" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179175-argonaut/topic/US.20Core.20date.20search.20with.20comparator.html#248932375">(Aug 10 2021 at 02:03)</a>:</h4>
<p>Cool. FWIW i don't think ANDs really <em>do</em> help date queries get a specific time in the past. Anything you might say by "AND"ing two dates (assuming some nonzero overlap) is going to be identical to using just one input (whichever is narrowest).</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
