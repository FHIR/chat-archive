---
layout: page
title: "FHIR Chat  · R4 MolecularSequence composite search params · genomics"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/index.html">genomics</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html">R4 MolecularSequence composite search params</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154018715"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154018715" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154018715">(Nov 15 2018 at 08:31)</a>:</h4>
<p>Hi,</p>
<p>I'm looking at <code>MolecularSequence</code> composite search parameters i.e. <code>referenceseqid-coordinate</code> and <code>chromosome-coordinate</code>. Taking an example for <code>chromosome-coordinate</code> (excerpt only):</p>
<div class="codehilite"><pre><span></span>        &lt;code value=&quot;chromosome-coordinate&quot;/&gt;
        &lt;base value=&quot;MolecularSequence&quot;/&gt;
        &lt;type value=&quot;composite&quot;/&gt;
        &lt;expression value=&quot;MolecularSequence&quot;/&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome&quot;/&gt;
          &lt;expression value=&quot;referenceSeq.chromosome&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-start&quot;/&gt;
          &lt;expression value=&quot;variant.start&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-end&quot;/&gt;
          &lt;expression value=&quot;variant.end&quot;/&gt;
        &lt;/component&gt;
</pre></div>


<p>Since <code>MolecularSequence.variant</code>'s cardinality allows it to appear more than once in the resource, I would think the aforementioned search parameter will allow the following search <code>[baseurl]/MolecularSequence?chromosome-coordinate=X$0$3</code> to match the resource below:</p>
<div class="codehilite"><pre><span></span>MolecularSequence:
  referenceSeq:
    chromosome:
      system: whatever-system
      code: X
  variant:
    start: 0
    end: 1
  variant:
    start: 2
    end: 3
</pre></div>


<p>i.e. start:0 is in the first <code>variant</code> property while end:3 is in the second <code>variant</code> property.</p>
<p>Is that the expected behavior or is my understanding of composite search parameters incorrect?</p>



<a name="154018718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154018718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154018718">(Nov 15 2018 at 08:40)</a>:</h4>
<p>My assumption for this search parameter is that it would not match the resource above but would match this one instead (i.e. start:0 and end:3 are within the same variant property):</p>
<div class="codehilite"><pre><span></span>MolecularSequence:
  referenceSeq:
    chromosome:
      system: whatever-system
      code: X
  variant:
    start: 0
    end: 3
  variant:
    start: 5
    end: 6
</pre></div>



<a name="154018863"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154018863" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154018863">(Nov 15 2018 at 15:15)</a>:</h4>
<p>I agree with your assessment.  You can do range searches on start/end if needed.</p>



<a name="154019025"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019025" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019025">(Nov 16 2018 at 02:37)</a>:</h4>
<p>Sorry I'm still confused. What's the expected behavior of this search parameter? Is it expected to match the first example or the second one?</p>
<p>If the second example, then I would think the search parameter definition needs to be changed to:</p>
<div class="codehilite"><pre><span></span>        &lt;code value=&quot;chromosome-coordinate&quot;/&gt;
        &lt;base value=&quot;MolecularSequence&quot;/&gt;
        &lt;type value=&quot;composite&quot;/&gt;
        &lt;expression value=&quot;MolecularSequence.variant&quot;/&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome&quot;/&gt;
          &lt;expression value=&quot;%resource.referenceSeq.chromosome&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-start&quot;/&gt;
          &lt;expression value=&quot;start&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-end&quot;/&gt;
          &lt;expression value=&quot;end&quot;/&gt;
        &lt;/component&gt;
</pre></div>


<p>i.e. which is what this definition was in STU3.</p>



<a name="154019026"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019026" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019026">(Nov 16 2018 at 03:05)</a>:</h4>
<p>When I said I agree with your assessment, the intention is to match when a variant instance matches both the start and end criteria. I do remember that when I was adding the second composite search param, I was getting some build issues. I need to do some research into how to structure this search param.</p>



<a name="154019301"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019301" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019301">(Nov 16 2018 at 22:34)</a>:</h4>
<p>I have created a pull request with a fix, and have asked if it is possible to get the fix merged in.  While looking at the fix, I have made some additional changes as well. <br>
See the pull request <a href="https://github.com/HL7/fhir/pull/286" target="_blank" title="https://github.com/HL7/fhir/pull/286">286</a><br>
I created some new search params, and tried to make it clear how to search for sequences for given "windows", and also for sequences with variants at given locations.  I welcome comments/questions/concerns.<br>
<span class="user-mention" data-user-id="191451">@Patrick Werner</span> <span class="user-mention" data-user-id="196553">@James Jones</span> <span class="user-mention" data-user-id="191916">@ Bob Milius</span> <span class="user-mention" data-user-id="191719">@Gil Alterovitz</span> <span class="user-mention" data-user-id="193952">@Michael Calderero</span></p>



<a name="154019802"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019802" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jamie Jones <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019802">(Nov 20 2018 at 14:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191913">@Kevin Power</span> The changes look right and good to me from how I understand the composite searches <span class="emoji emoji-1f44d" title="thumbs up">:thumbs_up:</span></p>



<a name="154019803"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019803" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019803">(Nov 20 2018 at 14:58)</a>:</h4>
<p>Many thanks <span class="user-mention" data-user-id="196553">@James Jones</span></p>



<a name="154019805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrick Werner <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019805">(Nov 20 2018 at 15:01)</a>:</h4>
<p>looks good to me as well. I'm currently trying to get the Resources into hapi to be able to test it</p>



<a name="154019810"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154019810" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154019810">(Nov 20 2018 at 15:18)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191451">@Patrick Werner</span> - Keep us updated on your progress with HAPI.</p>



<a name="154020831"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154020831" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154020831">(Nov 26 2018 at 12:38)</a>:</h4>
<p>FYI - Grahame merged the MolecularSequence search param changes. If anyone reviews the changes and has questions please respond here. <span class="user-mention" data-user-id="193952">@Michael Calderero</span></p>



<a name="154020987"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154020987" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154020987">(Nov 27 2018 at 06:42)</a>:</h4>
<p>I checked the updated definitions from <a href="http://build.fhir.org" target="_blank" title="http://build.fhir.org">build.fhir.org</a> and I see the following:</p>
<p>1. <a href="http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome-window-coordinate" target="_blank" title="http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome-window-coordinate">http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome-window-coordinate</a> composite</p>
<div class="codehilite"><pre><span></span>        &lt;expression value=&quot;MolecularSequence.referenceSeq&quot;/&gt;
        &lt;xpathUsage value=&quot;normal&quot;/&gt;
        &lt;multipleOr value=&quot;false&quot;/&gt;
        &lt;multipleAnd value=&quot;true&quot;/&gt;
        &lt;modifier value=&quot;missing&quot;/&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-chromosome&quot;/&gt;
          &lt;expression value=&quot;chromosome&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-window-start&quot;/&gt;
          &lt;expression value=&quot;start&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-window-end&quot;/&gt;
          &lt;expression value=&quot;end&quot;/&gt;
        &lt;/component&gt;
</pre></div>


<p>but MolecularSequence.referenceSeq doesn't have <code>start</code> and <code>end</code> properties. Perhaps the <code>windowStart</code> and <code>windowEnd</code> should have been used instead?</p>
<p>2. <a href="http://hl7.org/fhir/SearchParameter/MolecularSequence-referenceseqid-window-coordinate" target="_blank" title="http://hl7.org/fhir/SearchParameter/MolecularSequence-referenceseqid-window-coordinate">http://hl7.org/fhir/SearchParameter/MolecularSequence-referenceseqid-window-coordinate</a></p>
<div class="codehilite"><pre><span></span>        &lt;expression value=&quot;MolecularSequence.referenceSeq&quot;/&gt;
        &lt;xpathUsage value=&quot;normal&quot;/&gt;
        &lt;multipleOr value=&quot;false&quot;/&gt;
        &lt;multipleAnd value=&quot;true&quot;/&gt;
        &lt;modifier value=&quot;missing&quot;/&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-referenceseqid&quot;/&gt;
          &lt;expression value=&quot;referenceSeqId&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-window-start&quot;/&gt;
          &lt;expression value=&quot;start&quot;/&gt;
        &lt;/component&gt;
        &lt;component&gt;
          &lt;definition value=&quot;http://hl7.org/fhir/SearchParameter/MolecularSequence-window-end&quot;/&gt;
          &lt;expression value=&quot;end&quot;/&gt;
        &lt;/component&gt;
</pre></div>


<p>Same as number 1 (i.e. I think <code>windowStart</code> and <code>windowEnd</code> should have been used instead).</p>
<p><span class="user-mention" data-user-id="191913">@Kevin Power</span></p>



<a name="154021049"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154021049" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154021049">(Nov 27 2018 at 12:45)</a>:</h4>
<p>You are right, both should use window start and end. Let me take a look later today.</p>



<a name="154021126"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154021126" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154021126">(Nov 27 2018 at 18:42)</a>:</h4>
<p><a href="https://github.com/HL7/fhir/pull/306" target="_blank" title="https://github.com/HL7/fhir/pull/306">https://github.com/HL7/fhir/pull/306</a></p>



<a name="154021156"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154021156" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michael Calderero <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154021156">(Nov 27 2018 at 21:10)</a>:</h4>
<p><span class="user-mention" data-user-id="191913">@Kevin Power</span>  the update looks fine to me now. Thank you.</p>



<a name="154021158"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179197-genomics/topic/R4%20MolecularSequence%20composite%20search%20params/near/154021158" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kevin Power <a href="https://fhir.github.io/chat-archive/stream/179197-genomics/topic/R4.20MolecularSequence.20composite.20search.20params.html#154021158">(Nov 27 2018 at 21:14)</a>:</h4>
<p>Great, thanks.  Sorry for taking an extra step on it - I missed the issue.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
