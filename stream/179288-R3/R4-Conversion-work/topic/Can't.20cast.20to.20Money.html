---
layout: page
title: "FHIR Chat  · Can&#x27;t cast to Money · R3/R4 Conversion work"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/index.html">R3/R4 Conversion work</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html">Can&#x27;t cast to Money</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154022343"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022343" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022343">(Dec 02 2018 at 06:39)</a>:</h4>
<p>I'm having the same issue in <a href="https://github.com/HL7/fhir/pull/335" target="_blank" title="https://github.com/HL7/fhir/pull/335">https://github.com/HL7/fhir/pull/335</a> and <a href="https://github.com/HL7/fhir/pull/334" target="_blank" title="https://github.com/HL7/fhir/pull/334">https://github.com/HL7/fhir/pull/334</a> - I can't move a money element around, it fails on casting:</p>
<div class="codehilite"><pre><span></span>org.hl7.fhir.exceptions.FHIRException: Unable to convert a org.hl7.fhir.r4.elementmodel.Element to an Money
    at org.hl7.fhir.r4.model.Base.castToMoney(Base.java:508)
    at org.hl7.fhir.r4.model.ExplanationOfBenefit$TotalComponent.setProperty(ExplanationOfBenefit.java:10501)
    at org.hl7.fhir.r4.utils.StructureMapUtilities.processTarget(StructureMapUtilities.java:1809)
</pre></div>


<p>I've looked into it, <code>Base.java</code> <code>public Money castToMoney(Base b)</code> is failing and doesn't think <code>b</code> is an instanceOf <code>Money</code> even though <code>b.toString()</code> says <code>totalCost=Money[3 children]</code></p>



<a name="154022344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022344">(Dec 02 2018 at 06:39)</a>:</h4>
<p>Given that Money was reworked I'm guessing this is the sideeffect</p>



<a name="154022557"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022557" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022557">(Dec 03 2018 at 18:52)</a>:</h4>
<p>hmm. I'll have a look at it</p>



<a name="154022696"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022696" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022696">(Dec 04 2018 at 07:35)</a>:</h4>
<p>OK let me know. I have a couple of maps that are stuck on this</p>



<a name="154022842"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022842" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022842">(Dec 04 2018 at 18:41)</a>:</h4>
<p>ok:</p>
<div class="codehilite"><pre><span></span>group ExplanationOfBenefitTotalCost(source src, target tgt) extends BackboneElement {
  // src.category -&gt; tgt.category;
  src as vs -&gt; tgt.amount as vt then Money(vs, vt);
}
</pre></div>



<a name="154022843"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022843" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022843">(Dec 04 2018 at 18:42)</a>:</h4>
<p>why is category commented out?</p>



<a name="154022845"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022845" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022845">(Dec 04 2018 at 18:42)</a>:</h4>
<p>I fixed the mapping. well, I changed it to what works. In general, I would not expect what you currently have to work except for primitives</p>



<a name="154022846"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022846" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022846">(Dec 04 2018 at 18:43)</a>:</h4>
<p>Like the PR said with the [WIP], it was still a work in progress <span class="emoji emoji-1f609" title="wink">:wink:</span></p>



<a name="154022847"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022847" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022847">(Dec 04 2018 at 18:43)</a>:</h4>
<p>ok</p>



<a name="154022848"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022848" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022848">(Dec 04 2018 at 18:43)</a>:</h4>
<p>thanks, I'll finish it up and the other one as well</p>



<a name="154022849"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179288-R3/R4%20Conversion%20work/topic/Can%27t%20cast%20to%20Money/near/154022849" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179288-R3/R4-Conversion-work/topic/Can&#x27;t.20cast.20to.20Money.html#154022849">(Dec 04 2018 at 18:44)</a>:</h4>
<p>I forgot about the simple/vs complex, now it makes sense</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
