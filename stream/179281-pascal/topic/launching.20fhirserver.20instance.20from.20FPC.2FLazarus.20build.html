---
layout: page
title: "FHIR Chat  · launching fhirserver instance from FPC/Lazarus build · pascal"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/index.html">pascal</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html">launching fhirserver instance from FPC/Lazarus build</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="247967319"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247967319" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247967319">(Aug 02 2021 at 20:29)</a>:</h4>
<p>I'm copying this to continue the thread from pm discussions on July 23-26:<br>
<span class="user-mention" data-user-id="191316">@Grahame Grieve</span> <span class="user-mention" data-user-id="191832">@Jose Costa Teixeira</span> <span class="user-mention" data-user-id="248736">@Mark Iantorno</span> </p>
<blockquote>
<p>Rob Hausam: I think it’s pretty close on FPC, though, as I can compile and run the console there. Will need to get that working. Or use a Windows machine for the moment.</p>
<p>Grahame Grieve: It compiles on fpc for me but you must have the trunk version</p>
<p>Jose Costa Teixeira: Trunk of FPC, of Lazarus, or trunk of the server code?</p>
<p>Rob Hausam: We've been installing FPC and Lazarus via fpcupdeluxe, installing from trunk but also the specific revisions 47781 for FPC and 64209 for Lazarus. That was what worked previously, but maybe it's moved on since - maybe it's best now to update to the latest trunk revisions of both. I may try doing that, and see how it goes.</p>
<p>Grahame Grieve: Perhaps you should give me details of what the compile problems are</p>
<p>Rob Hausam: @Grahame Grieve I don't have any compile problems with it now. I'm able to compile fhirserver on Win 64 with the latest trunk versions of FPC/Lazarus. I just had to explicitly add the paths for the units for a number of the tests to get that working. And I've copied the same cfg and other files for the db, etc., including 'tzdata.tar.gz', but when I try to launch the server I'm getting: <code>TTZException: Zone not found []</code> then it immediately dies.</p>
<p>Grahame Grieve: Have to debug that one - I’ve never seen it</p>
<p>Rob Hausam: @Grahame Grieve I've been able to partly work around that, but there seems to be some issues with fsl_utilities and/or PascalTZ on FPC. To get part the initial timezone issue I commented out the lines for 'initializeTZData' and setting 'tz := TimeZoneBias;' and hardcoded it to UTC with 'tz := 0;', which worked for that part:<br>
<a href="/user_uploads/10155/A-kfSd3Rn3CGXcDbsNqD6SQp/Screen-Shot-2021-07-26-at-09.52.41.png">Screen-Shot-2021-07-26-at-09.52.41.png</a><br>
But when it's loading the r4 endpoint it runs into timezone issues again.  When I step into line 147 I get this exception in upascaltz.pas:<br>
<a href="/user_uploads/10155/B77nVT1PFwrdcN1tb79rdNe-/Screen-Shot-2021-07-26-at-09.46.54.png">Screen-Shot-2021-07-26-at-09.46.54.png</a></p>
<p>There are also some weird issues with ODBC, which mainly seem to be about FPC not being able for some reason to correctly parse the 'db-type' from fhirserver.cfg.  It claims <code>Terminology Server using Unknown database type mysql</code>, even though it's set to <code>mysql</code> in the cfg file (and that works in Delphi).<br>
<a href="/user_uploads/10155/2D9M4D8U8yN6ee1tS5DRCLEe/Screen-Shot-2021-07-26-at-10.10.13.png">Screen-Shot-2021-07-26-at-10.10.13.png</a><br>
The current cfg file is: <a href="/user_uploads/10155/8yYBAq4FC1Kx8hzDi2apcO97/fhirserver.cfg">fhirserver.cfg</a></p>
</blockquote>
<p>It would be good if we can get this fully working on FPC/Lazaurus (or inform us if you already have).</p>



<a name="247968996"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247968996" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247968996">(Aug 02 2021 at 20:43)</a>:</h4>
<p>I think the unknown type mysql is due to a typo</p>



<a name="247969108"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247969108" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247969108">(Aug 02 2021 at 20:44)</a>:</h4>
<p>I don't think so - but I'm double checking now, as I had an incorrect copy of the file shown before (that's why I removed it for the moment).</p>



<a name="247969229"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247969229" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247969229">(Aug 02 2021 at 20:46)</a>:</h4>
<p>utilities.pas, lines 332 and 350,<br>
there's a part that reads <br>
<code>sameText(details['type'].value, 'mysql')</code> - that should be <br>
<code>sameText(details['db-type'].value, 'mysql')</code></p>



<a name="247969335"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247969335" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247969335">(Aug 02 2021 at 20:46)</a>:</h4>
<p>without that, this works for mssql (a few lines above you can see that for msswl the typo is not there</p>



<a name="247969377"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247969377" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247969377">(Aug 02 2021 at 20:47)</a>:</h4>
<p>I fixed that in my instance first, though - and I'll double check, too, that I actually did make that fix</p>



<a name="247969513"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247969513" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247969513">(Aug 02 2021 at 20:48)</a>:</h4>
<p>the same cfg file and code worked for 'mysql' in Delphi, but not in FPC/Lazarus</p>



<a name="247971363"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247971363" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247971363">(Aug 02 2021 at 21:04)</a>:</h4>
<p>I added the link to the cfg file in the post above.  I had fixed the syntax errors that you mentioned (should be 'db-type') in my copy that I was building.  That's also where I had to do an additional work-around to get as far with it as I did.</p>



<a name="247979525"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/247979525" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#247979525">(Aug 02 2021 at 22:33)</a>:</h4>
<p>the cfg file seems fine</p>



<a name="248172718"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179281-pascal/topic/launching%20fhirserver%20instance%20from%20FPC/Lazarus%20build/near/248172718" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Rob Hausam <a href="https://fhir.github.io/chat-archive/stream/179281-pascal/topic/launching.20fhirserver.20instance.20from.20FPC.2FLazarus.20build.html#248172718">(Aug 03 2021 at 01:14)</a>:</h4>
<p>yes</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
