---
layout: page
title: "FHIR Chat  · traditional relational model · analytics on FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/index.html">analytics on FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html">traditional relational model</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153891943"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153891943" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153891943">(Jun 01 2017 at 15:12)</a>:</h4>
<p>Not sure if this is the proper forum, but has anyone done any work using a more traditional relational model, and something like a Postgres XL?    <a href="http://www.postgres-xl.org/" target="_blank" title="http://www.postgres-xl.org/">http://www.postgres-xl.org/</a></p>



<a name="153891974"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153891974" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153891974">(Jun 01 2017 at 20:45)</a>:</h4>
<p>@<strong>nicola (RIO)</strong> uses Postgresql and is well connected to the dev team</p>



<a name="153892002"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153892002" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jim Steel <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153892002">(Jun 02 2017 at 00:12)</a>:</h4>
<p>We use a mix of postgres and nosql in ontoserver</p>



<a name="153892062"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153892062" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153892062">(Jun 02 2017 at 09:09)</a>:</h4>
<p><span class="user-mention" data-user-id="193261">@craig mcclendon</span> we use postgresql with jsonb - so it's like hybrid approach between document dbs and relational dbs. We initially tried to generate pure relational model - but it's about &gt; 1K tables and joins are slow. Here is slides from my Madrid talk - <a href="https://niquola.github.io/madrid-hl7-2017-slides/slides/index.html#/2" target="_blank" title="https://niquola.github.io/madrid-hl7-2017-slides/slides/index.html#/2">https://niquola.github.io/madrid-hl7-2017-slides/slides/index.html#/2</a>. PostgresXL is little bit outdated (as i remember they are on 9.4 version), but i know guys from postgrespro company who are working to update of PostgresXL to latest pg version. There are also greenplum and citusdb extensions - promising for pg analytic.</p>



<a name="153892151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153892151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gary Teichrow <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153892151">(Jun 02 2017 at 17:41)</a>:</h4>
<p>Thx for link to PostGres-XL.  I've been neglecting that project.  I've also been tinkering with Apache Accumulo (<a href="https://accumulo.apache.org/" target="_blank" title="https://accumulo.apache.org/">https://accumulo.apache.org/</a>) as primary backing store but still noodling about right 'granularity' for the data, if that makes sense.  Cheers.</p>



<a name="153922670"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922670" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Tyukin <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922670">(Dec 02 2017 at 15:42)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191318">@nicola (RIO/SS)</span>  I am thinking to convert 10-15 different resources  we are getting from vendor into relational database. Was 1K tables in your case covering all 100+ FHIR resources? The problem with storing FHIR data as JSON  objects is that traditional BI tools cannot work with nested structures well and also we want to hide complexity of FHIR resources for our BI Developers.</p>



<a name="153922687"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922687" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922687">(Dec 02 2017 at 20:33)</a>:</h4>
<p>Hi, usually in bi you write direct sql, so with pg this is not a problem. Another solution is to create flatten views in the same database</p>



<a name="153922689"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922689" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Tyukin <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922689">(Dec 02 2017 at 22:03)</a>:</h4>
<p><span class="user-mention" data-user-id="191318">@nicola (RIO/SS)</span> right you can use SQL and dotted json notation and most RDBMS support json as an object these days (Oracle, MS SQL, Postgres) but it is still not a trivial task to do so because of nested arrays and references between documents. You had a nice slide about these challenges. I guess I am asking what everyone else are doing with FHIR documents if they need to analyze data and build dashboards using BI tools like QlikView, Tableau, Oracle BI etc. I was going to normalize all the nested structures (I believe I can generate DDLs and logic) but before I spend my time on it, wanted to see how everyone else is doing this</p>



<a name="153922723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922723">(Dec 03 2017 at 22:10)</a>:</h4>
<p>no one has shared anything about this, though there are people doing it. But everyone has different styles of use of database (e.g. how much to normalise), and different use of underlying technologies, and different compromises due to additional constraints in the underlying data. As well as additional considerations around terminology infrastructure</p>



<a name="153922724"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922724" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922724">(Dec 03 2017 at 22:10)</a>:</h4>
<p>all of this means that there's not a lot of mileage in sharing DDL scripts.</p>



<a name="153922725"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922725" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922725">(Dec 03 2017 at 22:11)</a>:</h4>
<p>also, as you have found, non-transactional systems (for analysis/reporting) are starting to move to json based tooling and just using the resources directly.</p>



<a name="153922728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Tyukin <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922728">(Dec 03 2017 at 23:31)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191316">@Grahame Grieve</span> makes sense to me. I think I am going to try a hybrid approach - store bundle resources as json values and expose some of the key data using normalized version for BI Developers. That way we have FHIR native data available for analytics and we have easier to use normalized tables for dashboards and such.</p>



<a name="153922804"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153922804" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Tyukin <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153922804">(Dec 04 2017 at 17:11)</a>:</h4>
<p>found two interesting publications, focused on conversion of semi-structured json to relational model.</p>
<p><a href="http://cs-www.cs.yale.edu/homes/dna/papers/schemagen-sigmod16.pdf" target="_blank" title="http://cs-www.cs.yale.edu/homes/dna/papers/schemagen-sigmod16.pdf">http://cs-www.cs.yale.edu/homes/dna/papers/schemagen-sigmod16.pdf</a></p>
<p><a href="http://digitalcommons.unf.edu/cgi/viewcontent.cgi?article=1781&amp;context=etd" target="_blank" title="http://digitalcommons.unf.edu/cgi/viewcontent.cgi?article=1781&amp;context=etd">http://digitalcommons.unf.edu/cgi/viewcontent.cgi?article=1781&amp;context=etd</a></p>



<a name="153923922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153923922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Boris Tyukin <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153923922">(Dec 09 2017 at 17:39)</a>:</h4>
<p>someone pointed me to an excellent write-up about EAV modeling concepts on wiki <a href="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model" target="_blank" title="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model">https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model</a>. It is a long article but it explains different options on how to deal with columnar representation of EAV data for statistical / analytical tools.</p>



<a name="153924724"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153924724" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153924724">(Dec 13 2017 at 12:14)</a>:</h4>
<p>Another approach I've been thinking of is more solution bound: Vonk on SQL Server indexes all the search parameter values into a couple of simple tables that should be a fairly good source for star schemas. It can also process custom search parameters, with custom fhirpath expressions in them - so you can get those in the index as well.</p>



<a name="153926029"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/traditional%20relational%20model/near/153926029" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Craig McClendon <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/traditional.20relational.20model.html#153926029">(Dec 18 2017 at 19:55)</a>:</h4>
<p>Here was a simple example I created just to get a sense of what it might look like to model out the resources and datatypes and what the queries might look like. <br>
It's using a generic table "relationship_mapper" to manage the relationships between objects. </p>
<p>In this case I was just looking at how to represent and query Observation.code. <br>
(this is psql syntax)</p>
<hr>
<p>CREATE TABLE Observation (<br>
pkey text, <br>
_status text<br>
);</p>
<p>CREATE TABLE CodeableConcept(<br>
  pkey text, <br>
  _text text<br>
);</p>
<p>CREATE Table Coding (<br>
    pkey text,<br>
    _system text, <br>
    _version text, <br>
    _code text, <br>
    _display text,<br>
    _userSelected boolean<br>
);</p>
<p>-- generic relationship mapping table<br>
CREATE TABLE relationship_mapper (<br>
    pkey text, <br>
    table_a text, <br>
    table_b text,<br>
    table_a_key text,<br>
    table_b_key text,<br>
    relationship_type text<br>
);</p>
<p>-- insert an observation with a code<br>
INSERT INTO Observation (pkey) VALUES ('OBS1');<br>
INSERT INTO CodeableConcept(pkey) VALUES ('CC1');<br>
INSERT INTO Coding(pkey, _system, _code) VALUES ('CODING1', '<a href="http://loinc.org" target="_blank" title="http://loinc.org">http://loinc.org</a>', '8867-4');<br>
INSERT INTO relationship_mapper VALUES ('R1', 'Observation', 'CodeableConcept', 'OBS1', 'CC1', 'code');<br>
INSERT INTO relationship_mapper VALUES ('R2', 'CodeableConcept', 'Coding', 'CC1', 'CODING1', 'coding');</p>
<p>drop view ObservationCode;<br>
CREATE VIEW ObservationCode as<br>
SELECT r1.table_a_key as ObservationKey, tab.*<br>
FROM CodeableConcept tab<br>
INNER JOIN relationship_mapper r1 ON (<br>
    r1.table_a = 'Observation'<br>
    AND r1.relationship_type = 'code'<br>
    AND r1.table_b = 'CodeableConcept'<br>
    AND r1.table_b_key = tab.pkey);</p>
<p>drop view CodeableConcept2Coding;<br>
CREATE VIEW CodeableConcept2Coding as<br>
SELECT r1.table_a_key as CodeableConceptPkey, tab.*<br>
FROM Coding tab<br>
INNER JOIN relationship_mapper r1 ON (<br>
    r1.table_a = 'CodeableConcept'<br>
    AND r1.relationship_type = 'coding'<br>
    AND r1.table_b = 'Coding'<br>
    AND r1.table_b_key = tab.pkey);</p>
<p>--SELECT * FROM ObservationCode<br>
--SELECT * FROM CodeableConcept2Coding<br>
--SELECT * FROM relationship_mapper</p>
<p>-- find all observations with a particular code<br>
SELECT *<br>
FROM Observation obs<br>
WHERE EXISTS (<br>
        SELECT * <br>
        FROM ObservationCode cc<br>
        INNER JOIN CodeableConcept2Coding coding ON (cc.pkey = coding.CodeableConceptPkey)<br>
        WHERE cc.ObservationKey = obs.pkey<br>
          AND coding._system = '<a href="http://loinc.org" target="_blank" title="http://loinc.org">http://loinc.org</a>'<br>
          AND coding._code = '8867-4' )</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
