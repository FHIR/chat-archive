---
layout: page
title: "FHIR Chat  · Connectathon track · analytics on FHIR"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/index.html">analytics on FHIR</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html">Connectathon track</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153987527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153987527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153987527">(Aug 16 2018 at 12:14)</a>:</h4>
<p>David Hay asked us to formulate scenarios for track!</p>
<blockquote>
<p><span class="user-mention" data-user-id="194833">@Patrik Sundberg</span> we want to do the same with postgresql and fhirbase. So people will be able compare bigquery and postgresql :).  May be <span class="user-mention" data-user-id="193657">@Ryan Brush</span> can do the same with spark and bunsen. Then we can discuss common subset of SQL for FHIR.</p>
</blockquote>
<p><span class="user-mention" data-user-id="194833">@Patrik Sundberg</span> <span class="user-mention" data-user-id="193657">@Ryan Brush</span> <span class="user-mention" data-user-id="195380">@Kenny Blanchette</span></p>



<a name="153987532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153987532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153987532">(Aug 16 2018 at 12:25)</a>:</h4>
<p>Here is what we tried to do on previous one - <a href="https://github.com/fhir-fuel/fhir-storage-and-analytics-track" target="_blank" title="https://github.com/fhir-fuel/fhir-storage-and-analytics-track">https://github.com/fhir-fuel/fhir-storage-and-analytics-track</a></p>



<a name="153987534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153987534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153987534">(Aug 16 2018 at 12:27)</a>:</h4>
<p>For track we have to have a leader.  <span class="user-mention" data-user-id="194833">@Patrik Sundberg</span>  would you like to lead us?</p>



<a name="153987535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153987535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153987535">(Aug 16 2018 at 12:31)</a>:</h4>
<p>There is an idea to integrate this track with bulk load api and for track provide bulk loader for each specific database. Participants will be able to load data from existing FHIR server and start playing with SQL. (<a href="https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues/6" target="_blank" title="https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues/6">https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues/6</a>)</p>



<a name="153987539"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153987539" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153987539">(Aug 16 2018 at 12:40)</a>:</h4>
<p>We can work on scenarios as github issues in <a href="https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues" target="_blank" title="https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues">https://github.com/fhir-fuel/fhir-storage-and-analytics-track/issues</a></p>



<a name="153999072"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/153999072" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> robert worden <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#153999072">(Sep 21 2018 at 17:47)</a>:</h4>
<p>I'll be coming to your connectathon track, although my interests are a little different from your main thrust. I am interested in getting FHIR in and out of legacy relational databases; generating the transforms, and generating  the required SQL from a RESTFul FHIR search. So I may be watching and  learning more than doing.</p>



<a name="154001574"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154001574" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154001574">(Sep 29 2018 at 14:35)</a>:</h4>
<p>Here is online demo of fhirbase you can try - <a href="https://fbdemo.aidbox.app/" target="_blank" title="https://fbdemo.aidbox.app/">https://fbdemo.aidbox.app/</a></p>



<a name="154001973"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154001973" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154001973">(Sep 29 2018 at 18:08)</a>:</h4>
<p>The (very) experimental representation of the CMS CQL content in SQL that we had discussed earlier an be found here: <a href="https://gist.github.com/rbrush/61243822298dc077659028bb36c1b02d" target="_blank" title="https://gist.github.com/rbrush/61243822298dc077659028bb36c1b02d">https://gist.github.com/rbrush/61243822298dc077659028bb36c1b02d</a>.</p>



<a name="154001980"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154001980" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154001980">(Sep 29 2018 at 18:09)</a>:</h4>
<p>SQL on FHIR breakout in the President's Room  on 15:00 - join us!</p>



<a name="154002440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002440">(Sep 29 2018 at 21:12)</a>:</h4>
<p><a href="https://github.com/cqframework/healthedecisions/tree/master/tooling/framework/SQL.Translation" target="_blank" title="https://github.com/cqframework/healthedecisions/tree/master/tooling/framework/SQL.Translation">https://github.com/cqframework/healthedecisions/tree/master/tooling/framework/SQL.Translation</a></p>



<a name="154002444"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002444" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Bryn Rhodes <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002444">(Sep 29 2018 at 21:13)</a>:</h4>
<p><span class="user-mention" data-user-id="193657">@Ryan Brush</span>  and <span class="user-mention" data-user-id="191351">@Chris Grenz</span> , this is the ELM-to-SQL translator we were talking about it.</p>



<a name="154002548"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002548" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002548">(Sep 29 2018 at 21:48)</a>:</h4>
<p>Some notes from today's discussions:</p>
<p>There are two related but distinct projects here: One is a simplified projection of FHIR for SQL and analytic use. This should offer an excellent user experience to anyone looking to ask questions over large FHIR datasets, or create new knowledge for them. The second is a lossless storage format that is more efficient and easier to work with than the current JSON/NDJSON models. </p>
<p>Some notes on the simplified projections for SQL, which is my current focus:</p>
<ul>
<li>
<p>They can be lossy when needed to improve the experience of the data science users. For instance: <br>
    * id fields may be omitted<br>
    * Numeric values are represented a NUMERIC or DECIMAL types in the projection (so the original precision might be unknown)<br>
    * Dates and times may be represented using date and datetime types in the projection, to simplify use of database-provided functionality.</p>
</li>
<li>
<p>Systems should offer a way to retrieve the original, authoritative data in lossless JSON if they need to know what the original data was. (We do not yet specify how to retrieve that, since we want to offer some flexibility to find the best approach.)</p>
</li>
<li>Each projected table SQL schema is generated based on a given set of Profiles. </li>
<li>Extensions are projected as first-class fields based on the slice name of the projection. For instance, the US Core Patient profile has a first-class “race” field that can be queried like any other.</li>
<li>Similarly, slicing should be used as appropriate for codes defined in profiles. So US Core Observation.code would explicitly have a loinc field, rather than the convention of the LOINC code being in Observation.code.coding[0]</li>
<li>The SQL projections should be considered transient — so they can be discarded and re-recreated as needed, possibly with updated profiles (and corresponding extension fields).</li>
<li>The SQL schema used should follow conventions of the documentation on <a href="http://fhir.hl7.org" target="_blank" title="http://fhir.hl7.org">fhir.hl7.org</a>. Ideally, our analytic users should be able to simply use that web site as a reference for all of their SQL queries.</li>
<li>Inline with the above, field names should use camelCase and exactly match the structures on <a href="http://fhir.hl7.org" target="_blank" title="http://fhir.hl7.org">fhir.hl7.org</a>, as seen in that documentation.</li>
</ul>
<p>Open questions include how close the projections should stick with the NDJSON format, allowing queries directly over that, or whether that will be improved with a future storage representation. For instance, whether option types should be stored as distinct fields like valueQuantity, valueString, and so on — or as nested fields such as value.quantity, value.string, etc. This is a tradeoff between consistency with the JSON model and the ability to easily to check for NULL choice types in SQL.</p>
<p>I didn’t go into the physical storage considerations here since the above is my current focus, but welcome others to comment on that.</p>



<a name="154002627"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002627" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> David Hay <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002627">(Sep 30 2018 at 10:46)</a>:</h4>
<p>"Extensions are projected as first-class fields based on the slice name of the projection. For instance, the US Core Patient profile has a first-class “race” field that can be queried like any other." - interestingly, this is the approach I took when presenting a 'logical' view of a profile intended for clincian use...  Here's US Core patient for example: <a href="/user_uploads/10155/8hiAZG9gReSJW4mH7TcdGJBy/Screen-Shot-2018-09-30-at-6.46.11-AM.png" target="_blank" title="Screen-Shot-2018-09-30-at-6.46.11-AM.png">Screen-Shot-2018-09-30-at-6.46.11-AM.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/8hiAZG9gReSJW4mH7TcdGJBy/Screen-Shot-2018-09-30-at-6.46.11-AM.png" target="_blank" title="Screen-Shot-2018-09-30-at-6.46.11-AM.png"><img src="/user_uploads/10155/8hiAZG9gReSJW4mH7TcdGJBy/Screen-Shot-2018-09-30-at-6.46.11-AM.png"></a></div>



<a name="154002886"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002886" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002886">(Sep 30 2018 at 14:54)</a>:</h4>
<p><span class="user-mention" data-user-id="191321">@David Hay</span> As you probably know, Forge re-orders elements for display, listing extensions _after_ standard elements. Maybe the 'logical' view in ClinFhir could also follow this convention, if that makes sense?</p>



<a name="154002913"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002913" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002913">(Sep 30 2018 at 15:03)</a>:</h4>
<p>I used to list extensions afterwards in some of the generated IG views, but got some strong pushback</p>



<a name="154002975"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154002975" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154002975">(Sep 30 2018 at 15:26)</a>:</h4>
<p>Interesting. I've never received any push back about Forge's custom rendering order. I could easily implement a configuration option to toggle this behavior, however no user ever asked for it...?</p>



<a name="154003008"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003008" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Lloyd McKenzie <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003008">(Sep 30 2018 at 15:37)</a>:</h4>
<p>I would definitely like Forge to allow views that are consistent with how things need to appear in the instance.  It's confused several of my users.</p>



<a name="154003042"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003042" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003042">(Sep 30 2018 at 15:46)</a>:</h4>
<p><span class="user-mention" data-user-id="191320">@Lloyd McKenzie</span> thank you, that is good to know. Definitely makes the case for implementing a configuration option.</p>



<a name="154003242"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003242" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003242">(Sep 30 2018 at 18:05)</a>:</h4>
<p>I agree with Ryan's summary and the proposed direction. It will be helpful to consider the analyst view of the data separately from the storage format for now, but there are obvious similarities. Longer term, we might find ways to combine the two approaches.</p>
<p>We discussed query rewrites in the session yesterday; can we transform simple queries containing terms like "observation.code.loinc" to a longer, more complex query over a generic data format? This is tempting for various reasons, but i believe it's ultimately impractical because most tools will not have natural plugins for such transformations, so any workflow that needs to use transformations will be burdensome.</p>
<p>Instead, I believe we should focus on tools that make it easy to go from (Resource.ndjson, StructureDefinition) pairs into files suitable for direct queries by standard database engines. This conversion can and should be lossy for simplicity. It should inline extensions like Ryan mentioned before, and it should map primitive types to single fields. We've implement parts of this in our github repo, for example, here's a sample protobuf definition (ObservationGenetics) with a fair number of inlined extensions: <a href="https://github.com/google/fhir/blob/master/proto/stu3/profiles.proto#L233" target="_blank" title="https://github.com/google/fhir/blob/master/proto/stu3/profiles.proto#L233">https://github.com/google/fhir/blob/master/proto/stu3/profiles.proto#L233</a> .</p>
<p>Key items left to formally decide in my opinion are:</p>



<a name="154003243"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003243" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003243">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we name extensions?<ul>
<li>proposal: use slice names (this seems to be mostly agreed upon)</li>
</ul>
</li>
</ul>



<a name="154003244"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003244" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003244">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we handle choice types?<ul>
<li>proposal: observation.value.quantity instead of observation.valueQuantity</li>
</ul>
</li>
</ul>



<a name="154003246"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003246" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003246">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we represent decimal?<ul>
<li>proposal: as a native number, discarding precision (lossy conversion)</li>
</ul>
</li>
</ul>



<a name="154003247"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003247" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003247">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we represent dates?<ul>
<li>proposal: as ISO8601 string, with timezone as appropriate</li>
</ul>
</li>
</ul>



<a name="154003248"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003248" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003248">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we handle unknown extensions (those not explicitly listed in the input profile)?<ul>
<li>proposal: drop on the floor (lossy)</li>
<li>proposal: keep, for queries of the type "count extension types in use group by extension_url"</li>
</ul>
</li>
</ul>



<a name="154003249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003249">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we handle ids and extensions on primitive fields?<ul>
<li>proposal: drop on the floor (lossy)</li>
</ul>
</li>
</ul>



<a name="154003250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003250">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>how do we handle nested recursive types?<ul>
<li>proposal: define a max nesting level somewhere</li>
<li>proposal: use avro files and built-in avro support</li>
</ul>
</li>
</ul>



<a name="154003251"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003251" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003251">(Sep 30 2018 at 18:06)</a>:</h4>
<ul>
<li>do we duplicate sliced data (extensions, observation.code.loinc, etc), leaving it in the raw fields?<ul>
<li>proposal: no</li>
<li>proposal: yes</li>
</ul>
</li>
</ul>



<a name="154003332"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003332" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003332">(Sep 30 2018 at 18:49)</a>:</h4>
<ul>
<li>how do we handle situations where some resources do not comply with the profile, such as when querying for vitals in an observation table<ul>
<li>proposal: filter on resources that match the profile</li>
</ul>
</li>
</ul>



<a name="154003333"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003333" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003333">(Sep 30 2018 at 18:50)</a>:</h4>
<ul>
<li>how do we represent a primitive field with a declared extension<ul>
<li>proposal: as a new type, where the original value is accessed as "value"</li>
</ul>
</li>
</ul>



<a name="154003348"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003348" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003348">(Sep 30 2018 at 19:01)</a>:</h4>
<p>Thanks for this thoughtful enumeration of current considerations! On all items with a single proposal, I agree with the approach. I'll comment on a couple of the others...</p>
<blockquote>
<ul>
<li>how do we handle nested recursive types?<ul>
<li>proposal: define a max nesting level somewhere</li>
<li>proposal: use avro files and built-in avro support</li>
</ul>
</li>
</ul>
</blockquote>
<p>While Avro and ProtoBuf allow for arbitrarily recursive structures, we still need to apply a max depth when creating an SQL-based view of the data for Spark or Presto (and for other analytic tools as well.) So I think the best we can do is to base that depth based on the data that exists, but tools SHOULD re-create that schema with further depth if new data is discovered that demands it.</p>



<a name="154003349"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003349" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003349">(Sep 30 2018 at 19:02)</a>:</h4>
<blockquote>
<ul>
<li>do we duplicate sliced data (extensions, observation.code.loinc, etc), leaving it in the raw fields?<ul>
<li>proposal: no</li>
<li>proposal: yes</li>
</ul>
</li>
</ul>
</blockquote>
<p>After an offline discussion, I think our current best option is to leave in the raw fields. This makes it easier for users to explore who may not be interested in the specific slices, and keeps it consistent with the documentation published on <a href="http://fhir.hl7.org" target="_blank" title="http://fhir.hl7.org">fhir.hl7.org</a></p>



<a name="154003352"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003352" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003352">(Sep 30 2018 at 19:04)</a>:</h4>
<blockquote>
<ul>
<li>how do we handle unknown extensions (those not explicitly listed in the input profile)?<ul>
<li>proposal: drop on the floor (lossy)</li>
<li>proposal: keep, for queries of the type "count extension types in use group by extension_url"</li>
</ul>
</li>
</ul>
</blockquote>
<p>Similarly, we discussed that keeping these extensions is worthwhile to support users doing exploration of the data, making sure their schemas cover all the extensions they need.</p>



<a name="154003358"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003358" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003358">(Sep 30 2018 at 19:19)</a>:</h4>
<p>Missed one:</p>
<ul>
<li>how do we handle references?<ul>
<li>proposal: split typed references ("Patient/ABC") into subfields, e.g. patient_id</li>
</ul>
</li>
</ul>



<a name="154003359"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003359" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003359">(Sep 30 2018 at 19:21)</a>:</h4>
<ul>
<li>how do we handle choice types?<ul>
<li>proposal: observation.value.quantity instead of observation.valueQuantity</li>
<li>consider observation.value.Quantity vs observation.value.quantity. What with CodeableConcept or DateTime ? codeableconcept?</li>
</ul>
</li>
</ul>



<a name="154003360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003360">(Sep 30 2018 at 19:22)</a>:</h4>
<ul>
<li>reference &amp; choice types meta attribute : <code>reference: {patient_id: ...., type: 'Patient'}, choice: {quantity: ..., type: 'Quantity'}</code></li>
</ul>



<a name="154003366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003366">(Sep 30 2018 at 19:25)</a>:</h4>
<p>fyi here's the protobuf current Observation.value: <a href="https://github.com/google/fhir/blob/master/proto/stu3/resources.proto#L11657" target="_blank" title="https://github.com/google/fhir/blob/master/proto/stu3/resources.proto#L11657">https://github.com/google/fhir/blob/master/proto/stu3/resources.proto#L11657</a></p>



<a name="154003370"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003370" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003370">(Sep 30 2018 at 19:28)</a>:</h4>
<ul>
<li>how do we handle contained resources?<ul>
<li>proposal: drop on the floor</li>
</ul>
</li>
</ul>



<a name="154003376"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003376" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003376">(Sep 30 2018 at 19:31)</a>:</h4>
<p>* externalise<br>
  * move into reference (we do this using custom resource attribute in Reference)</p>



<a name="154003379"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003379" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003379">(Sep 30 2018 at 19:33)</a>:</h4>
<ul>
<li>how do we represent a primitive field with a declared extension<ul>
<li>proposal: as a new type, where the original value is accessed as "value"</li>
<li>move it into another element: birthDate.extension =&gt;  birthDateTime</li>
</ul>
</li>
</ul>



<a name="154003382"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003382" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003382">(Sep 30 2018 at 19:37)</a>:</h4>
<p>If you move the extension to a sibling element, and the original element repeats - how do you correlate the extension values to the elements they were originally contained in?</p>



<a name="154003387"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003387" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003387">(Sep 30 2018 at 19:39)</a>:</h4>
<p>I do not know, but semantically this is a new element :)</p>



<a name="154003426"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003426" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003426">(Sep 30 2018 at 20:16)</a>:</h4>
<p>I think our current proposal is that extensions are duplicated to sibling elements for convenience (to make it easy to query patient.race, for instance), but still preserve them in their original form as well. This seems like the "Least Surprising Behavior", offering an additional field for convenience while preserving the content of the original fields as much as possible.</p>



<a name="154003440"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003440" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003440">(Sep 30 2018 at 20:27)</a>:</h4>
<p>I took a pass at incorporating the above proposals into the SQL on FHIR markdown document. Much of the above was already reflected in the document, but you can see the changes in the pull request here: <a href="https://github.com/rbrush/sql-on-fhir/pull/9/files" target="_blank" title="https://github.com/rbrush/sql-on-fhir/pull/9/files">https://github.com/rbrush/sql-on-fhir/pull/9/files</a>.</p>



<a name="154003446"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003446" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003446">(Sep 30 2018 at 20:30)</a>:</h4>
<p>Please feel free to make any comments or suggestions on that pull request. The document is still a work in progress and will surely change, but I think this gets us close enough to start building early systems on this specification. </p>
<p>The biggest course change we've made is to accept this is a lossy projection of the underlying FHIR data to create a great experience for analysts looking to explore FHIR data. In most cases the information loss won't matter to these users, but the original data should be available as well for users who need to know the exact precision used for each numeric field, for instance.</p>



<a name="154003452"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003452" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003452">(Sep 30 2018 at 20:32)</a>:</h4>
<p>This does not attempt to define an approach to a non-lossy, efficient physical representation. However, this should be a useful reference for physical representations to ensure they can be easily projected onto the model described here.</p>



<a name="154003506"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003506" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Patrik Sundberg <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003506">(Sep 30 2018 at 21:09)</a>:</h4>
<p>fwiw this example: <a href="https://github.com/google/fhir/tree/master/examples/bigquery" target="_blank" title="https://github.com/google/fhir/tree/master/examples/bigquery">https://github.com/google/fhir/tree/master/examples/bigquery</a><br>
exposes a few of these issues in practice. the schema in use here is not the lossy, profile-specific one discussed in this connectathon, but i will change it to be.</p>



<a name="154003519"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003519" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003519">(Oct 01 2018 at 00:47)</a>:</h4>
<p>Proto of CMS metric in postgresql - <a href="https://fbdemo.aidbox.app/" target="_blank" title="https://fbdemo.aidbox.app/">https://fbdemo.aidbox.app/</a> - see CMS snippet</p>



<a name="154003806"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154003806" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ryan Brush <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154003806">(Oct 01 2018 at 16:31)</a>:</h4>
<p>I went ahead and merged the pull request I mentioned to <a href="https://github.com/rbrush/sql-on-fhir" target="_blank" title="https://github.com/rbrush/sql-on-fhir">https://github.com/rbrush/sql-on-fhir</a> that reflects our discussions here. We'll continue to update that document as further changes emerge.</p>
<p>One additional topic did come up:</p>
<ul>
<li>How to deal with extensions that are unknown when generating the SQL schema?<ul>
<li>Proposal:  when generating the schema, users specify the profiles/extensions they are interested in querying. Additional extensions in the data will be visible as URLs in the projection so they can be detected, but won't have schema generated for them. </li>
</ul>
</li>
</ul>
<p>This assumes the schema can be easily re-generated if there is a desire to query these new extensions.</p>



<a name="154006228"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154006228" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154006228">(Oct 05 2018 at 10:50)</a>:</h4>
<blockquote>
<p>how do we handle contained resources?<br>
proposal: drop on the floor</p>
</blockquote>
<p>That's my favorite idea, if only it was a realistic one</p>



<a name="154006309"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179219-analytics%20on%20FHIR/topic/Connectathon%20track/near/154006309" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> nicola (RIO/SS) <a href="https://fhir.github.io/chat-archive/stream/179219-analytics-on-FHIR/topic/Connectathon.20track.html#154006309">(Oct 05 2018 at 14:17)</a>:</h4>
<p>i think, exporter can have options - drop, externalise, internalise</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
