---
layout: page
title: "FHIR Chat  · FHIR Parser · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html">FHIR Parser</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154022918"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022918" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022918">(Dec 04 2018 at 21:09)</a>:</h4>
<p>I recently ran into an issue with the .NET parser which I thought I would mention as I think it may be an issue.</p>
<p>Recently I was using the  .NET API to access an API  as a means of testing it. The API has a JSON interface which contained the following snippet<br>
<a href="/user_uploads/10155/uxG4F0WVV6jukcoHl9aoJmcO/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/uxG4F0WVV6jukcoHl9aoJmcO/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/uxG4F0WVV6jukcoHl9aoJmcO/pasted_image.png"></a></div><p>This is wrong as it should have been <br>
<a href="/user_uploads/10155/uZK-8WadB1MZJLSUFVlyjvcd/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/uZK-8WadB1MZJLSUFVlyjvcd/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/uZK-8WadB1MZJLSUFVlyjvcd/pasted_image.png"></a></div><p>The .NET parser did not throw any errors and compensated for the missing "[","]". I am assuming this is unintentional behaviour as technically the JSON is incorrect.</p>
<p>So two questions -<br>
1) The JSON in the first snippet is incorrect?<br>
2) Should the parser silently mask the issue?</p>



<a name="154022922"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022922" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022922">(Dec 04 2018 at 21:13)</a>:</h4>
<p>Hi RIchard - it's indeed the case that the .NET parser ignores a missing array, treating it as an array with a single element. The new non-POCO parsers in 1.0 will catch it, but the POCO-parser still has the problem. The upcoming 1.1 release will have this fixed. It's related to this issue: <a href="https://github.com/ewoutkramer/fhir-net-api/issues/756" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/issues/756">https://github.com/ewoutkramer/fhir-net-api/issues/756</a>.</p>



<a name="154022925"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022925" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022925">(Dec 04 2018 at 21:17)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="191328">@Ewout Kramer</span>  for confirming this. Good to hear it is been looked at for a future release. For now, we have a bit of an issue in that some of our testing was based on .NET and we did not catch the issue. People using non .NET parsers are now facing issues. Looks like we'll need to switch parts of our toolset to Java for now.</p>



<a name="154022927"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022927" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022927">(Dec 04 2018 at 21:18)</a>:</h4>
<p>Richard - the release will actually be before christmas - don't know if that helps. We could look at a hotfix if that solves your problem.</p>



<a name="154022933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022933">(Dec 04 2018 at 21:31)</a>:</h4>
<p>Once again thanks <span class="user-mention" data-user-id="191328">@Ewout Kramer</span> If it's that close then we can probably wait for the release. The changes in the API are having a few issues in other places which I am also working with (note the previous FHIRPath question). The issue is with me to fix the code but I'm struggling in places. Guess I'll be busy over Christmas :-)</p>



<a name="154022952"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022952" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vadim Peretokin <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022952">(Dec 04 2018 at 21:54)</a>:</h4>
<p>Could also throw in json validation on export as well, no?</p>



<a name="154022957"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022957" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022957">(Dec 04 2018 at 22:01)</a>:</h4>
<p>Yes, you could. In fact - you could invoke all structural (non-profile) validation logic by parsing xml/json through the typed parses, and then reading all of it:</p>
<div class="codehilite"><pre><span></span><span class="kt">var</span> <span class="n">tpJson</span> <span class="p">=</span> <span class="n">File</span><span class="p">.</span><span class="n">ReadAllText</span><span class="p">(</span><span class="s">@&quot;testdata.json&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">tree</span> <span class="p">=</span> <span class="n">FhirJsonNode</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">tpJson</span><span class="p">).</span><span class="n">ToTypedElement</span><span class="p">(</span><span class="k">new</span> <span class="n">PocoStructureDefinitionSummaryProvider</span><span class="p">());</span>
<span class="kt">var</span> <span class="n">errors</span> <span class="p">=</span> <span class="n">tree</span><span class="p">.</span><span class="n">VisitAndCatch</span><span class="p">();</span>
</pre></div>



<a name="154022961"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022961" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022961">(Dec 04 2018 at 22:03)</a>:</h4>
<p><a href="http://docs.simplifier.net/fhirnetapi/parsing.html" target="_blank" title="http://docs.simplifier.net/fhirnetapi/parsing.html">http://docs.simplifier.net/fhirnetapi/parsing.html</a> has more details on what's happening here. This is basically the lower-level functionality that the POCO parsers call.</p>



<a name="154022962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIR%20Parser/near/154022962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIR.20Parser.html#154022962">(Dec 04 2018 at 22:04)</a>:</h4>
<p>So, on export, you could run this bit on your generated json.  Luckily the POCO serializers will generate correct json ;-)</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
