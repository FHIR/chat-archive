---
layout: page
title: "FHIR Chat  · Firely - Unable to resolve reference to profile · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html">Firely - Unable to resolve reference to profile</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="243043683"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243043683" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243043683">(Jun 17 2021 at 16:18)</a>:</h4>
<p>I am trying to validate a Patient resource that follows the us-core-patient using the <a href="https://server.fire.ly/">Firely server</a>. I have been following <a href="https://docs.fire.ly/projects/Firely-Server/en/latest/features/validation.html#validate-on-the-resourcetype-level">Firely documentation for validation</a> and trying the validation on a system and ResourceType level. However I get the error <code>Unable to resolve reference to profile 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient'</code>. To reference the us-core-patient I either put the canonical url in the endpoint like so<br>
<code>https://server.fire.ly/Patient/$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code><br>
or put it in the meta field for the resource</p>
<div class="codehilite"><pre><span></span><code>    &quot;resourceType&quot;: &quot;Patient&quot;,
    &quot;meta&quot;: {
        &quot;profile&quot;: [
            &quot;http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient&quot;
        ]
    },
</code></pre></div>
<p>I managed to get the validation working using the FHIR validator jar [FHIR Validation tool Version 5.4.4 (Git# 952db0248a25)] for the Patient resource.<br>
<span class="user-mention" data-user-id="191328">@Ewout Kramer</span> Do you or anyone else know what might be the issue?<br>
Additionally, another situation when validating a bundle using the Firely server I receive no errors, but the FHIR validator jar returns errors such as <code>Bundle entry missing fullUrl</code> or <code>Except for transactions and batches, each entry in a Bundle must have a fullUrl which is the identity of the resource in the entry</code>; what could account for these differences?</p>



<a name="243135187"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243135187" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243135187">(Jun 18 2021 at 09:12)</a>:</h4>
<p>You reference the profile correctly, but unless that profile is present in the Firely Server so the validator can locate it and use it, it still will not work. I don't know if/how our public server has these us-core profiles installed, <span class="user-mention" data-user-id="259036">@Matthijs van der Wielen</span> or <span class="user-mention" data-user-id="191757">@Christiaan Knaap</span> will surely know more about that.</p>



<a name="243135356"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243135356" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243135356">(Jun 18 2021 at 09:14)</a>:</h4>
<blockquote>
<p>Except for transactions and batches, each entry in a Bundle must have a fullUrl which is the identity of the resource in the entry</p>
</blockquote>
<p>There are certainly differences between the two validators, the Java one has more "hand-built" rules like these. This validation is not expressed in, say, the profile for Bundle, but rather these are present as written narrative rules in the spec only.  The .NET validator still misses quite a few of those rules.</p>



<a name="243135590"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243135590" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243135590">(Jun 18 2021 at 09:17)</a>:</h4>
<p>I have added this request to the list at <a href="https://github.com/FirelyTeam/firely-net-sdk/issues/1766">https://github.com/FirelyTeam/firely-net-sdk/issues/1766</a></p>



<a name="243136395"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243136395" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthijs van der Wielen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243136395">(Jun 18 2021 at 09:26)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="408951">@Corey Wen</span> ,<br>
I checked and the us-core-patient is loaded on the public endpoint, but only for STU3. So when you try to validate a R4 profile this will not work. Could you let me know it that is the case? </p>
<p>FYI you can check weather this profile is included using  ({{BASE_URL}}/administration/StructureDefinition?url=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient)</p>



<a name="243163436"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243163436" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243163436">(Jun 18 2021 at 13:52)</a>:</h4>
<p>Hi, I believe I was trying to validate a R4 profile but I am not sure how confirm if that is actually the case. I'm relatively new to FHIR so I'm not 100% sure. There is no data in my resource that denotes it being R4 or STU3, but this is the <a href="https://www.hl7.org/fhir/us/core/StructureDefinition-us-core-patient.html">profile for us-core patient</a> I was following.</p>



<a name="243168720"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243168720" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243168720">(Jun 18 2021 at 14:32)</a>:</h4>
<p>If you used <code>https://server.fire.ly/Patient/$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code>, I am pretty sure this is the R4 endpoint. <span class="user-mention" data-user-id="259036">@Matthijs van der Wielen</span> , correct?</p>



<a name="243345536"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243345536" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthijs van der Wielen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243345536">(Jun 21 2021 at 07:00)</a>:</h4>
<p>Yes, that is correct. I meant to respond to this, we are investigating why the STU3 resources has been loaded on the R4 endpoint. This should be the us-core R4 patient and not the STU3 patient. I will let you know once we've fixed this.</p>



<a name="243612534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243612534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthijs van der Wielen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243612534">(Jun 23 2021 at 06:48)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="408951">@Corey Wen</span> ,</p>
<p>One of my colleagues pointed out to me that we do have the R4 resource for the us-core-patient preloaded on our admin db. Let me explain how this works: </p>
<p><a href="http://server.fire.ly">server.fire.ly</a> by default still returns STU3.<br>
Ways to get to STU3 or R4 explicitly:</p>
<ul>
<li><a href="http://server.fire.ly/R3/">server.fire.ly/R3/</a></li>
<li><a href="http://server.fire.ly/R4/">server.fire.ly/R4/</a></li>
<li><a href="http://server.fire.ly">server.fire.ly</a>, Content-Type = application/fhir+json; fhirVersion=3.0</li>
<li><a href="http://server.fire.ly/">server.fire.ly/</a>, Content-Type = application/fhir+json; fhirVersion=4.0<br>
For more information on that please take a look at our documentation: <a href="https://docs.fire.ly/projects/Firely-Server/en/latest/features/multiversion.html">https://docs.fire.ly/projects/Firely-Server/en/latest/features/multiversion.html</a></li>
</ul>
<p>Finally, us-core Patient is loaded for both R3 and R4:<br>
&lt;base&gt;/administration/R3/StructureDefinition?url=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient<br>
&lt;base&gt;/administration/R4/StructureDefinition?url=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient<br>
Note to add /administration before the version part of the path.</p>
<p>We are working on changing the default to R4 instead of STU3. So the validation should work if you use <code>https://server.fire.ly/R4/Patient/$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code></p>



<a name="243791857"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243791857" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243791857">(Jun 24 2021 at 14:12)</a>:</h4>
<p>I tried sending a post request using Postman and unfortunately I still received the same error of <br>
<code>"Unable to resolve reference to profile 'http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient'"</code>.<br>
I have both "Content-Type" and "Accept" as <code>application/fhir+json; fhirVersion=4.0</code> and tried the post request to two endpoints, one being<br>
<code>https://server.fire.ly/R4/$validate</code> with the us-core patient in the .meta field of my Patient resource, and another endpoint<br>
<code>https://server.fire.ly/R4/Patient/$validate?profile=http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</code>.</p>



<a name="243823702"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Firely%20-%20Unable%20to%20resolve%20reference%20to%20profile/near/243823702" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mirjam Baltus <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Firely.20-.20Unable.20to.20resolve.20reference.20to.20profile.html#243823702">(Jun 24 2021 at 18:03)</a>:</h4>
<p>Sorry for the inconvenience <span class="user-mention" data-user-id="408951">@Corey Wen</span>. Usually the us-core profiles are loaded into our administration database by default after a reset, but it seems after the last one this did not happen. I have uploaded the profiles manually now, so it should work if you try again.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
