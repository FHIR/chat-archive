---
layout: page
title: "FHIR Chat  · Rewriting refs · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html">Rewriting refs</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153971257"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971257" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971257">(Jun 22 2018 at 18:14)</a>:</h4>
<p>I'm interested in walking a resource and rewriting references throughout; is there example code that would help with this kind of "dynamic" task (walking the tree of elements, re-mapping based on type)?</p>



<a name="153971266"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971266" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971266">(Jun 22 2018 at 18:27)</a>:</h4>
<p>you could use the fhirpath engine, that's what <span class="user-mention" data-user-id="191391">@Angus Millar</span> did (which gets all the extensions and contained resources) I just did the modelinfo approach, which misses those extras, but is quick with the core props</p>



<a name="153971267"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971267" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971267">(Jun 22 2018 at 18:27)</a>:</h4>
<p>Happy to share code for either/both (just not now)</p>



<a name="153971269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971269">(Jun 22 2018 at 18:30)</a>:</h4>
<p>Thanks -- <code>ModelInfo</code> looks like a great lead.</p>



<a name="153971270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971270">(Jun 22 2018 at 18:36)</a>:</h4>
<p>I think <a href="https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Support/ElementModel/ElementNode.cs#L23" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Support/ElementModel/ElementNode.cs#L23">https://github.com/ewoutkramer/fhir-net-api/blob/9c5f262cbab8200f0e82fffe3f0949a6e7120bc8/src/Hl7.Fhir.Support/ElementModel/ElementNode.cs#L23</a> may also be what I need (this is my first time looking at the library; the tests are super helpful as documentation!)</p>



<a name="153971306"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971306" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971306">(Jun 22 2018 at 20:42)</a>:</h4>
<p>Okay, so digging into <code>IElementNavigator</code>, I'm having trouble figuring out:</p>
<p>1) How to determine whether a given child is an array or single element<br>
2) How to serialize a given node and its descendants</p>
<p>Should I not have these kinds of expectations?</p>



<a name="153971344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153971344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Angus Millar <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153971344">(Jun 23 2018 at 05:17)</a>:</h4>
<blockquote>
<p>you could use the fhirpath engine, that's what <span class="user-mention" data-user-id="191391">@Angus Millar</span> did (which gets all the extensions and contained resources) I just did the modelinfo approach, which misses those extras, but is quick with the core props</p>
</blockquote>
<p>Here is a link to that code: <a href="https://github.com/angusmillar/Pyro/blob/master/Pyro.Common/Extentions/ResourceExtentions.cs" target="_blank" title="https://github.com/angusmillar/Pyro/blob/master/Pyro.Common/Extentions/ResourceExtentions.cs">https://github.com/angusmillar/Pyro/blob/master/Pyro.Common/Extentions/ResourceExtentions.cs</a></p>



<a name="153972825"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Rewriting%20refs/near/153972825" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Rewriting.20refs.html#153972825">(Jul 02 2018 at 11:49)</a>:</h4>
<blockquote>
<p>Okay, so digging into <code>IElementNavigator</code>, I'm having trouble figuring out:</p>
<p>1) How to determine whether a given child is an array or single element<br>
2) How to serialize a given node and its descendants</p>
<p>Should I not have these kinds of expectations?</p>
</blockquote>
<p>Hi Josh - you're getting into .NET I see ;-)</p>
<p>This <code>IElementNavigator</code> is absolutely the way to do it - it allows you to do this dynamic behaviour without having to deal with POCOs and thus saving the time of parsing data into POCO's - which is quite some cycles.</p>
<p>The IElementNavigator in the current version does not have a lot of type information (like whether something repeats, whether it's a cointained resource, etc), so that's also why serialization functionality is limited.  I am working on a greatly expanded set of implementations of this interface that do carry this information, including serializers that would do exactly what you need.  See here for where the action is happening:  <a href="https://github.com/ewoutkramer/fhir-net-api/tree/feature/nav-based-serialization" target="_blank" title="https://github.com/ewoutkramer/fhir-net-api/tree/feature/nav-based-serialization">https://github.com/ewoutkramer/fhir-net-api/tree/feature/nav-based-serialization</a>.</p>
<p>I hope to pull this into the main branch this month - but I am happy to discuss it with you in more detail if you need.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
