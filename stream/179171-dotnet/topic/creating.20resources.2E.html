---
layout: page
title: "FHIR Chat  · creating resources. · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html">creating resources.</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="273430454"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273430454" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Brox <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273430454">(Feb 27 2022 at 23:06)</a>:</h4>
<p>I need to create resources at runtime.  The following happens:<br>
string n = "Hl7.Fhir.R4.Core";<br>
string c = "Person";<br>
var myObj = Activator.CreateInstance(n, c);</p>
<p>System.TypeLoadException<br>
  HResult=0x80131522<br>
  Message=Could not load type 'Person' from assembly 'Hl7.Fhir.R4.Core, Version=3.8.0.0, Culture=neutral, PublicKeyToken=d706911480550fc3'.</p>
<p>Is this a constructor problem or something I'm missing in C#.  It has obviously found the dll correctly.</p>



<a name="273461959"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273461959" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273461959">(Feb 28 2022 at 09:10)</a>:</h4>
<p>To test things out, just create a new person normally (verifying that the assemblies are all loaded) then see if your code works...</p>



<a name="273508493"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273508493" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273508493">(Feb 28 2022 at 15:44)</a>:</h4>
<p>Hi Dennis, there are some utilities in the <code>Hl7.Fhir.Model.ModelInfo</code> class to make these types of operations easier:</p>
<div class="codehilite" data-code-language="C#"><pre><span></span><code><span class="kt">string</span><span class="w"> </span><span class="n">ft</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"Person"</span><span class="p">;</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(!</span><span class="n">Hl7</span><span class="p">.</span><span class="n">Fhir</span><span class="p">.</span><span class="n">Model</span><span class="p">.</span><span class="n">ModelInfo</span><span class="p">.</span><span class="n">FhirTypeToCsType</span><span class="p">.</span><span class="n">ContainsKey</span><span class="p">(</span><span class="n">ft</span><span class="p">))</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">Exception</span><span class="p">(</span><span class="s">$"{ft} is not a valid FHIR Type"</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">var</span><span class="w"> </span><span class="n">typed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Activator</span><span class="p">.</span><span class="n">CreateInstance</span><span class="p">(</span><span class="n">Hl7</span><span class="p">.</span><span class="n">Fhir</span><span class="p">.</span><span class="n">Model</span><span class="p">.</span><span class="n">ModelInfo</span><span class="p">.</span><span class="n">FhirTypeToCsType</span><span class="p">[</span><span class="n">ft</span><span class="p">]);</span><span class="w"></span>
</code></pre></div>



<a name="273560114"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273560114" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Brox <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273560114">(Feb 28 2022 at 21:58)</a>:</h4>
<p>Two nice FhirType functions but CreateInstance works C# normally doesn't work i.e. it  creates a resource nicely, the class  has values like a resource I create normally, GetType returns the same values.  But there is no constructor i.e. I can't assign property values to it.</p>



<a name="273561185"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273561185" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273561185">(Feb 28 2022 at 22:06)</a>:</h4>
<p>I am unclear on what you are trying to do.  If you are asking about code-completion, yes a <code>var</code> type from <code>Activator.CreateInstance</code> will not know what you are doing.</p>
<p>If you know the type at compile-time, you can just use <code>new Hl7.Fhir.Model.Person()</code> to create the instance.</p>



<a name="273724534"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273724534" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Dennis Brox <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273724534">(Mar 01 2022 at 22:59)</a>:</h4>
<p>I'm trying to create a FHIR class  at runtime where all I know is the class name i.e. a string "Person" and assign it  values when it is created. Why else would you use CreateInstance?  I want to handle values in a dictionary in one line generically instead of using scads of cases in a switch statement.    On another "Type" issue, how do convert Address.Line to some type I can use in C#? I created it as a string [] but I can't get it back as either an array or a list.</p>



<a name="273734771"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/creating%20resources./near/273734771" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/creating.20resources.2E.html#273734771">(Mar 02 2022 at 00:36)</a>:</h4>
<p>When I do this I'm using the ClassMapping and PropertyMapping classes to manipulate things.<br>
Otherwise you could just do regular dotnet reflection.<br>
That's a pretty advanced part of the libs, and you'd want to understand what's going on internally to ensure that you know how things might break into the future.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
