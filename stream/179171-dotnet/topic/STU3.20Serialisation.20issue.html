---
layout: page
title: "FHIR Chat  · STU3 Serialisation issue · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html">STU3 Serialisation issue</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153903723"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903723" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903723">(Aug 25 2017 at 13:18)</a>:</h4>
<p>I'm using the latest STU3 NuGet package in a small demo app.</p>
<p>The App creates its own version of "Bundle" inherited from the core Bundle</p>
<div class="codehilite"><pre><span></span>   public class ITKBundle : Bundle
  {
    .....
  }
</pre></div>


<p>Later on it attempts to serialise this to XML using </p>
<div class="codehilite"><pre><span></span>  FhirSerializer.SerializeResourceToXml(xx);
</pre></div>


<p>When it does this I get an error as attached. Any clues what I am doing wrong....</p>
<p><a href="/user_uploads/10155/VKecIypVYOD20IszRUIDqw4P/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a></p>
<div class="message_inline_image"><a href="/user_uploads/10155/VKecIypVYOD20IszRUIDqw4P/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/VKecIypVYOD20IszRUIDqw4P/pasted_image.png"></a></div>



<a name="153903724"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903724" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903724">(Aug 25 2017 at 13:31)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191362">@Richard Kavanagh</span>, I'm not sure if the API serializer supports derived classes. Apparently not...</p>



<a name="153903726"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903726" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903726">(Aug 25 2017 at 13:34)</a>:</h4>
<p>It would appear not :-)  Will have to think of a way around this. My "derived class" just has a bunch of helper methods so I'd hoped it would work</p>



<a name="153903727"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903727" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903727">(Aug 25 2017 at 13:36)</a>:</h4>
<p>I can reproduce the exception in a unit test. Let me check if there's a workaround...</p>



<a name="153903728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903728">(Aug 25 2017 at 13:40)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="191362">@Richard Kavanagh</span>, try to add the following attribute to your derived class:</p>
<p><code>[Hl7.Fhir.Introspection.FhirType("Bundle", IsResource = true)]</code></p>
<p>Now serialization should work.</p>



<a name="153903729"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903729" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903729">(Aug 25 2017 at 13:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> Thanks for the suggestion, unfortunately it did not work..</p>



<a name="153903730"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903730" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903730">(Aug 25 2017 at 14:02)</a>:</h4>
<p>I can succesfully run the following logic:</p>
<div class="codehilite"><pre><span></span>[FhirType(&quot;Bundle&quot;, IsResource = true)]
public class CustomBundle : Bundle
{
    public CustomBundle() : base() { }
}

[TestMethod]
public void TestDerivedPoCoSerialization()
{
    var bundle = new CustomBundle()
    {
        Type = Bundle.BundleType.Collection,
        Id = &quot;MyBundle&quot;
    };

    var xml = FhirSerializer.SerializeResourceToXml(bundle);
    Assert.IsNotNull(xml);

    var json = FhirSerializer.SerializeResourceToJson(bundle);
    Assert.IsNotNull(json);
}
</pre></div>



<a name="153903731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903731">(Aug 25 2017 at 14:03)</a>:</h4>
<p>Maybe you should also add [DataContract] attribute, but in my quick test, this didn't seem to be necessary.</p>



<a name="153903732"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903732" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903732">(Aug 25 2017 at 14:04)</a>:</h4>
<p>BTW You should also add the [NotMapped] attribute to all public (helper) members that you add.</p>



<a name="153903733"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903733" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903733">(Aug 25 2017 at 14:18)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> perfect! it was the [NotMapped] I was missing.</p>



<a name="153903734"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153903734" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153903734">(Aug 25 2017 at 14:18)</a>:</h4>
<p><img alt=":+1:" class="emoji" src="/static/generated/emoji/images/emoji/unicode/1f44d.png" title=":+1:"></p>



<a name="153904499"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153904499" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Christiaan Knaap <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153904499">(Sep 05 2017 at 17:41)</a>:</h4>
<p>And if the helper methods do not require state  besides what is already in the Bundle, you could use extension methods. Then you don't need a derived class at all.</p>



<a name="153904527"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/STU3%20Serialisation%20issue/near/153904527" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/STU3.20Serialisation.20issue.html#153904527">(Sep 05 2017 at 22:24)</a>:</h4>
<p>Yeah, missing the NotMapped attribute when developers add stuff to it makes things awkward.<br>
Also, when deserializing it won't use your class. Especially if you want to have multiple derived bundle types for different purposes.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
