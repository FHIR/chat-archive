---
layout: page
title: "FHIR Chat  · API Validation Query · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html">API Validation Query</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="153910127"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910127" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910127">(Sep 24 2017 at 19:05)</a>:</h4>
<p>I am using the.NET API to validate a STU3 message bundle. </p>
<p>The results of the validation are mixed and the errors shown look to be valid in that we can understand why they have been identified.</p>
<p>Looking at the output the following is seen.</p>
<p><a href="/user_uploads/10155/rzdpno0xs6PXKZ7UIa7LLtiK/pasted_image.png" target="_blank" title="pasted_image.png">pasted image</a> </p>
<p>It appears as if the API is failing on aspects of the terminology validation but this is not making it to the validation result. </p>
<p>Is this an error in the .NET API code?</p>
<div class="message_inline_image"><a href="/user_uploads/10155/rzdpno0xs6PXKZ7UIa7LLtiK/pasted_image.png" target="_blank" title="pasted image"><img src="/user_uploads/10155/rzdpno0xs6PXKZ7UIa7LLtiK/pasted_image.png"></a></div>



<a name="153910128"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910128" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910128">(Sep 24 2017 at 19:36)</a>:</h4>
<p>.NeE FHIR Client nugget package can validate extensional ValueSet specified in spec. The error says that the valueset it is trying to validate is too complex for the client package to handle. To validate against such complex ValueSet, you have use a  terminology server.</p>



<a name="153910129"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910129" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910129">(Sep 24 2017 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="191506">@Yunwei Wang</span> I appreciate that that's the case. My issue is that the validation result returned was positive - surely if the terminology validation failed then the validation result should take this into account.</p>



<a name="153910133"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910133" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910133">(Sep 24 2017 at 21:04)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> Are you using a FHIR server to do the validation or Fhir Client library?</p>



<a name="153910139"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910139" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910139">(Sep 24 2017 at 21:48)</a>:</h4>
<p>It the FHIR Client library. All the work is local no FHIR servers are involved.</p>



<a name="153910140"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910140" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910140">(Sep 24 2017 at 21:56)</a>:</h4>
<p>The problem is the library doesn't know how to validate that value set.</p>



<a name="153910141"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910141" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910141">(Sep 24 2017 at 21:59)</a>:</h4>
<p>Yes, I'm fine with that. The issue is that as the valuesets cannot be expanded and hence the codes validated - the validation of the instance should fail. Yet the failed terminology validations appears to be silent and does not impact the overall validation status.</p>



<a name="153910151"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910151" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910151">(Sep 25 2017 at 02:09)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> do you know which valueset validation failed?</p>



<a name="153910163"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910163" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910163">(Sep 25 2017 at 04:57)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> this is a common argument with regard to terminology validation. Some of us thing that it should fail to error, and some of us think it should fail to no error.</p>



<a name="153910164"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910164" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910164">(Sep 25 2017 at 04:58)</a>:</h4>
<p>On the java validator, this is a setting</p>



<a name="153910169"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910169" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910169">(Sep 25 2017 at 05:59)</a>:</h4>
<p>This is up to the terminology service class that you pass as a reference to the validator in .net<br>
Then it depends what you do in that class that counts.<br>
(My server has a local implementation that fails to the dotnet one that Ewout ported)</p>



<a name="153910170"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910170" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910170">(Sep 25 2017 at 06:00)</a>:</h4>
<p>You can of course pass in a reference to the <code>ExternalTerminologyService</code> class to use too.<br>
(and make it a problem for a real terminology service implementation)</p>



<a name="153910215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910215">(Sep 25 2017 at 10:05)</a>:</h4>
<p>to me the question is not really about where the terminology service occurs. It's what happens when it fails. If an intrinsic part of a validation process can fail and not be signalled then that's worrying. I had hoped the.NET API would cater for this. It appears that the JAVA equivalent controls this through config which appears sensible. Is there a reason why the .NET version did not take the same approach?</p>



<a name="153910219"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910219" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910219">(Sep 25 2017 at 10:12)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> reason being it is still a work in progress. IMHO validation needs to use three-way logic (correct | incorrect | undetermined) everywhere. Then clients can determine how to deal with indeterminate validation results (i.e. accept or reject).</p>



<a name="153910250"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910250" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910250">(Sep 25 2017 at 12:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> I agree but unfortunately at this point in time that's not on the table. From an implementation perspective it's looking like we will need to move certain processes towards JAVA which is not really where I'd planned to be at this point.</p>



<a name="153910264"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910264" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910264">(Sep 25 2017 at 12:21)</a>:</h4>
<p>Ouch, did you just mention the J-word in this stream...?</p>
<p>I think that with some small temporary tweaks and/or additional config settings, we should be able to let the .NET validator fail in case of missing (ValueSet) dependencies, so you can safely deploy it within your production environment.<br>
Then we can take some time to discuss proper validator improvements (i.e. 3-way logic) within the community and harmonize API behavior.</p>



<a name="153910272"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910272" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910272">(Sep 25 2017 at 12:28)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span>  it hurts me a lot but it's the obvious way forward at the moment. It's going to be a tricky manoeuvre getting out of this which runs the risk of baking in a direction of travel for some time. It's not really where I hoped we'd be.</p>



<a name="153910437"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910437" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910437">(Sep 25 2017 at 14:34)</a>:</h4>
<p>I read through the source code for .NET validator. Interesting, I noticed the error is suppressed for non required bindings. And for required binding, my understanding about the source code is that the validator should return validator error in OperationOutcome.</p>



<a name="153910439"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910439" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Yunwei Wang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910439">(Sep 25 2017 at 14:34)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> that is why I want to know if you know which value set failed. If it is non-required binding. Maybe that is the reason.</p>



<a name="153910612"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910612" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910612">(Sep 26 2017 at 07:51)</a>:</h4>
<blockquote>
<p>Yes, I'm fine with that. The issue is that as the valuesets cannot be expanded and hence the codes validated - the validation of the instance should fail. Yet the failed terminology validations appears to be silent and does not impact the overall validation status.</p>
</blockquote>
<p>It's not obvious to me that this should be a failure - I've flip-flopped a few times, since there are arguments both ways, so I can confirm what Grahame says. As Yunwei said, I have settled on an approach where required bindings report an error, and others a warning. </p>
<p>That said, it's preferable that the .NET and Java API handle things the same way.  I am not a fan of a setting - although it's easy to do and you could simply add a suggestion for enhancement to the .NET API Github issue list.  The idea that -depending on the setting- some servers will validate your instance as correct and others as incorrect feels wrong.</p>
<p>I feel that the problem lies deeper: the current validator (and probably the Java one too) either determines something is valid or invalid - but there are cases (not just this one BTW), where the outcome is "undetermined".  I initially did not choose to go this way - since it might be unclear to the user, but it's issues like these that maybe proof we do need to introduce "undetermined" outcomes.</p>



<a name="153910613"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/API%20Validation%20Query/near/153910613" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/API.20Validation.20Query.html#153910613">(Sep 26 2017 at 07:53)</a>:</h4>
<blockquote>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span>  it hurts me a lot but it's the obvious way forward at the moment. It's going to be a tricky manoeuvre getting out of this which runs the risk of baking in a direction of travel for some time. It's not really where I hoped we'd be.</p>
</blockquote>
<p>If you'd need it as a setting to sooth the pain - feel free to ask!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
