---
layout: page
title: "FHIR Chat  · FHIRPath slice() in .NET FHIR API · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIRPath.20slice().20in.20.2ENET.20FHIR.20API.html">FHIRPath slice() in .NET FHIR API</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="240855004"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIRPath%20slice%28%29%20in%20.NET%20FHIR%20API/near/240855004" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Smirnov <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIRPath.20slice().20in.20.2ENET.20FHIR.20API.html#240855004">(May 31 2021 at 17:10)</a>:</h4>
<p>Hello!</p>
<p>We found the slice() function implementation missing in current .NET FHIR API, and are attempting to write our own. We found we can add to the DefaultSymbolTable that is declared public on FhirPathCompiler. In principle, it should be possible to add any custom function this way.</p>
<p>However, implementing slice() requires that the code handling this function call would have access to the path within the context resource of the element on which the function is being called. For example, say, we're evaluating "Observation.component.slice('<a href="http://profileUrl">http://profileUrl</a>', 'systolic').value". The callback behind the slice() would need to resolve the StructureDefinition by its url, then navigate to the element id given by current resource path at the point of invocation (in this case, "Observation.component"), then read its slicing definition and locate the necessary child node of the context resource based on discriminator.</p>
<p>Is there any way in current .NET FHIR API to access current context element path from within the delegate implementing a fhirpath function? So far my understanding there isn't, and it would require modifications to the library itself. Is this one of the reasons why slice() wasn't implemented yet, unlike all the other functions?</p>



<a name="240874962"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIRPath%20slice%28%29%20in%20.NET%20FHIR%20API/near/240874962" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIRPath.20slice().20in.20.2ENET.20FHIR.20API.html#240874962">(May 31 2021 at 22:04)</a>:</h4>
<p>The reason it's not implemented as there are multiple ways to do it, and specifically as it reaches outside the instance.<br>
The path is available to the instance through the wrapper classes and interfaces that the fhirpath engine uses.<br>
I'll have to go look it up to work it out.<br>
I've done this for several other things in the fhirpathtester app.</p>



<a name="240920507"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIRPath%20slice%28%29%20in%20.NET%20FHIR%20API/near/240920507" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Smirnov <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIRPath.20slice().20in.20.2ENET.20FHIR.20API.html#240920507">(Jun 01 2021 at 10:12)</a>:</h4>
<p><span class="user-mention" data-user-id="191367">@Brian Postlethwaite</span> thank you for reference to fhirpath tester! We looked up in your code, and turns out fhirpath function delegates operate on instances of ITypedElement, which has the property Location containing current element path.</p>



<a name="240926416"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/FHIRPath%20slice%28%29%20in%20.NET%20FHIR%20API/near/240926416" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/FHIRPath.20slice().20in.20.2ENET.20FHIR.20API.html#240926416">(Jun 01 2021 at 11:17)</a>:</h4>
<p>Yup, that's exactly right.<br>
You can also see how I added some other functions in there like short path and commonpath for some custom stuff for myself.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
