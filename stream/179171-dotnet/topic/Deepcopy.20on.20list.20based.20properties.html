---
layout: page
title: "FHIR Chat  · Deepcopy on list based properties · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html">Deepcopy on list based properties</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="154016695"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154016695" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffy Mathew Jose <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154016695">(Nov 08 2018 at 15:02)</a>:</h4>
<p>I was trying to use Resource.CopyTo to merge few resources, but stumbled on copying null or empty properties</p>
<p>If a resource has a uninitialized property which is a list , say Identifier, the identifier on target resource is replaced with a new empty list.<br>
This is surprising given that , if it some other kind of property, say Code, the code on target is replaced only if code is not null.<br>
Upon digging deeper, I found that list property is always initialized to an empty list if null.<br>
 - Either, we should check null on underlying backing field before copying<br>
 - Or, we should check for null or empty on property which are of type list</p>
<p>Thoughts?</p>



<a name="154016891"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154016891" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154016891">(Nov 08 2018 at 21:05)</a>:</h4>
<p>Currently, copying literally means overwriting what is in the target, but I can see the usefulness of doing more like a merge.  For lists however, you'll always have the problem of deciding whether you want to replace or append, and depending on your use case you'll want one or the other.  We could enable the other behaviour by introducing a MergeInto() or somesuch.  That operation will almost surely need be controlled by Annotations on the elements to have finegrained control over what to do with lists.</p>



<a name="154017055"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154017055" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffy Mathew Jose <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154017055">(Nov 09 2018 at 07:12)</a>:</h4>
<p>If Copyto meant overwriting, why do the properties have a null check before copying? <br>
Different behavior  for list and non-list properties is what stumbled me.<br>
List properties will never be null and the check for null during CopyTo is misleading</p>
<p>Btb, I think "merge" was a strong word. I was trying something simpler(kind of overwriting).<br>
I had a template instance with some desired properties(say X) which I copy to a target instance which had other properties(say Y) set. Now If Y was of type list, the CopyTo operation will clear Y.</p>



<a name="154017096"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154017096" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154017096">(Nov 09 2018 at 10:01)</a>:</h4>
<p>Hmm, interesting observation. Current implementations of <code>CopyTo</code> only copy non-empty values to the target, i.e. remaining any target property values remain untouched. This seems more of a "merge" operation, whereas copy implies to me that the final target will be exactly equal to source - which isn't the case right now. Maybe we should remove the null checks alltogether and ensure that <code>target.IsExactly(source)</code> after a <code>CopyTo</code> operation?</p>



<a name="154017419"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154017419" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Postlethwaite <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154017419">(Nov 10 2018 at 23:45)</a>:</h4>
<p>It is, provided it was empty to start ;)</p>



<a name="154017591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154017591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jeffy Mathew Jose <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154017591">(Nov 12 2018 at 11:14)</a>:</h4>
<p>...which is true only when used by DeepCopy. Was the "CopyTo" operation meant to be private/internal helper function?</p>



<a name="154019589"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Deepcopy%20on%20list%20based%20properties/near/154019589" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Deepcopy.20on.20list.20based.20properties.html#154019589">(Nov 19 2018 at 15:41)</a>:</h4>
<p>I guess.  I created it, but that's years ago when I was still a virgin API developer ;-)   Now, what do we do with it?  [Obsolete] it and think about stuff we'd really want it to do?</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
