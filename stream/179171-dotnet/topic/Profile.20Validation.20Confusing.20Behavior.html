---
layout: page
title: "FHIR Chat  · Profile Validation Confusing Behavior · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html">Profile Validation Confusing Behavior</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="173900535"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/173900535" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#173900535">(Aug 22 2019 at 17:03)</a>:</h4>
<p>I have four custom StructureDefinitions  in my DirectorySource</p>
<p>1. PkPatient.StructureDefinition.xml (has extension PkCnic.StructureDefinition.xml with cardinality 1..1 )<br>
2. PkCnic.StructureDefinition.xml<br>
3. UsPatient.StructureDefinition.xml (has extension UsSsn.StructureDefinition.xml  with cardinality 1..1 )<br>
4. UsSsn.StructureDefinition.xml          <br>
ISSUE:<br>
1. PkPatient profile is in the meta of patient resource<br>
2. PkCnic extension is in the patient resource<br>
3. But the validation result of the patient resource is with UsPatient profile is "OVERALL SUCCESS"<br>
4. Why this is giving me success result? while validating with UsPatient profile? I have never added UsSsn extention in the patient resource<br>
5. It shouldn't give a validation error?<br>
here is my code</p>
<div class="codehilite"><pre><span></span>        Patient patient = new Patient();
        patient.Meta = new Meta
        {
            Profile = new List&lt;string&gt;
            {
                &quot;http://example.org/fhir/StructureDefinition/PkPatient&quot;
            }
        };
        patient.Id = &quot;1&quot;;
        patient.Gender = AdministrativeGender.Male;
        patient.Active = true;
        HumanName hn = new HumanName();
        hn.Family = &quot;Jhon&quot;;
        hn.Given = new List&lt;string&gt; { &quot;Doe&quot; };
        patient.Name.Add(hn);
        patient.AddExtension(&quot;http://example.org/fhir/StructureDefinition/PkCnic&quot;, new FhirString(&quot;123456789&quot;));



        ZipSource zipSource = new ZipSource(&quot;&lt;path&gt;\\specification.zip&quot;); 
        DirectorySource directorySource = new DirectorySource(&quot;&lt;path&gt;&quot;); // FOLDER CONTAINS CUSTOM STRUCTURE DEFINITIONS


        Validator validator = new Validator(new ValidationSettings
        {
            ResourceResolver = new MultiResolver(zipSource, directorySource)
        });


        OperationOutcome operationOutcome = validator.Validate(patient, &quot;http://example.org/fhir/StructureDefinition/UsPatient&quot;);
</pre></div>



<a name="173953488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/173953488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#173953488">(Aug 23 2019 at 09:06)</a>:</h4>
<p><span class="user-mention" data-user-id="191328">@Ewout Kramer</span> ?</p>



<a name="174888563"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/174888563" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#174888563">(Sep 04 2019 at 14:44)</a>:</h4>
<p>Any update?</p>



<a name="174900270"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/174900270" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#174900270">(Sep 04 2019 at 16:52)</a>:</h4>
<p>So my understanding is as follows:</p>
<ul>
<li>
<p>Extensions are by default permitted anywhere within a profile even if not explicitly added. When validation occurs as long as the profile for any extensions used can be located then the validation will happen.</p>
</li>
<li>
<p>By explicitly adding an extension to the profile, you can choose to make extensions mandatory etc and it is probably good practice but if they are optional you don't need to do so.</p>
</li>
</ul>
<p>Slightly different question but this may help <a href="#narrow/stream/179175-argonaut/topic/Extensions.20.26.20Profiles" title="#narrow/stream/179175-argonaut/topic/Extensions.20.26.20Profiles">https://chat.fhir.org/#narrow/stream/179175-argonaut/topic/Extensions.20.26.20Profiles</a></p>



<a name="175372305"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175372305" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175372305">(Sep 10 2019 at 19:53)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> I understand that extensions are permitted without the inclusion of profile in the meta.</p>
<p>What I am curious about is, that I am getting validation success against the profile whose mandatory extension (1..1) is not included in the resource!</p>
<p>Why validation success if the extension is specified mandatory in the profile but not included in the resource?</p>



<a name="175518971"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175518971" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175518971">(Sep 12 2019 at 11:16)</a>:</h4>
<p>Sounds like you found a bug. Could you submit an issue to:<br>
<a href="https://github.com/FirelyTeam/fhir-net-api/issues/" target="_blank" title="https://github.com/FirelyTeam/fhir-net-api/issues/">https://github.com/FirelyTeam/fhir-net-api/issues/</a><br>
Please attach the profile &amp; extension if possible, so we can reproduce the issue.</p>



<a name="175519237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175519237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175519237">(Sep 12 2019 at 11:21)</a>:</h4>
<p><span class="user-mention" data-user-id="191362">@Richard Kavanagh</span> <br>
<span class="user-mention" data-user-id="191336">@Michel Rutten</span> </p>
<p>UPDATE:</p>
<p>I got the expected result. </p>
<p>This is how I got the expected result.</p>
<p>I was just constraining the cardinality inside the extension structureDefinition and in the patient structureDefinition for the extension.</p>
<p>I also had to check the "Must Support" attribute for the value[x] of the extension inside the custom patient profile.</p>
<p>now it is giving me error of cardinality that there must be  (1..1 something.........) this is what I was expecting.</p>
<p>if for making an extension mandatory we must have to check the "Must Support" for the value[x] then this is not bug.</p>
<p>If only setting the cardinality is the requirement for making mandatory extension then it is bug.</p>
<p>Now please review the situation.</p>



<a name="175519336"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175519336" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175519336">(Sep 12 2019 at 11:23)</a>:</h4>
<p>MustSupport is separate from cardinality, one constraint should not affect validation of the other.</p>



<a name="175519342"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175519342" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michel Rutten <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175519342">(Sep 12 2019 at 11:23)</a>:</h4>
<p>Still sounds like a bug</p>



<a name="175519488"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175519488" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175519488">(Sep 12 2019 at 11:25)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span> alright I will post the issue.</p>
<p>yes for sure I'll attach the profiles so you can reproduce the issue.</p>
<p>I was just playing around the FHIR profiling. So these are just testing profiles.</p>



<a name="175521790"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175521790" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175521790">(Sep 12 2019 at 12:01)</a>:</h4>
<p><span class="user-mention" data-user-id="191336">@Michel Rutten</span>  here is the issue <br>
<a href="https://github.com/FirelyTeam/fhir-net-api/issues/1109" target="_blank" title="https://github.com/FirelyTeam/fhir-net-api/issues/1109">https://github.com/FirelyTeam/fhir-net-api/issues/1109</a></p>



<a name="175534478"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175534478" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Richard Kavanagh <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175534478">(Sep 12 2019 at 14:31)</a>:</h4>
<p>Well, I've had a play with the code supplied and I'm stumped....</p>



<a name="175547778"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175547778" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175547778">(Sep 12 2019 at 16:52)</a>:</h4>
<p>thanks <span class="user-mention" data-user-id="193100">@Muhammad Abubakar</span> for the clear bug description you created.</p>



<a name="175551066"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Profile%20Validation%20Confusing%20Behavior/near/175551066" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Muhammad Abubakar Ikram <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Profile.20Validation.20Confusing.20Behavior.html#175551066">(Sep 12 2019 at 17:27)</a>:</h4>
<p>Welcome, I would be happy if some little contribution from my side can help us all.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
