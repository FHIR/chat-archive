---
layout: page
title: "FHIR Chat  · Patient Coverage · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html">Patient Coverage</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="219359360"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219359360" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219359360">(Dec 09 2020 at 16:18)</a>:</h4>
<p>I'm trying to get patient coverage using the following route:</p>
<p>Header:<br>
Bearer Token &lt;Access Token&gt;<br>
GET: <a href="https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4/Coverage?patient=&lt;patient">https://apporchard.epic.com/interconnect-aocurprd-oauth/api/FHIR/R4/Coverage?patient=&lt;patient</a> id&gt;</p>
<p>I was able to get the access token from using the following route:</p>
<p>POST: <a href="https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token">https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token</a><br>
Body:<br>
grant_type = client_credentials<br>
client_assertion_type = urn:ietf:params:oauth:client-assertion-type:jwt-bearer<br>
client_assertion = &lt;client assertion token&gt;</p>
<p>For some reason when I tried calling coverage route, I always get a 401.  The test user I'm using has an Aetena plan.  Is there something I'm missing?</p>



<a name="219361715"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219361715" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219361715">(Dec 09 2020 at 16:33)</a>:</h4>
<p>I think the problem is that you are using a <a href="http://fhir.epic.com">fhir.epic.com</a> token against an AppOrchard end point - they are two different systems. You should either use the <a href="http://fhir.epic.com">fhir.epic.com</a> end point or get a token from AppOrchard</p>



<a name="219367476"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219367476" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219367476">(Dec 09 2020 at 17:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191912">Michele Mottini</span> <a href="#narrow/stream/179171-dotnet/topic/Patient.20Coverage/near/219361715">said</a>:</p>
<blockquote>
<p>I think the problem is that you are using a <a href="http://fhir.epic.com">fhir.epic.com</a> token against an AppOrchard end point - they are two different systems. You should either use the <a href="http://fhir.epic.com">fhir.epic.com</a> end point or get a token from AppOrchard</p>
</blockquote>
<p>I don't see an endpoint for patient coverage on <a href="http://fhir.epic.com">fhir.epic.com</a>.  Is there one?  If so, where is the documentation?</p>
<p>I've looked at <a href="https://fhir.epic.com/Specifications?api=1076">https://fhir.epic.com/Specifications?api=1076</a> but I don't see an endpoint on this page.</p>



<a name="219368591"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219368591" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219368591">(Dec 09 2020 at 17:22)</a>:</h4>
<p>I don't know - if it does not have Coverage you'll have to get an AppOrchard token</p>



<a name="219369634"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219369634" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219369634">(Dec 09 2020 at 17:30)</a>:</h4>
<p>Thanks.  I'll try to look into AppOrchard.</p>



<a name="219381564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219381564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Cooper Thompson <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219381564">(Dec 09 2020 at 18:58)</a>:</h4>
<p>Coverage is available in fhir.epic.  You can just use the normal R4 fhir.epic endpoint:  <a href="https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=patientID">https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=patientID</a>.  We don't have the "Try It" available for it yet, so you won't see the template URL in the Try It utility.</p>



<a name="219397237"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/219397237" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#219397237">(Dec 09 2020 at 21:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191764">Cooper Thompson</span> <a href="#narrow/stream/179171-dotnet/topic/Patient.20Coverage/near/219381564">said</a>:</p>
<blockquote>
<p>Coverage is available in fhir.epic.  You can just use the normal R4 fhir.epic endpoint:  <a href="https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=patientID">https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=patientID</a>.  We don't have the "Try It" available for it yet, so you won't see the template URL in the Try It utility.</p>
</blockquote>
<p>I tried this but I'm getting a 401 Forbidden.  Could it be a permission issue with the patient profile or my app (backend and patients)?</p>



<a name="220001177"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/220001177" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#220001177">(Dec 15 2020 at 16:11)</a>:</h4>
<p>I was able to get the Coverage data from <a href="https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=&lt;patient">https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=&lt;patient</a> id&gt; but  I'm having trouble finding the Coverage.SearchResponse model from Hl7.Fhir.Model to map with the response data from <a href="https://fhir.epic.com/Specifications?api=1078">https://fhir.epic.com/Specifications?api=1078</a></p>
<p>Does anyone know if there is a model I can use or should I just build my own?  I tried using Hl7.Fhir.Model.Coverage but that doesn't work since the properties are different.</p>



<a name="220003269"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/220003269" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#220003269">(Dec 15 2020 at 16:22)</a>:</h4>
<p><code> https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4/Coverage?patient=&lt;patient id&gt;</code> will return a Bundle containing Coverage resources, so you should use Hl7.Fhir.Model.Bundle</p>



<a name="220006059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/220006059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#220006059">(Dec 15 2020 at 16:39)</a>:</h4>
<p>I'm getting this error when I try to deserialize the response using Newtonsoft.Json.JsonCovert.</p>
<p><code>Could not create an instance of type Hl7.Fhir.Model.Resource. Type is an interface or abstract class and cannot be instantiated. Path 'entry[0].resource.resourceType', line 1, position 503.</code></p>
<p>Could the problem be the Newtonsoft deserializer?</p>
<div class="codehilite" data-code-language="C#"><pre><span></span><code><span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">Bundle</span><span class="p">&gt;(</span><span class="n">responseContent</span><span class="p">)</span>
</code></pre></div>



<a name="220006330"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/220006330" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#220006330">(Dec 15 2020 at 16:41)</a>:</h4>
<p>You cannot use Newtonsoft deserializers, use the Hl7.Fhir ones. If you use the client in Fhir .NET library you do not even have to invoke the deserialization manually</p>



<a name="220009399"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/Patient%20Coverage/near/220009399" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ger Vang <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/Patient.20Coverage.html#220009399">(Dec 15 2020 at 17:02)</a>:</h4>
<p>That did the trick! Thank you.</p>
<p>In case someone ran into the same issues as me, here is an example: <br>
<a href="https://stackoverflow.com/questions/49314247/how-to-deserialise-json-to-fhir-valueset-resource-in-net">https://stackoverflow.com/questions/49314247/how-to-deserialise-json-to-fhir-valueset-resource-in-net</a></p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
