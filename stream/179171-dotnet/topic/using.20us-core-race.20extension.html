---
layout: page
title: "FHIR Chat  · using us-core-race extension · dotnet"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/index.html">dotnet</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html">using us-core-race extension</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="247377765"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247377765" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erez Shalom <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247377765">(Jul 27 2021 at 19:13)</a>:</h4>
<p>Hello everyone,<br>
One of the business cases of my clients is delivering patient's  "race". I was thinking to tell him to use the US Core patient profile because it has the "us-core-race" extension. This data will be transmitted as FHIR JSON to our side.<br>
We use the <a href="http://dot.net">dot.net</a> library to parse this JSON (which is not aimed to support specific profiles), thus I have a doubt if this library can parse the  "us-core-race" extension. will I be able to parse it with the dotnet library? if not, what are my options?</p>



<a name="247383065"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247383065" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247383065">(Jul 27 2021 at 19:59)</a>:</h4>
<p>Yes, the standard .net library will handle that extension just fine</p>



<a name="247383090"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247383090" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gino Canessa <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247383090">(Jul 27 2021 at 19:59)</a>:</h4>
<p>Hi Erez, I assume you are referring to the <a href="https://github.com/FirelyTeam/firely-net-sdk">Firely Net SDK</a> (e.g., NuGet package Hl7.Fhir.R4)?  If so, you can use the <a href="https://hl7.org/fhir/us/core/StructureDefinition-us-core-race.html">US Core Race</a> extension with the library.</p>
<p>There is a documentation page on <a href="https://docs.fire.ly/projects/Firely-NET-SDK/model/extensions.html">extensions</a> that has the basic syntax you will need.  For that particular extension (by coincidence), I have some example code as well.  <a href="https://github.com/GinoCanessa/FHIR-CS-Profiling-Basic/blob/main/src/UsCore/UsCoreRace.cs">UsCoreRace.cs</a> has an extension class for <code>Patient</code>, which allows for code like:</p>
<div class="codehilite" data-code-language="C#"><pre><span></span><code><span class="n">Patient</span> <span class="n">patient</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Patient</span><span class="p">();</span>
<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceSet</span><span class="p">(</span>
    <span class="s">"Race default text"</span><span class="p">,</span>
    <span class="k">new</span> <span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">[]</span> <span class="p">{</span> <span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">.</span><span class="n">Unknown</span> <span class="p">});</span>

<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceTextSet</span><span class="p">(</span><span class="s">"Updated text"</span><span class="p">);</span>

<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceOmbCategoryAdd</span><span class="p">(</span><span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">.</span><span class="n">AmericanIndianOrAlaskaNative</span><span class="p">);</span>
<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceOmbCategoryAdd</span><span class="p">(</span><span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">.</span><span class="n">AmericanIndianOrAlaskaNative</span><span class="p">);</span>
<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceOmbCategoryAdd</span><span class="p">(</span><span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">.</span><span class="n">Asian</span><span class="p">);</span>
<span class="n">patient</span><span class="p">.</span><span class="n">UsCoreRaceOmbCategoryAdd</span><span class="p">(</span><span class="n">UsCoreRace</span><span class="p">.</span><span class="n">UsCoreOmbRaceCategoryValues</span><span class="p">.</span><span class="n">Unknown</span><span class="p">);</span>
</code></pre></div>
<p>That <a href="https://github.com/GinoCanessa/FHIR-CS-Profiling-Basic">repo</a> has links to some videos walking through how that code was written. (edit: which can serve as a more detailed walkthrough of using extensions with C# code)</p>



<a name="247722745"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247722745" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247722745">(Jul 30 2021 at 15:25)</a>:</h4>
<p>This is what I used to parse US Core Race. Any one see any issues with this?</p>
<div class="codehilite" data-code-language="C#"><pre><span></span><code><span class="kt">var</span> <span class="n">raceValues</span> <span class="p">=</span> <span class="n">castResource</span><span class="p">.</span><span class="n">Extension</span>
    <span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Url</span> <span class="p">==</span> <span class="s">"http://hl7.org/fhir/us/core/StructureDefinition/us-core-race"</span><span class="p">)</span>
    <span class="p">.</span><span class="n">SelectMany</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Extension</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Value</span> <span class="k">is</span> <span class="n">Coding</span><span class="p">)</span>
    <span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Value</span> <span class="k">as</span> <span class="n">Coding</span><span class="p">);</span>
</code></pre></div>



<a name="247724731"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247724731" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Ewout Kramer <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247724731">(Jul 30 2021 at 15:41)</a>:</h4>
<p>Looks ok.  It doesn't work for you?  Debugging Linq is not too easy, but you can take the full statement apart in single Where/Select/ etc and then debug....</p>



<a name="247726880"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247726880" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Matthew Dugal <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247726880">(Jul 30 2021 at 15:57)</a>:</h4>
<p>No it works fine. Just wanted a second set of eyes before making it a suggestion to Erez for parsing. Thank you BTW.</p>



<a name="247750728"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/247750728" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Michele Mottini <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#247750728">(Jul 30 2021 at 19:21)</a>:</h4>
<p>.OfType&lt;Coding&gt;()</p>



<a name="248476642"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179171-dotnet/topic/using%20us-core-race%20extension/near/248476642" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Erez Shalom <a href="https://fhir.github.io/chat-archive/stream/179171-dotnet/topic/using.20us-core-race.20extension.html#248476642">(Aug 05 2021 at 13:30)</a>:</h4>
<p>Thanks everyone for your useful answers!</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
