---
layout: page
title: "FHIR Chat  · latest FHIR Parser issues · python"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179218-python/index.html">python</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html">latest FHIR Parser issues</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="184404652"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184404652" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184404652">(Dec 29 2019 at 04:33)</a>:</h4>
<p>I have merged the latest changes from FHIR parser and getting errors on generation of CI build:</p>
<p>these changes let me get a set of Classes</p>
<ul>
<li>added "!=":'neq',  to mappings.py</li>
<li>added '{cd}' "'some data' to mappings.py</li>
<li>short-circuited the unit tests using a <code> try except TypeError pass</code>  at  line 157</li>
</ul>
<p>but then trying to import Patient</p>
<ul>
<li>address Class tries to import AddressType and AddressUse class  which don't exist  see below:</li>
</ul>



<a name="184404660"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184404660" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184404660">(Dec 29 2019 at 04:33)</a>:</h4>
<div class="codehilite"><pre><span></span>    def elementProperties(self):
        js = super(Address, self).elementProperties()
        js.extend([
            (&quot;use&quot;, &quot;use&quot;, AddressUse.str, False, None, False),
            (&quot;type&quot;, &quot;type&quot;, AddressType.str, False, None, False),
            (&quot;text&quot;, &quot;text&quot;, str, False, None, False),
            (&quot;line&quot;, &quot;line&quot;, str, True, None, False),
            (&quot;city&quot;, &quot;city&quot;, str, False, None, False),
            (&quot;district&quot;, &quot;district&quot;, str, False, None, False),
            (&quot;state&quot;, &quot;state&quot;, str, False, None, False),
            (&quot;postalCode&quot;, &quot;postalCode&quot;, str, False, None, False),
            (&quot;country&quot;, &quot;country&quot;, str, False, None, False),
            (&quot;period&quot;, &quot;period&quot;, period.Period, False, None, False),
        ])
        return js


from . import AddressType
from . import AddressUse
from . import period
</pre></div>



<a name="184404805"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184404805" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184404805">(Dec 29 2019 at 04:38)</a>:</h4>
<p>the codesystem_AddressType and codesystem_AddressUse do indeed exist and I believe there is some missing in the JInja2 templates or the parser settings.</p>



<a name="184472890"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184472890" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184472890">(Dec 30 2019 at 13:36)</a>:</h4>
<p>The latest changes to fhir-parser include breaking changes to codesystem → enum generation, the templates will probably have to be updated to support those changes.</p>



<a name="184480215"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184480215" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184480215">(Dec 30 2019 at 15:44)</a>:</h4>
<p>(deleted)</p>



<a name="184689064"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184689064" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184689064">(Jan 02 2020 at 22:19)</a>:</h4>
<p>I don't understand how the enums will work...</p>
<p>here is example using address.py where I hacked the Properties and imports to work:</p>
<div class="codehilite"><pre><span></span>        super(Address, self).__init__(jsondict=jsondict, strict=strict)

    def elementProperties(self):
        js = super(Address, self).elementProperties()
        js.extend([
            (&quot;use&quot;, &quot;use&quot;, addressuse.AddressUse, False, None, False),
            (&quot;type&quot;, &quot;type&quot;, addresstype.AddressType, False, None, False),
            (&quot;text&quot;, &quot;text&quot;, str, False, None, False),
            (&quot;line&quot;, &quot;line&quot;, str, True, None, False),
            (&quot;city&quot;, &quot;city&quot;, str, False, None, False),
            (&quot;district&quot;, &quot;district&quot;, str, False, None, False),
            (&quot;state&quot;, &quot;state&quot;, str, False, None, False),
            (&quot;postalCode&quot;, &quot;postalCode&quot;, str, False, None, False),
            (&quot;country&quot;, &quot;country&quot;, str, False, None, False),
            (&quot;period&quot;, &quot;period&quot;, period.Period, False, None, False),
        ])
        return js


from . import codesystem_AddressType as addresstype
from . import codesystem_AddressUse as addressuse
from . import period
</pre></div>


<p>so to implement this,  the class expects an object now and not a code as a string?</p>
<div class="codehilite"><pre><span></span>import R4models.address as A
import R4models.codesystem_AddressUse as AU

address = A.Address()
address.use = AU.AddressUse()


print(address.as_json())

-------
{&#39;use&#39;: &lt;R4models.codesystem_AddressUse.AddressUse object at 0x109870a20&gt;}
[Finished in 0.32s]
</pre></div>



<a name="184775122"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184775122" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184775122">(Jan 03 2020 at 23:04)</a>:</h4>
<p>also the FHIR parser template for code systems give invalid Class definitions... (looks like a carry over from Swift) So I am  wondering if introducing the enums classes into Python was intentional or accidental?</p>



<a name="184775249"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184775249" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184775249">(Jan 03 2020 at 23:07)</a>:</h4>
<p>Here is a CodeSystem Class which I needed to edit to make legal python by removing some curly brackets and replacing with colon</p>
<div class="codehilite"><pre><span></span>...

class AddressUse(object):
    &quot;&quot;&quot; The use of an address.

    URL: http://hl7.org/fhir/address-use
    ValueSet: http://hl7.org/fhir/ValueSet/address-use
    &quot;&quot;&quot;

    home = &quot;home&quot;
    &quot;&quot;&quot; A communication address at a home.
    &quot;&quot;&quot;

    work = &quot;work&quot;
    &quot;&quot;&quot; An office address. First choice for business related contacts during business hours.
    &quot;&quot;&quot;

    temp = &quot;temp&quot;
    &quot;&quot;&quot; A temporary address. The period can provide more detailed information.
    &quot;&quot;&quot;

    old = &quot;old&quot;
    &quot;&quot;&quot; This address is no longer in use (or was never correct but retained for records).
    &quot;&quot;&quot;

    billing = &quot;billing&quot;
    &quot;&quot;&quot; An address to be used to send bills, invoices, receipts etc.
    &quot;&quot;&quot;
</pre></div>



<a name="184902022"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184902022" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184902022">(Jan 06 2020 at 12:32)</a>:</h4>
<p>Which template did you use for that? fhir-parser doesn't provide templates, you have to write your own.</p>



<a name="184922862"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184922862" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Haas <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184922862">(Jan 06 2020 at 16:42)</a>:</h4>
<p>I just the used sample templates “out of the box “ after doing a git pull.  Also note I did not directly edit the templates. I wanted to see what happened first if the enum classes where legal python.  So I edited the classes directly after they were generated.  After looking at this again. I think that there is something missing the as_json method. And that these classes would ideally inherit from Enum. Post 3.4</p>



<a name="184926168"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179218-python/topic/latest%20FHIR%20Parser%20issues/near/184926168" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Pascal Pfiffner <a href="https://fhir.github.io/chat-archive/stream/179218-python/topic/latest.20FHIR.20Parser.20issues.html#184926168">(Jan 06 2020 at 17:21)</a>:</h4>
<p>The sample templates do not work out of the box, they are just samples. But you can work backwards from the fixes you made to add the learnings to the templates that live in client-py.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
