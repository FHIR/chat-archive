---
layout: page
title: "FHIR Chat  · SMART App opening in new window · javascript"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/index.html">javascript</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html">SMART App opening in new window</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="262066238"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/262066238" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#262066238">(Nov 19 2021 at 13:31)</a>:</h4>
<p>Hi, I am using the <a href="http://docs.smarthealthit.org/client-js/">SMART JS Client Library</a>. The current situation is that the SMART app is launching from a CDS card, at which point the EHR opens a new window where the authorization flow begins. After SMART.authorize complete, the app runs into a 'This content cannot be displayed in a frame'.<br>
I found this <a href="https://github.com/smart-on-fhir/client-js/issues/33">GitHub issue</a> describing this issue which says the solution is the <a href="http://docs.smarthealthit.org/client-js/api.html#advanced-options">advanced options</a>.<br>
I believe the issue is with the header 'X-Frame-Options', but I'm not clear on what the value should be.<br>
The <a href="http://documentation">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</a> mentions two values, DENY or SAMEORIGIN, and it doesn't seem like DENY is the answer so then assuming the 'X-Frame-Options' is present, the app should be able to launch/run from a new window?<br>
I have tried the app with <br>
<code>{completeInTarget: true, target: '_self'}</code><br>
<code>{completeInTarget: true, target: '_blank'}</code><br>
<code>{completeInTarget: true, target: 'popup'}</code><br>
<code>{completeInTarget: true, target: '_top'}</code><br>
but none of these made any difference.<br>
Might anyone know if advanced options for the SMART client is the correct direction to look, and what the correct configuration of the advanced options might be?<br>
<span class="user-mention" data-user-id="193731">@Vladimir Ignatov</span> Could I get your comment on this issue?</p>



<a name="262068532"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/262068532" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Josh Mandel <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#262068532">(Nov 19 2021 at 13:54)</a>:</h4>
<p>Giving the way that browser cookie policies have evolved (qnd the underlying security and privacy concerns that led to these changes) there are reasons to make sure that a login step does not need to happen inside of an iframe during a smart app launch. This is something we should take into account with the Smart launcher as well as with the JavaScript client libraries.</p>
<p>And by the way, what CDS hooks environment are you launching and up from? Sandbox or a real life implantation?</p>



<a name="262076105"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/262076105" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#262076105">(Nov 19 2021 at 14:54)</a>:</h4>
<p>As you said, "the EHR opens a new window where the authorization flow begins". At this point I assume their expectation is that your app will authorize and render in that same popup, and those advanced options have nothing to do with that (meaning that it should work with the default options). I feel like the reason is indeed in the <code>X-Frame-Options</code> header. Can you check which server is sending that header? If it is under your control, try removing the <code>X-Frame-Options</code> header.</p>



<a name="262080366"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/262080366" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#262080366">(Nov 19 2021 at 15:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="191315">Josh Mandel</span> <a href="#narrow/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window/near/262068532">said</a>:</p>
<blockquote>
<p>Giving the way that browser cookie policies have evolved (qnd the underlying security and privacy concerns that led to these changes) there are reasons to make sure that a login step does not need to happen inside of an iframe during a smart app launch. This is something we should take into account with the Smart launcher as well as with the JavaScript client libraries.</p>
<p>And by the way, what CDS hooks environment are you launching and up from? Sandbox or a real life implantation?</p>
</blockquote>
<p>The app is being launched from a BPA from an Epic sandbox.</p>



<a name="263333468"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/263333468" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Corey Wen <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#263333468">(Dec 01 2021 at 18:17)</a>:</h4>
<p><span class="user-mention" data-user-id="193731">@Vladimir Ignatov</span> <br>
Does the <a href="https://github.com/smart-on-fhir/client-js">SMART client</a> attach <code>X-Frame-Options: SAMEORIGIN</code> automatically? If it does, is there a way to disable it?</p>



<a name="263456755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/SMART%20App%20opening%20in%20new%20window/near/263456755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Vladimir Ignatov <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/SMART.20App.20opening.20in.20new.20window.html#263456755">(Dec 02 2021 at 15:46)</a>:</h4>
<p>That is a response header, thus it is "attached" by the server that renders the app. The client has nothing to do with that.</p>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
