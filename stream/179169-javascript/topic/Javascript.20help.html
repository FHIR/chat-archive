---
layout: page
title: "FHIR Chat  · Javascript help · javascript"
---

{% raw %}<h2>Stream: <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/index.html">javascript</a></h2>
<h3>Topic: <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html">Javascript help</a></h3>

<hr>

<base href="https://chat.fhir.org">

<head><link href="https://fhir.github.io/chat-archive/style.css" rel="stylesheet"></head>

<a name="225925450"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225925450" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225925450">(Feb 10 2021 at 23:03)</a>:</h4>
<p>I need to convert this </p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">urlify</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="sr">/[&amp; +$,:;=?@"#{}|^~[`%!'&lt;&gt;\]\.\/\(\)\*\\]/g</span><span class="p">;</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">truncate</span> <span class="o">||</span> <span class="nx">e</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">),</span>
                    <span class="nx">A</span><span class="p">.</span><span class="nx">trim</span><span class="p">()</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\'/gi</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-{2,}/g</span><span class="p">,</span> <span class="s2">"-"</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">truncate</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^-+|-+$/gm</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span>
                        <span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
                <span class="p">);</span>
            <span class="p">})</span>
</code></pre></div>



<a name="225925472"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225925472" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225925472">(Feb 10 2021 at 23:03)</a>:</h4>
<p>to java code that does the same thing</p>



<a name="225925514"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225925514" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225925514">(Feb 10 2021 at 23:03)</a>:</h4>
<p>I'm not sure how some of the string stuff works</p>



<a name="225925838"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225925838" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225925838">(Feb 10 2021 at 23:06)</a>:</h4>
<p>I remember that the t = / sequence has some special meaning, but google doesn't seem to know how to help me find what it is. What's the /g at the end?</p>



<a name="225925935"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225925935" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225925935">(Feb 10 2021 at 23:07)</a>:</h4>
<p>global match, basically do it as many times as you can</p>



<a name="225926059"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926059" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926059">(Feb 10 2021 at 23:08)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&quot;abcdeabcdeab&quot;.replace(/abc/, &quot;123&quot;)
&quot;123deabcdeab&quot;
&quot;abcdeabcdeab&quot;.replace(/abc/g, &quot;123&quot;)
&quot;123de123deab&quot;```
</code></pre></div>



<a name="225926084"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926084" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926084">(Feb 10 2021 at 23:08)</a>:</h4>
<p>so that's a regex at face value? It doesn't have string quotes around it ? It's the string quotes bit I have some memory of it meaning something</p>



<a name="225926292"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926292" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926292">(Feb 10 2021 at 23:10)</a>:</h4>
<p>and what does the return () mean? it's returning a set?</p>



<a name="225926296"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926296" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926296">(Feb 10 2021 at 23:10)</a>:</h4>
<p>yeah, <code>/slash-escaped-regex/flags</code> is the same as new Regexp("quote-escaped-regex", "flags")</p>



<a name="225926344"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926344" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926344">(Feb 10 2021 at 23:11)</a>:</h4>
<p>hmm I wonder how I do that in java?</p>



<a name="225926564"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926564" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926564">(Feb 10 2021 at 23:13)</a>:</h4>
<p>after squinting at it for a bit, i think the return (foo) is the same as return foo</p>



<a name="225926622"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926622" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926622">(Feb 10 2021 at 23:13)</a>:</h4>
<p>hmm, not sure, given the ',' there</p>



<a name="225926699"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926699" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926699">(Feb 10 2021 at 23:14)</a>:</h4>
<p>I don't know how to read that. It's used here:</p>



<a name="225926710"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926710" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926710">(Feb 10 2021 at 23:14)</a>:</h4>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code><span class="p">(</span><span class="nx">u</span> <span class="o">=</span> <span class="nx">l</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">urlify</span><span class="p">(</span><span class="nx">n</span><span class="p">[</span><span class="nx">r</span><span class="p">].</span><span class="nx">textContent</span><span class="p">)),</span> <span class="p">(</span><span class="nx">h</span> <span class="o">=</span> <span class="mf">0</span><span class="p">);</span>
</code></pre></div>



<a name="225926721"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926721" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926721">(Feb 10 2021 at 23:14)</a>:</h4>
<p>so it's used as if it just returns a string</p>



<a name="225926755"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926755" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926755">(Feb 10 2021 at 23:15)</a>:</h4>
<p>I think this is the same in java:</p>



<a name="225926767"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926767" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926767">(Feb 10 2021 at 23:15)</a>:</h4>
<div class="codehilite" data-code-language="Java"><pre><span></span><code><span class="kd">private</span> <span class="n">String</span> <span class="nf">urlify</span><span class="p">(</span><span class="n">String</span> <span class="n">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">t</span> <span class="o">=</span> <span class="s">"&amp; +$,:;=?@\"#{}|^~[`%!'&lt;&gt;\\]\\.\\/\\(\\)\\*\\\\"</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">a</span>
        <span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">"\\'/"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
        <span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s">"-"</span><span class="p">)</span>
        <span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">"-{2,}"</span><span class="p">,</span> <span class="s">"-"</span><span class="p">)</span>
<span class="c1">//        .substring(0, this.options.truncate)</span>
        <span class="p">.</span><span class="na">replaceAll</span><span class="p">(</span><span class="s">"^-+|-+$"</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>
        <span class="p">.</span><span class="na">toLowerCase</span><span class="p">();</span>
  <span class="p">}</span>
</code></pre></div>



<a name="225926792"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926792" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926792">(Feb 10 2021 at 23:15)</a>:</h4>
<p>it looks to me like <code>this.options.truncate || e(this.options),</code> is just there for side-effects</p>



<a name="225926933"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926933" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926933">(Feb 10 2021 at 23:16)</a>:</h4>
<p>there's also a trim() at the beginning to get rid of WS:</p>
<div class="codehilite"><pre><span></span><code>&quot; \ntrim me  \n&quot;.trim()
&quot;trim me&quot;
</code></pre></div>



<a name="225926979"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225926979" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225926979">(Feb 10 2021 at 23:16)</a>:</h4>
<p>duh thanks</p>



<a name="225927404"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225927404" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225927404">(Feb 10 2021 at 23:21)</a>:</h4>
<div class="codehilite"><pre><span></span><code>&quot;--++asdf&#39;in quotes&#39;&amp; +$-x--y---z&quot;.trim()
                        .replace(/\&#39;/gi, &quot;&quot;)
                        .replace(t, &quot;-&quot;)
                        .replace(/-{2,}/g, &quot;-&quot;)
                        .substring(0, 99)
                        .replace(/^-+|-+$/gm, &quot;&quot;)
                        .toLowerCase()
&quot;asdfin-quotes-x-y-z&quot;
</code></pre></div>



<a name="225927445"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225927445" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225927445">(Feb 10 2021 at 23:21)</a>:</h4>
<p>that should exercise it pretty well</p>



<a name="225927556"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225927556" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eric Prud&#x27;hommeaux <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225927556">(Feb 10 2021 at 23:22)</a>:</h4>
<p>(though i forgot the trim)</p>



<a name="225928609"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/225928609" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Grahame Grieve <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#225928609">(Feb 10 2021 at 23:32)</a>:</h4>
<p>thanks</p>



<a name="231351273"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/231351273" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jose Costa Teixeira <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#231351273">(Mar 22 2021 at 17:27)</a>:</h4>
<p>Hi. Quick question:<br>
I have this code in a script somewhere:</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code>          <span class="kd">var</span> <span class="nx">feedbacklabel</span> <span class="o">=</span> <span class="s1">'Feedback'</span><span class="p">;</span>
          <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">feedbackEntry</span><span class="p">.</span><span class="nx">parameters</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">feedbackEntry</span><span class="p">.</span><span class="nx">label</span> <span class="o">%</span><span class="p">}</span>
              <span class="nx">feedbacklabel</span> <span class="o">=</span> <span class="s1">'{{feedbackEntry.label}}'</span><span class="p">;</span>  <span class="c1">// The feedback label is a string as provided</span>
            <span class="p">{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">};</span>
</code></pre></div>
<p>Basically saying "The feedbacklabel var is "Feedback" unless the variable {{feedbackEntry.label}} is defined, in which case the feedbacklabel takes that value. In order to further secure this (e.g. avoid someone wanting to inject code), can I / should I add a toString there?</p>
<div class="codehilite" data-code-language="JavaScript"><pre><span></span><code>          <span class="kd">var</span> <span class="nx">feedbacklabel</span> <span class="o">=</span> <span class="s1">'Feedback'</span><span class="p">;</span>
          <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">feedbackEntry</span><span class="p">.</span><span class="nx">parameters</span> <span class="o">%</span><span class="p">}</span>
            <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">feedbackEntry</span><span class="p">.</span><span class="nx">label</span> <span class="o">%</span><span class="p">}</span>
              <span class="nx">feedbacklabel</span> <span class="o">=</span> <span class="s1">'{{feedbackEntry.label}}.toString()'</span><span class="p">;</span>  <span class="c1">// The feedback label is a string (and cast as such)</span>
            <span class="p">{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">};</span>
</code></pre></div>
<p>?</p>



<a name="232494046"></a>
<h4><a href="https://chat.fhir.org#narrow/stream/179169-javascript/topic/Javascript%20help/near/232494046" class="zl"><img src="https://fhir.github.io/chat-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Kaney <a href="https://fhir.github.io/chat-archive/stream/179169-javascript/topic/Javascript.20help.html#232494046">(Mar 30 2021 at 20:38)</a>:</h4>
<p>what about a ternary?</p>
<div class="codehilite"><pre><span></span><code>var label = feedbackEntry.label ? feedbackEntry.label : &quot;Feedback&quot;
</code></pre></div>


{% endraw %}
<hr><p>Last updated: Apr 12 2022 at 19:14 UTC</p>
